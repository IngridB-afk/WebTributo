(self.webpackChunkapp=self.webpackChunkapp||[]).push([[779],{3302:function(e,t){var s,a,i;!function(r,n){"use strict";a=[],s=function(){var e=function(){var e,t,s="+1,-1,100,1234,8ball,a,ab,abc,abcd,accept,aerial_tramway,airplane,alarm_clock,alien,ambulance,anchor,angel,anger,angry,anguished,ant,apple,aquarius,aries,arrow_backward,arrow_double_down,arrow_double_up,arrow_down,arrow_down_small,arrow_forward,arrow_heading_down,arrow_heading_up,arrow_left,arrow_lower_left,arrow_lower_right,arrow_right,arrow_right_hook,arrow_up,arrow_up_down,arrow_up_small,arrow_upper_left,arrow_upper_right,arrows_clockwise,arrows_counterclockwise,art,articulated_lorry,astonished,atm,b,baby,baby_bottle,baby_chick,baby_symbol,back,baggage_claim,balloon,ballot_box_with_check,bamboo,banana,bangbang,bank,bar_chart,barber,baseball,basketball,bath,bathtub,battery,bear,bee,beer,beers,beetle,beginner,bell,bento,bicyclist,bike,bikini,bird,birthday,black_circle,black_joker,black_medium_small_square,black_medium_square,black_nib,black_small_square,black_square,black_square_button,blossom,blowfish,blue_book,blue_car,blue_heart,blush,boar,boat,bomb,book,bookmark,bookmark_tabs,books,boom,boot,bouquet,bow,bowling,bowtie,boy,bread,bride_with_veil,bridge_at_night,briefcase,broken_heart,bug,bulb,bullettrain_front,bullettrain_side,bus,busstop,bust_in_silhouette,busts_in_silhouette,cactus,cake,calendar,calling,camel,camera,cancer,candy,capital_abcd,capricorn,car,card_index,carousel_horse,cat,cat2,cd,chart,chart_with_downwards_trend,chart_with_upwards_trend,checkered_flag,cherries,cherry_blossom,chestnut,chicken,children_crossing,chocolate_bar,christmas_tree,church,cinema,circus_tent,city_sunrise,city_sunset,cl,clap,clapper,clipboard,clock1,clock10,clock1030,clock11,clock1130,clock12,clock1230,clock130,clock2,clock230,clock3,clock330,clock4,clock430,clock5,clock530,clock6,clock630,clock7,clock730,clock8,clock830,clock9,clock930,closed_book,closed_lock_with_key,closed_umbrella,cloud,clubs,cn,cocktail,coffee,cold_sweat,collision,computer,confetti_ball,confounded,confused,congratulations,construction,construction_worker,convenience_store,cookie,cool,cop,copyright,corn,couple,couple_with_heart,couplekiss,cow,cow2,credit_card,crocodile,crossed_flags,crown,cry,crying_cat_face,crystal_ball,cupid,curly_loop,currency_exchange,curry,custard,customs,cyclone,dancer,dancers,dango,dart,dash,date,de,deciduous_tree,department_store,diamond_shape_with_a_dot_inside,diamonds,disappointed,disappointed_relieved,dizzy,dizzy_face,do_not_litter,dog,dog2,dollar,dolls,dolphin,donut,door,doughnut,dragon,dragon_face,dress,dromedary_camel,droplet,dvd,e-mail,ear,ear_of_rice,earth_africa,earth_americas,earth_asia,egg,eggplant,eight,eight_pointed_black_star,eight_spoked_asterisk,electric_plug,elephant,email,end,envelope,es,euro,european_castle,european_post_office,evergreen_tree,exclamation,expressionless,eyeglasses,eyes,facepunch,factory,fallen_leaf,family,fast_forward,fax,fearful,feelsgood,feet,ferris_wheel,file_folder,finnadie,fire,fire_engine,fireworks,first_quarter_moon,first_quarter_moon_with_face,fish,fish_cake,fishing_pole_and_fish,fist,five,flags,flashlight,floppy_disk,flower_playing_cards,flushed,foggy,football,fork_and_knife,fountain,four,four_leaf_clover,fr,free,fried_shrimp,fries,frog,frowning,fu,fuelpump,full_moon,full_moon_with_face,game_die,gb,gem,gemini,ghost,gift,gift_heart,girl,globe_with_meridians,goat,goberserk,godmode,golf,grapes,green_apple,green_book,green_heart,grey_exclamation,grey_question,grimacing,grin,grinning,guardsman,guitar,gun,haircut,hamburger,hammer,hamster,hand,handbag,hankey,hash,hatched_chick,hatching_chick,headphones,hear_no_evil,heart,heart_decoration,heart_eyes,heart_eyes_cat,heartbeat,heartpulse,hearts,heavy_check_mark,heavy_division_sign,heavy_dollar_sign,heavy_exclamation_mark,heavy_minus_sign,heavy_multiplication_x,heavy_plus_sign,helicopter,herb,hibiscus,high_brightness,high_heel,hocho,honey_pot,honeybee,horse,horse_racing,hospital,hotel,hotsprings,hourglass,hourglass_flowing_sand,house,house_with_garden,hurtrealbad,hushed,ice_cream,icecream,id,ideograph_advantage,imp,inbox_tray,incoming_envelope,information_desk_person,information_source,innocent,interrobang,iphone,it,izakaya_lantern,jack_o_lantern,japan,japanese_castle,japanese_goblin,japanese_ogre,jeans,joy,joy_cat,jp,key,keycap_ten,kimono,kiss,kissing,kissing_cat,kissing_closed_eyes,kissing_face,kissing_heart,kissing_smiling_eyes,koala,koko,kr,large_blue_circle,large_blue_diamond,large_orange_diamond,last_quarter_moon,last_quarter_moon_with_face,laughing,leaves,ledger,left_luggage,left_right_arrow,leftwards_arrow_with_hook,lemon,leo,leopard,libra,light_rail,link,lips,lipstick,lock,lock_with_ink_pen,lollipop,loop,loudspeaker,love_hotel,love_letter,low_brightness,m,mag,mag_right,mahjong,mailbox,mailbox_closed,mailbox_with_mail,mailbox_with_no_mail,man,man_with_gua_pi_mao,man_with_turban,mans_shoe,maple_leaf,mask,massage,meat_on_bone,mega,melon,memo,mens,metal,metro,microphone,microscope,milky_way,minibus,minidisc,mobile_phone_off,money_with_wings,moneybag,monkey,monkey_face,monorail,moon,mortar_board,mount_fuji,mountain_bicyclist,mountain_cableway,mountain_railway,mouse,mouse2,movie_camera,moyai,muscle,mushroom,musical_keyboard,musical_note,musical_score,mute,nail_care,name_badge,neckbeard,necktie,negative_squared_cross_mark,neutral_face,new,new_moon,new_moon_with_face,newspaper,ng,nine,no_bell,no_bicycles,no_entry,no_entry_sign,no_good,no_mobile_phones,no_mouth,no_pedestrians,no_smoking,non-potable_water,nose,notebook,notebook_with_decorative_cover,notes,nut_and_bolt,o,o2,ocean,octocat,octopus,oden,office,ok,ok_hand,ok_woman,older_man,older_woman,on,oncoming_automobile,oncoming_bus,oncoming_police_car,oncoming_taxi,one,open_file_folder,open_hands,open_mouth,ophiuchus,orange_book,outbox_tray,ox,package,page_facing_up,page_with_curl,pager,palm_tree,panda_face,paperclip,parking,part_alternation_mark,partly_sunny,passport_control,paw_prints,peach,pear,pencil,pencil2,penguin,pensive,performing_arts,persevere,person_frowning,person_with_blond_hair,person_with_pouting_face,phone,pig,pig2,pig_nose,pill,pineapple,pisces,pizza,plus1,point_down,point_left,point_right,point_up,point_up_2,police_car,poodle,poop,post_office,postal_horn,postbox,potable_water,pouch,poultry_leg,pound,pouting_cat,pray,princess,punch,purple_heart,purse,pushpin,put_litter_in_its_place,question,rabbit,rabbit2,racehorse,radio,radio_button,rage,rage1,rage2,rage3,rage4,railway_car,rainbow,raised_hand,raised_hands,raising_hand,ram,ramen,rat,recycle,red_car,red_circle,registered,relaxed,relieved,repeat,repeat_one,restroom,revolving_hearts,rewind,ribbon,rice,rice_ball,rice_cracker,rice_scene,ring,rocket,roller_coaster,rooster,rose,rotating_light,round_pushpin,rowboat,ru,rugby_football,runner,running,running_shirt_with_sash,sa,sagittarius,sailboat,sake,sandal,santa,satellite,satisfied,saxophone,school,school_satchel,scissors,scorpius,scream,scream_cat,scroll,seat,secret,see_no_evil,seedling,seven,shaved_ice,sheep,shell,ship,shipit,shirt,shit,shoe,shower,signal_strength,six,six_pointed_star,ski,skull,sleeping,sleepy,slot_machine,small_blue_diamond,small_orange_diamond,small_red_triangle,small_red_triangle_down,smile,smile_cat,smiley,smiley_cat,smiling_imp,smirk,smirk_cat,smoking,snail,snake,snowboarder,snowflake,snowman,sob,soccer,soon,sos,sound,space_invader,spades,spaghetti,sparkle,sparkler,sparkles,sparkling_heart,speak_no_evil,speaker,speech_balloon,speedboat,squirrel,star,star2,stars,station,statue_of_liberty,steam_locomotive,stew,straight_ruler,strawberry,stuck_out_tongue,stuck_out_tongue_closed_eyes,stuck_out_tongue_winking_eye,sun_with_face,sunflower,sunglasses,sunny,sunrise,sunrise_over_mountains,surfer,sushi,suspect,suspension_railway,sweat,sweat_drops,sweat_smile,sweet_potato,swimmer,symbols,syringe,tada,tanabata_tree,tangerine,taurus,taxi,tea,telephone,telephone_receiver,telescope,tennis,tent,thought_balloon,three,thumbsdown,thumbsup,ticket,tiger,tiger2,tired_face,tm,toilet,tokyo_tower,tomato,tongue,top,tophat,tractor,traffic_light,train,train2,tram,triangular_flag_on_post,triangular_ruler,trident,triumph,trolleybus,trollface,trophy,tropical_drink,tropical_fish,truck,trumpet,tshirt,tulip,turtle,tv,twisted_rightwards_arrows,two,two_hearts,two_men_holding_hands,two_women_holding_hands,u5272,u5408,u55b6,u6307,u6708,u6709,u6e80,u7121,u7533,u7981,u7a7a,uk,umbrella,unamused,underage,unlock,up,us,v,vertical_traffic_light,vhs,vibration_mode,video_camera,video_game,violin,virgo,volcano,vs,walking,waning_crescent_moon,waning_gibbous_moon,warning,watch,water_buffalo,watermelon,wave,wavy_dash,waxing_crescent_moon,waxing_gibbous_moon,wc,weary,wedding,whale,whale2,wheelchair,white_check_mark,white_circle,white_flower,white_large_square,white_medium_small_square,white_medium_square,white_small_square,white_square_button,wind_chime,wine_glass,wink,wolf,woman,womans_clothes,womans_hat,womens,worried,wrench,x,yellow_heart,yen,yum,zap,zero,zzz".split(/,/),a=s.reduce((function(e,t){return e[t]=!0,e}),{});function i(){var e={named:/:([a-z0-9A-Z_-]+):/,smile:/:-?\)/g,scream:/:-o/gi,smirk:/[:;]-?]/g,grinning:/[:;]-?d/gi,stuck_out_tongue_closed_eyes:/x-d/gi,stuck_out_tongue_winking_eye:/[:;]-?p/gi,rage:/:-?[\[@]/g,frowning:/:-?\(/g,sob:/:['\u2019]-?\(|:&#x27;\(/g,kissing_heart:/:-?\*/g,wink:/;-?\)/g,pensive:/:-?\//g,confounded:/:-?s/gi,flushed:/:-?\|/g,relaxed:/:-?\$/g,mask:/:-x/gi,heart:/<3|&lt;3/g,broken_heart:/<\/3|&lt;&#x2F;3/g,thumbsup:/:\+1:/g,thumbsdown:/:\-1:/g};return n.ignore_emoticons&&(e={named:/:([a-z0-9A-Z_-]+):/,thumbsup:/:\+1:/g,thumbsdown:/:\-1:/g}),Object.keys(e).map((function(t){return[e[t],t]}))}function r(){var t=e.map((function(e){var t=e[0],s=t.source||t;return s&&(s=s.replace(/(^|[^\[])\^/g,"$1")),"("+s+")"})).join("|");return new RegExp(t,"gi")}var n={blacklist:{ids:[],classes:["no-emojify"],elements:["script","textarea","a","pre","code"]},tag_type:null,only_crawl_id:null,img_dir:"images/emoji",ignore_emoticons:!1,mode:"img"};function l(e){return" "===e||"\t"===e||"\r"===e||"\n"===e||""===e||e===String.fromCharCode(160)}var o={img:"img",sprite:"span","data-uri":"span"};function c(e){var t=null;if(e.replacer)t=e.replacer.apply({config:n},[":"+e.emojiName+":",e.emojiName]);else{var s=n.tag_type||o[n.mode];t=e.win.document.createElement(s),"img"!==s?t.setAttribute("class","emoji emoji-"+e.emojiName):(t.setAttribute("align","absmiddle"),t.setAttribute("alt",":"+e.emojiName+":"),t.setAttribute("class","emoji"),t.setAttribute("src",n.img_dir+"/"+e.emojiName+".png")),t.setAttribute("title",":"+e.emojiName+":")}e.node.splitText(e.match.index),e.node.nextSibling.nodeValue=e.node.nextSibling.nodeValue.substr(e.match[0].length,e.node.nextSibling.nodeValue.length),t.appendChild(e.node.splitText(e.match.index)),e.node.parentNode.insertBefore(t,e.node.nextSibling)}function m(t){if(t[1]&&t[2]){var s=t[2];return a[s]?s:void 0}for(var i=3;i<t.length-1;i++)if(t[i])return e[i-2][1]}function d(e,t){var s=this.config.tag_type||o[this.config.mode];return"img"!==s?"<"+s+" class='emoji emoji-"+t+"' title=':"+t+":'></"+s+">":"<img align='absmiddle' alt=':"+t+":' class='emoji' src='"+this.config.img_dir+"/"+t+".png' title=':"+t+":' />"}function h(){this.lastEmojiTerminatedAt=-1}function u(s,a){if(!s)return s;a||(a=d),e=i(),t=r();var l=new h;return s.replace(t,(function(){var e=Array.prototype.slice.call(arguments,0,-2),t=arguments[arguments.length-2],s=arguments[arguments.length-1],i=l.validate(e,t,s);return i?a.apply({config:n},[arguments[0],i]):arguments[0]}))}function p(s,a){"undefined"===typeof s&&(s=n.only_crawl_id?document.getElementById(n.only_crawl_id):document.body);var l=s.ownerDocument,o=l.defaultView||l.parentWindow,d=function(e,t){var s;if(e.hasChildNodes())for(s=e.firstChild;s;)t(s)&&d(s,t),s=s.nextSibling},u=function(e){for(var s,i=[],r=new h;null!==(s=t.exec(e.data));)r.validate(s,s.index,s.input)&&i.push(s);for(var n=i.length;n-- >0;){var l=m(i[n]);c({node:e,match:i[n],emojiName:l,replacer:a,win:o})}};e=i(),t=r();var p=[],g=new RegExp(n.blacklist.elements.join("|"),"i"),_=new RegExp(n.blacklist.classes.join("|"),"i");if("undefined"!==typeof o.document.createTreeWalker)for(var f,b=o.document.createTreeWalker(s,o.NodeFilter.SHOW_TEXT|o.NodeFilter.SHOW_ELEMENT,(function(e){return 1!==e.nodeType?o.NodeFilter.FILTER_ACCEPT:e.tagName.match(g)||e.className.match(_)?o.NodeFilter.FILTER_REJECT:o.NodeFilter.FILTER_SKIP}),!1);null!==(f=b.nextNode());)p.push(f);else d(s,(function(e){return!("undefined"!==typeof e.tagName&&e.tagName.match(g)||"undefined"!==typeof e.className&&e.className.match(_))&&(1===e.nodeType||p.push(e),!0)}));p.forEach(u)}return h.prototype={validate:function(e,t,s){var a=this,i=m(e);if(i){var r=e[0],n=r.length;if(0===t)return c();if(s.length===r.length+t)return c();var o=this.lastEmojiTerminatedAt===t;return o||(l(s.charAt(t-1))||l(s.charAt(r.length+t))&&o)?c():void 0}function c(){return a.lastEmojiTerminatedAt=n+t,i}}},{defaultConfig:n,emojiNames:s,setConfig:function(e){Object.keys(n).forEach((function(t){t in e&&(n[t]=e[t])}))},replace:u,run:p}}();return e},void 0===(i="function"===typeof s?s.apply(t,a):s)||(e.exports=i)}()},4343:function(e,t,s){"use strict";var a=s(8196),i=s.n(a),r=s(7294),n=s(9755),l=s.n(n),o=(s(2555),s(381)),c=s.n(o);class m extends r.Component{constructor(e){super(e),this.state=this.props.settings,this.stringToSlug=this.stringToSlug.bind(this),this.compareObjects=this.compareObjects.bind(this),this.postOptions=this.postOptions.bind(this),this.setStartswith=this.setStartswith.bind(this),this.tabClick=this.tabClick.bind(this),this.button=this.button.bind(this),this.select2=this.select2.bind(this),this.minHypesClick=this.minHypesClick.bind(this),this.minmaxRatingChange=this.minmaxRatingChange.bind(this),this.optionPanels=this.optionPanels.bind(this),this.tagOptions={add:(e,t)=>{null==t&&(t=!1);const s=this.tagOptions.exists.bind(this)(e);t?!1!==s&&this.tagOptions.remove.bind(this)(s):(!1===s?this.state.tagOptions.push(e):this.state.tagOptions[s].value=e.value,this.postOptions())},addSpecial:e=>{const t=this.tagOptions.slug_exists.bind(this)(e.slug);!1===t?this.state.tagOptions.push(e):this.state.tagOptions[t]=e,this.postOptions()},remove:e=>{const t=this.state.tagOptions[e];switch(this.state.tagOptions.splice(e,1),t.slug){case"score_gteq":l()(this.rating_slider).slider("values",0,1),this.minrating.value=1;break;case"score_lteq":l()(this.rating_slider).slider("values",1,100),this.maxrating.value=100;break;case"min_hypes":this.min_hypes.value="";break;default:{const e=l()(this[t.slug]);e.hasClass("select2")&&e.val("").trigger("change.select2")}}this.postOptions()},exists:e=>{if(this.state.tagOptions)for(let t=0;t<this.state.tagOptions.length;t+=1){const s=this.state.tagOptions[t];if(e.slug===s.slug&&e.label===s.label)return t}return!1},slug_exists:e=>{if(this.state.tagOptions)for(let t=0;t<this.state.tagOptions.length;t+=1)if(e===this.state.tagOptions[t].slug)return t;return!1},count:()=>{let e=0;if(this.state.tagOptions)for(let t=0;t<this.state.tagOptions.length;t+=1)"q"!==this.state.tagOptions[t].slug&&(e+=1);return e}}}componentDidMount(){const e=this.state.tabs.map((e=>({name:e,slug:this.stringToSlug(e)})));this.setState({tabs:e,tagOptions:[],startswith:!1},this.postOptions),l()(this.rating_slider).slider({range:!0,values:[1,100],min:1,max:100,step:1,stop:function(e,t){const s=t.values[0],a=t.values[1];return this.minrating.value=s,this.maxrating.value=a,this.tagOptions.addSpecial.bind(this,{slug:"score_gteq",label:`Minimum Rating: ${s}`,value:s/10})(),this.tagOptions.addSpecial.bind(this,{slug:"score_lteq",label:`Maximum Rating: ${a}`,value:a/10})()}.bind(this)}),l()(this.container).find(".select2").on("change",(e=>{const t=l()(e.currentTarget),s=t.val();t.data("slug");return this.tagOptions.addSpecial.bind(this,{slug:t.data("slug"),label:t.data("label"),value:s})()}))}stringToSlug(e){return e.toLowerCase().replace(/[^a-zA-Z0-9]/g,"")}compareObjects(e,t){return JSON.stringify(e)===JSON.stringify(t)}postOptions(){const e=this.tagOptions.slug_exists.bind(this)("q")||this.tagOptions.slug_exists.bind(this)("name.lowercase_prefix"),t={slug:this.state.startswith?"name.lowercase_prefix":"q",label:"",value:this.searchinput.value};if(e)this.state.tagOptions[e]=t;else{const e=this.state.tagOptions.findIndex((e=>""==e.label&&("name.lowercase_prefix"==e.slug||"q"==e.slug)));-1==e?this.state.tagOptions.push(t):this.state.tagOptions[e]=t}this.props.postOptions(this.state.tagOptions),this.forceUpdate()}setStartswith(){this.setState({startswith:this.startswith.checked}),this.postOptions()}tabClick(e){l()(this[`tabcontent_${e}`]).addClass("active in").siblings().removeClass("active in"),l()(this[`tab_${e}`]).addClass("active").siblings().removeClass("active")}button(e){const t=e.slug+e.value,s=!1!==this.tagOptions.exists.bind(this,e)()?"active":"";return r.createElement("div",{key:t,className:`btn btn-default mar-sm-right mar-sm-bottom ${s}`,onClick:this.tagOptions.add.bind(this,e,s)},e.label)}select2(e){return r.createElement("select",{ref:t=>{this[e.slug]=t},className:"form-control select2","data-label":e.label,"data-slug":e.slug,"data-placeholder":"Select some "+e.label,"data-url":e.url,multiple:!0})}minHypesClick(){const e=this.min_hypes.value;this.tagOptions.add.bind(this,{slug:"min_hypes",label:`Minimum Follows: ${e}`,value:e})()}minmaxRatingChange(){const e=this.minrating.value,t=this.maxrating.value;return l()(this.rating_slider).slider("values",0,e),l()(this.rating_slider).slider("values",1,t),this.tagOptions.add.bind(this,{slug:"score_gteq",label:`Minimum Rating: ${e}`,value:e/10})(),this.tagOptions.add.bind(this,{slug:"score_lteq",label:`Maximum Rating: ${t}`,value:e/10})()}optionPanels(){const e=(new Date).getFullYear()+2,{platforms:t=[],genres:s=[],themes:a=[],gamemodes:i=[],perspectives:n=[],esrb:l=[],pegi:o=[],regions:m=[]}=this.state;return[r.createElement("div",null,r.createElement("div",{className:"form-group"},t.map((e=>this.button({slug:"platforms.id_in",label:e[2],value:e[1]})))),this.select2({slug:"platforms.id_in",label:"Other Platforms",url:this.state.paths.platforms})),r.createElement("div",null,r.createElement("div",{className:"form-group"},Array(e-1972+1).fill().map(((t,s)=>e-s)).map((e=>this.button({slug:"release_year_in",label:e,value:e}))),this.button({slug:"release_year_in",label:1958,value:1958})),r.createElement("hr",null),r.createElement("div",{className:"form-group"},[0,1,2,3,4,5,6,7,8,9,10,11,12].map((e=>{const t=c()().month(e).format("MMMM");return this.button({slug:"release_month_in",label:t,value:e+1})}))),r.createElement("hr",null),r.createElement("div",{className:"form-group"},Array(5).fill().map(((e,t)=>2010-10*t)).map((e=>this.button({slug:"release_year_in",label:`${e}s`,value:Array(10).fill().map(((t,s)=>e+s))}))),this.button({slug:"release_date_null",label:"To Be Announced (TBA)",value:1}),this.button({slug:"status_eq",label:"Cancelled",value:6}))),r.createElement("div",null,r.createElement("div",{className:"form-group"},r.createElement("h4",{className:"nomar-top"},"Genres"),s.map((e=>this.button({slug:"genres_in",label:e[1],value:e[0]})))),r.createElement("div",{className:"form-group"},r.createElement("h4",{className:"nomar-top"},"Themes"),a.map((e=>this.button({slug:"themes_in",label:e[1],value:e[0]}))))),r.createElement("div",{className:"row"},r.createElement("div",{className:"col-sm-6"},r.createElement("div",{className:"row form-group"},r.createElement("div",{className:"col-sm-6"},r.createElement("label",{htmlFor:"minrating"},"Minimum Rating"),r.createElement("input",{className:"form-control",ref:e=>{this.minrating=e},id:"minrating",type:"number",placeholder:"1",onChange:this.minmaxRatingChange})),r.createElement("div",{className:"col-sm-6"},r.createElement("label",{htmlFor:"maxrating"},"Maximum Rating"),r.createElement("input",{className:"form-control",ref:e=>{this.maxrating=e},id:"maxrating",type:"number",placeholder:"100",onChange:this.minmaxRatingChange}))),r.createElement("div",{ref:e=>{this.rating_slider=e}})),r.createElement("div",{className:"col-sm-6"},r.createElement("label",{htmlFor:"minhype"},"Minimum Follows"),r.createElement("input",{ref:e=>{this.min_hypes=e},className:"form-control",id:"minhype",type:"number",placeholder:"0",onChange:this.minHypesClick}))),r.createElement("div",null,r.createElement("div",{className:"form-group"},r.createElement("h4",{className:"nomar-top"},"Modes"),i.map((e=>this.button({slug:"game_modes_inall",label:e[0],value:e[1]})))),r.createElement("div",{className:"form-group"},r.createElement("h4",{className:"nomar-top"},"Perspectives"),n.map((e=>this.button({slug:"player_perspectives_in",label:e[0],value:e[1]}))))),r.createElement("div",null,this.select2({slug:"companies.id_in",label:"Companies",url:this.state.paths.companies})),r.createElement("div",null,this.select2({slug:"keywords_inall",label:"Keywords",url:this.state.paths.keywords})),r.createElement("div",null,this.select2({slug:"characters_in",label:"Characters",url:this.state.paths.characters})),r.createElement("div",null,r.createElement("div",{className:"form-group"},r.createElement("h4",{className:"nomar-top"},"ESRB (Entertainment Software Rating Board)"),l.map(((e,t)=>this.button({slug:"ratings_in",label:`ESRB: ${e}`,value:`esrb${t+1}`})))),r.createElement("div",{className:"form-group"},r.createElement("h4",{className:"nomar-top"},"PEGI (Pan European Game Information)"),o.map(((e,t)=>this.button({slug:"ratings_in",label:`PEGI: ${e}`,value:`pegi${t+1}`})))),r.createElement("div",{className:"form-group"},r.createElement("h4",{className:"nomar-top"},"Game Engine"),this.select2({slug:"game_engines_in",label:"Game Engines",url:this.state.paths.engines})),r.createElement("div",{className:"form-group"},r.createElement("h4",{className:"nomar-top"},"Release Regions"),Object.keys(m).map((e=>this.button({slug:"regions_in",label:e,value:m[e]})))))]}render(){const e=this.optionPanels()||[];return r.createElement("div",{ref:e=>{this.container=e}},r.createElement("div",{className:"row"},r.createElement("div",{className:"col-sm-4"},r.createElement("div",{className:"form-group"},r.createElement("div",{className:"input-group"},r.createElement("input",{ref:e=>{this.searchinput=e},type:"text",className:"form-control",placeholder:"Enter a search term here..."}),r.createElement("div",{className:"input-group-btn"},r.createElement("button",{className:"btn btn-default",onClick:this.postOptions},r.createElement("span",{className:"fa fa-search"}))),r.createElement("div",{className:"input-group-addon noborder nopad-top nopad-bottom"},r.createElement("input",{ref:e=>{this.startswith=e},id:"as_checkbox",type:"checkbox",onChange:this.setStartswith,checked:this.state.startswith||!1}),r.createElement("label",{className:"text-muted small",htmlFor:"as_checkbox"},"Starts With"))))),r.createElement("div",{className:"col-sm-8 text-right"},r.createElement("a",{className:"btn btn-primary",href:"/games/new"},"Add Game"))),r.createElement("ul",{className:"nav nav-tabs nav-alt nav-justified"},this.state.tabs.map(((e,t)=>r.createElement("li",{ref:e=>{this[`tab_${t}`]=e},key:`option_tab_${t}`,className:0===t?"active":""},r.createElement("a",{onClick:this.tabClick.bind(this,t)},e.name))))),r.createElement("div",{className:"tab-content"},e.map(((e,t)=>{const s=0===t?"active in":"";return r.createElement("div",{ref:e=>{this[`tabcontent_${t}`]=e},key:`tabcontent_${t}`,className:`tab-pane ${s}`},e)}))),this.tagOptions.count.bind(this)()>0?r.createElement("div",{className:"pad mar-lg-top"},this.state.tagOptions.map(((e,t)=>e.label?r.createElement("div",{key:`tag_${t}`,className:"btn btn-primary mar-sm-right mar-sm-bottom","data-value":e.value,onClick:this.tagOptions.remove.bind(this,t)},`${e.label} `,r.createElement("span",{className:"fa fa-times"})):null))):null)}}var d=m;var h=(e,t)=>{let s;return(...a)=>{clearTimeout(s),s=setTimeout((()=>e(...a)),t)}},u=s(3302),p=s.n(u);const g=(e,t,s)=>{var a,i=s?"png":"jpg",r="ya81ui";if(t||(t="thumb"),e){if("string"===typeof e&&e.indexOf("/")>-1)return e;if(a=r,"object"===typeof e)for(var n in e){if(n.indexOf("cloudinary")>-1)a=e[n]}else a=e}else a=r;return"https://images.igdb.com/igdb/image/upload/t_"+t+"/"+a+"."+i},_=(e,t)=>0===e.length?[]:e.slice(1).reduce(((e,s)=>e.concat([t,s])),[e[0]]),f=()=>window.outerWidth<768||window.is_mobile,b=()=>!!window.current_user,v=e=>{if(e)return e>10&&(e/=10),{word:["Awful","Very Bad","Bad","Unimpressive","Average","Fair","Alright","Good","Great","Superb"][e=Math.round(e)-1],class:["awful","verybad","bad","unimpressive","average","fair","alright","good","great","superb"][e]}},E=e=>{if(window.is_server)return!1;if(window.is_logged_in())return!0;{let t;return t=e?"/dialog/login?event="+e:"/dialog/login",$.ajax({url:t,type:"GET",success:function(e){let t="#ajax-modal";$(t).remove(),$body.append(e),$(t).modal("show")}}),!1}};class w extends r.Component{constructor(e){super(e);let t=this.props.height,s=this.props.width;if(!s&&!t){const e=this.calculateSize(this.props);e&&(t=e[0],s=e[1])}this.state={first_class:this.props.className?this.props.className.split(" ")[0]:"thumb",has_loaded:!1,width:s,height:t,force_load:this.props.force_load,src:this.props.src,alt:this.props.alt||""},this.scroll_timeout=0,this.removeGlobalListeners=this.removeGlobalListeners.bind(this),this.scroll=this.scroll.bind(this),this.load=this.load.bind(this),this.generateUrl=this.generateUrl.bind(this),this.loading=this.loading.bind(this),this.loaded=this.loaded.bind(this)}componentDidMount(){window.addEventListener("scroll",this.scroll),setTimeout(this.load,50)}UNSAFE_componentWillReceiveProps(e){if(e.src!==this.state.src){let t=e.height,s=e.width;if(!s&&!t){const a=this.calculateSize(e);a&&(t=a[0],s=a[1])}this.setState({has_loaded:!1,src:e.src,width:s,height:t},this.load)}}shouldComponentUpdate(e,t){return e.src!==this.state.src||t.has_loaded!==this.state.has_loaded||e.width!==this.state.width}componentWillUnmount(){this.removeGlobalListeners()}removeGlobalListeners(){window.removeEventListener("scroll",this.scroll)}calculateSize(e){let t;if(e.src&&"object"===typeof e.src&&e.width?t=e.width/(e.src.image_width/e.src.image_height):e.width&&(t=e.width*(9/16)),t){return[t,e.width||!1]}}scroll(){null!==this.scroll_timeout&&clearTimeout(this.scroll_timeout),this.scroll_timeout=setTimeout(this.load,100)}load(){if(((e,t)=>{var s,a,i,r;if(t||(t=0),e){for(i=e.offsetTop,a=e.offsetLeft,r=e.offsetWidth,s=e.offsetHeight;e.offsetParent;)i+=(e=e.offsetParent).offsetTop,a+=e.offsetLeft;return i<window.pageYOffset+(window.innerHeight+t)&&a<window.pageXOffset+window.innerWidth&&i+s>window.pageYOffset&&a+r>window.pageXOffset}})(this.img,768)){const e=new Image;e.src=this.generateUrl(),e.onload=()=>{this.setState({has_loaded:!0}),this.removeGlobalListeners()},e.onerror=()=>{this.setState({has_loaded:!0,has_errored:!0}),this.removeGlobalListeners()}}}generateUrl(){return g(this.state.has_errored?null:this.state.src,this.state.first_class,this.props.lossless)}loading(){return r.createElement("div",{ref:e=>{this.img=e},className:`img-responsive loading-animated ${this.state.first_class} ${this.state.first_class}-loading`,style:{height:`${this.state.height}px`,width:`${this.state.width}px`}})}loaded(){const e=this.props.responsive||"img-responsive";return r.createElement("img",{className:`${e} ${this.props.className||""}`,alt:this.state.alt,src:this.generateUrl(),style:Object.assign({},{height:`${this.state.height}px`,width:`${this.state.width}px`},this.props.style||{})})}render(){return this.state.src?this.state.has_loaded&&!window.is_server||this.state.force_load?this.loaded():this.loading():null}}const y=({user:e,size:t,className:s,force_load:a})=>{let i;if(e.avatar){let n="avatar_large";t<200&&(n="thumb"),e.avatar=e.avatar.replace("t_thumb",`t_${n}`),i=r.createElement(w,{className:s||"",src:e.avatar,alt:e.username,width:t,height:t,force_load:a})}else i=r.createElement("object",{className:s||"",data:`/users/${e.slug}/avatar.svg`,alt:e.username,width:t,height:t});return r.createElement("div",{className:`user-avatar ${s||""}`,style:{backgroundColor:e.color?e.color.value:"white",width:t,height:t}},i)};class N extends r.Component{constructor(e){let t;super(e),"undefined"!==typeof $win&&null!==$win&&$win.on("scroll",h((()=>{if(!this.state.loading_next_page&&!this.state.next_page_empty&&$doc.height()-$win.height()-$win.scrollTop()<=160)return this.setState({loading_next_page:!0}),this.next_page()}),100)),t=localStorage.getItem("advanced_search_slim_view")||0,this.state={games:[],req:{d:1,"f[type]":"games",q:"",s:"score",p:0},slim_view:0,loading_next_page:!1,next_page_empty:!1,paths:this.props.paths},this.generate_params=this.generate_params.bind(this),this.perform_search=this.perform_search.bind(this),this.next_page=this.next_page.bind(this),this.unique_array=this.unique_array.bind(this),this.toggle_sort=this.toggle_sort.bind(this),this.set_filter=this.set_filter.bind(this),this.set_slim=this.set_slim.bind(this),this.generate_request_object=this.generate_request_object.bind(this),this.renderSorting=this.renderSorting.bind(this),this.renderBottom=this.renderBottom.bind(this)}UNSAFE_componentWillReceiveProps(e){return this.setState({next_page_empty:!1}),this.generate_request_object(e.postOptions),this.perform_search(),e}componentWillUnmount(){$win.off("scroll",h)}generate_params(){let e,t;const s=[];for(e in this.state.req)if(t=this.state.req[e],!1!==t&&""!==t){if("p"===e&&0===t)continue;s.push(`${e}=${t}`)}return s.join("&")}perform_search(){$.ajax({url:"/advanced_search",data:this.generate_params(),success:function(e){return this.setState({games:e})}.bind(this)})}next_page(){this.state.req.p+=1,$.ajax({url:"/advanced_search",data:this.generate_params(),success:function(e){return null!==e&&void 0!==e&&e.length?(this.setState({games:this.state.games.concat(e)}),this.state.games.length>=100&&this.setState({next_page_empty:!0})):this.setState({next_page_empty:!0}),this.setState({loading_next_page:!1})}.bind(this)})}unique_array(e){return e.reduce(((e,t)=>(e.indexOf(t)<0&&e.push(t),e)),[])}toggle_sort(){this.state.req.d=1!==this.state.req.d&&1,this.forceUpdate()}set_filter(e){this.state.req.s===e?this.toggle_sort():this.state.req.s=e,this.forceUpdate(),this.state.req.p=0,this.perform_search()}set_slim(){const e=1===this.state.slim_view?0:1;localStorage.setItem("advanced_search_slim_view",e),this.setState({slim_view:e})}generate_request_object(e){let t;e=JSON.parse(JSON.stringify(e.slice(0)));const s={},a=this.state.req;for(t in a){const e=a[t];["d","f[type]","q","s","p"].indexOf(t)>-1&&(s[t]=e)}this.state.req=s;for(let i=0;i<e.length;i+=1){const t=e[i];for(let s=0;s<e.length;s+=1){const a=e[s];t&&a&&t.slug===a.slug&&t.value!==a.value&&(Array.isArray(t.value)||(t.value=[t.value]),t.value.push(a.value),e.splice(s,1))}}for(let i=0;i<e.length;i+=1){const t=e[i];"q"===t.slug?this.state.req.q=t.value:(Array.isArray(t.value)&&(t.value=this.unique_array(t.value.join(",").split(",")).join(",")),this.state.req[`f[${t.slug}]`]=t.value)}return this.state.req.p=0,this.forceUpdate()}renderSorting(){const e=1===this.state.req.d?"fa-caret-down":"fa-caret-up";let t=["label-primary","","","hide","","hide"];switch(this.state.req.s){case"name.untouched":t=["","hide","label-primary","","","hide"];break;case"release_date":t=["","hide","","hide","label-primary",""]}const s=1===this.state.slim_view?"label-primary":"";return r.createElement("div",{className:"sorting-methods pull-right col-md-6 nopad text-right"},r.createElement("div",{className:`label label-default cursor-pointer mar-lg-right ${s}`,onClick:this.set_slim},"Slim"),r.createElement("div",{className:`label label-default cursor-pointer mar-sm-right ${t[0]}`,onClick:this.set_filter.bind(this,"score")},"Rating ",r.createElement("span",{className:`fa ${e} ${t[1]}`})),r.createElement("div",{className:`label label-default cursor-pointer mar-sm-right ${t[2]}`,onClick:this.set_filter.bind(this,"name.untouched")},"Title ",r.createElement("span",{className:`fa ${e} ${t[3]}`})),r.createElement("div",{className:`label label-default cursor-pointer ${t[4]}`,onClick:this.set_filter.bind(this,"release_date")},"Release Date ",r.createElement("span",{className:`fa ${e} ${t[5]}`})))}renderBottom(){var e,t;this.state.loading_next_page?this.state.paths.loading:this.state.next_page_empty?null===(e=this.state.games)||void 0===e||e.length:null===(t=this.state.games)||void 0===t||t.length}render(){let{games:e}=this.state;return e||(e=[]),r.createElement("div",{className:"mar-lg-top"},r.createElement("div",{className:"sorting-area"},r.createElement("span",{className:"fa fa-filter text-muted"}),r.createElement("span",{className:"text-muted"}," Sorting"),this.renderSorting()),r.createElement("div",{className:"row fix-heights"},e.map(((e,t)=>{const s=moment(1e3*e.release_date_unix),a=s.fromNow(),i=s.format("MMMM Do, YYYY"),n=this.state.loading?"loading-animated":"",l=e.cloudinary_cover||"nocover";return 1===this.state.slim_view?r.createElement("table",{className:"table table-condensed table-fixed table-noborder pad"},r.createElement("tbody",null,r.createElement("tr",null,r.createElement("td",null,r.createElement("a",{href:`/games/${e.slug}`},e.name)),e.release_date_unix?r.createElement("td",null,r.createElement("div",{title:i},i," (",a,")")):null,e.rating_score?r.createElement("td",null,r.createElement("div",null,"Rated: ",e.rating_score," / 100")):null,e.simple_platforms?r.createElement("td",null,r.createElement("div",null,e.simple_platforms.map((e=>e[0])).join(" / "))):null))):r.createElement("div",{key:`${t}_${e.id}`,className:"col-md-6 mar-lg-bottom"},r.createElement("div",{className:`media ${n}`},r.createElement("div",{className:"media-left"},r.createElement(w,{className:"thumb",src:`//images.igdb.com/igdb/image/upload/t_cover_med/${l}.jpg`,alt:e.name})),r.createElement("div",{className:"media-body"},r.createElement("a",{className:"overflow-wrap",href:`/games/${e.slug}`},e.name),e.release_date_unix?r.createElement("div",{title:i,className:"text-muted"},i," (",a,")"):null,e.rating_score?r.createElement("div",null,"Rated: ",e.rating_score," / 100"):null,e.simple_platforms?r.createElement("div",null,e.simple_platforms.map((e=>e[0])).join(" / ")):null)))})),this.renderBottom()))}}var k=N;class x extends r.Component{constructor(e){super(e),this.state={postOptions:[]},this.receivePostOptions=this.receivePostOptions.bind(this)}receivePostOptions(e){this.setState({postOptions:e})}render(){return r.createElement("div",null,r.createElement(d,{postOptions:this.receivePostOptions,settings:this.props}),r.createElement(k,{postOptions:this.state.postOptions,paths:this.props.paths}))}}var S=x;class C extends r.Component{constructor(e){super(e),this.state=Object.assign({},{hidden:!0,url:e.url,defaultTerm:"",title:"Best Matches",minCharacters:3,untouched:!0,selected:-1,busy:!1},e),e.revealedElementId&&(this.revealedElement=l()(`#${e.revealedElementId}`)),this.submenuLinks=[],this.minimalLayout=void 0===e.minimalLayout,this.paramKey=e.paramKey||"term",this.focus=this.focus.bind(this),this.keyup=this.keyup.bind(this),this.debouncedKeyup=h(this.keyup,400),this.arrowFunctions=this.arrowFunctions.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this.header=this.header.bind(this),this.footer=this.footer.bind(this),this.select_next=this.select_next.bind(this),this.allSuggestTemplate=this.allSuggestTemplate.bind(this),this.resultTemplate=this.resultTemplate.bind(this),this.setValue=this.setValue.bind(this),this.request=this.request.bind(this),this.renderResults=this.renderResults.bind(this),this.removeOverlay=this.removeOverlay.bind(this),this.debouncedReposition=h(this.reposition.bind(this),100),window.onresize=this.debouncedReposition}componentDidMount(){this.revealedElement=this.revealedElement||l()(this.inputElement).parent(),this.overlayElement=document.createElement("div"),this.overlayElement.className="igdb-autocomplete-overlay",this.overlayElement.addEventListener("click",this.hide),this.props.autoFocus&&this.inputElement.focus()}componentWillUnmount(){this.removeOverlay(),window.onresize=!1}removeOverlay(){document.body.contains(this.overlayElement)&&document.body.removeChild(this.overlayElement)}focus(){return!!this.state.untouched&&this.inputElement.select()}select_next(e){let t=this.state.selected;e?t>0?t--:t=-1:t<4&&t++;const s=this.submenuLinks[t];s?this.setState({selected:t},(()=>{s.focus()})):this.inputElement.focus()}keyup(e){if(13!==e.which&&38!==e.which&&40!==e.which){let e=-1,t=this.inputElement.value;t?t.length>=this.state.minCharacters&&!1===this.state.busy&&this.setState({selected:e,term:t,untouched:!1},(()=>{this.show(),this.request()})):this.hide()}return!0}arrowFunctions(e){return 38===e.which?(e.preventDefault(),this.select_next(!0),!1):40===e.which?(e.preventDefault(),this.select_next(),!1):void 0}track(e,t){"headSearch"===this.props.customHandler&&window.state.web_analytics.track(e,t)}request(){this.setState({busy:!0},(()=>{l().ajax({url:this.state.url,type:this.state.type,dataType:"json",data:`${this.paramKey}=${this.state.term}`,success:(e=>{const t=this[this.props.customHandler];t&&(e=t(e))&&this.track("Search",{term:this.state.term,category:this.state.type,autocomplete:!0,results:e.map((e=>({id:e.id,type:e.type,name:e.text||e.name})))}),this.submenuLinks=[],this.setState({busy:!1,results:e},this.show)}).bind(this)})}))}show(){this.state.hidden&&(document.body.appendChild(this.overlayElement),this.revealedElement.css({position:"relative",zIndex:"10002"}).addClass("igdb-autocomplete-open"),this.reposition(),this.setState({hidden:!1,untouched:!1}))}hide(){this.state.hidden||(this.removeOverlay(),this.revealedElement.css({position:"",zIndex:""}).removeClass("igdb-autocomplete-open"),this.setState({hidden:!0,untouched:!0}))}reposition(){this.revealedElement.offset()&&this.setState({containerStyle:{top:this.revealedElement.outerHeight(),width:this.revealedElement.outerWidth()}})}setValue(e,t){this.setState({selectedValue:e},(()=>{this.hide(),this.inputElement.value=t,this.props.onChange&&this.props.onChange(e,t)}))}headSearch(e){let t=Object.keys(e);if(t.length){for(const t in e)for(const s in e[t]){let a="Game";switch(t.substring(0,3)){case"cha":a="Character";break;case"com":a="Company";break;case"pag":a="Page"}e[t][s].type=a}let s=t.map((t=>e[t])).reduce(((e,t)=>e.concat(t)));return s.sort(((e,t)=>t.score-e.score)),s=s.map((e=>(e.cloudinary=cloudinary_id_to_url(e.cloudinary,"cover_small",!0),e))),s}return!1}resultTemplate(e,t){return e.title=e.text||e.name,e.id=e.value,[null,r.createElement("div",{key:`suggest_${e.id}`,className:"media"},r.createElement("div",{className:"media-left"},r.createElement("a",{href:e.url},r.createElement(w,{className:"micro",src:e.cloudinary,alt:`${e.title} photo`}))),r.createElement("div",{className:"media-body"},r.createElement("h4",{className:"media-heading"},r.createElement("a",{href:e.url,target:"_blank"},e.title)))),r.createElement("div",{key:`suggest_${e.id}`,className:"list-group-item"},r.createElement("a",{href:e.url},e.title)),r.createElement("div",{key:`suggest_${e.id}`,className:"media"},r.createElement("div",{className:"media-left media-middle"},r.createElement("a",{href:e.url},r.createElement(w,{className:"micro",src:e.cloudinary,alt:`${e.title} logo`}))),r.createElement("div",{className:"media-body"},r.createElement("h4",{className:"media-heading"},r.createElement("a",{href:e.url,target:"_blank"},e.title)),r.createElement("p",null,e.description))),r.createElement("div",{key:`suggest_${e.id}`,className:"list-group-item"},r.createElement("a",{href:e.url},e.title)),r.createElement("div",{key:`suggest_${e.id}`,className:"game-result",title:e.title},r.createElement("div",{className:"media overflow relative"},r.createElement("div",{className:"media-left"},r.createElement("a",{href:e.url},r.createElement("div",{className:"width-90"},r.createElement("div",{className:"game_cover"},r.createElement(w,{src:e.cloudinary,alt:`${e.title} cover`}),r.createElement(w,{src:e.cloudinary,alt:`${e.title} cover`}))))),r.createElement("div",{className:"media-body"},r.createElement("h4",{className:"media-heading"},r.createElement("a",{href:e.url},r.createElement("span",null,e.title)),e.release_year?r.createElement("small",{className:"game-shortdate text-muted"}," ","(",r.createElement("span",null,e.release_year),")"):null),e.released?r.createElement("div",{className:"quick-rating","data-game":e.id}):null,e.score))),r.createElement("div",{key:`autocomplete_${t}`,ref:e=>this.submenuLinks[t]=e,className:"media nomar igdb-autocomplete-all-suggest",onClick:this.setValue.bind(this,e.id,e.title),onKeyUp:this.keyup,onKeyDown:this.arrowFunctions},r.createElement("div",{className:"media-body media-middle"},r.createElement("div",{className:"igdb-autocomplete-title"},e.title))),null,r.createElement("div",{key:`suggest_${e.id}`,className:"list-group-item"},r.createElement("a",{href:e.url},e.title))][this.props.renderTemplateIndex||6]}allSuggestTemplate(e,t){return r.createElement("a",{key:`allsuggest_${e.id}`,ref:e=>this.submenuLinks[t]=e,className:"media nomar igdb-autocomplete-all-suggest",href:e.url,onClick:()=>{this.track(`Header Autocomplete ${e.type} Click`,{id:e.id,name:e.title,position:t+1}),this.hide()},onKeyUp:this.keyup,onKeyDown:this.arrowFunctions},r.createElement("div",{className:"media-left media-middle"},r.createElement("div",{className:"game_cover width-40"},e.cloudinary?r.createElement(w,{className:"cover_small",alt:`${e.text} image`,src:e.cloudinary,lossless:!0}):null)),r.createElement("div",{className:"media-body media-middle"},r.createElement("div",{className:"igdb-autocomplete-title"},e.value," ",e.year?r.createElement("span",{className:"text-muted"},"(",e.year,")"):null)),r.createElement("div",{className:"media-right media-middle text-nowrap text-muted text-light"},e.type))}header(){return this.minimalLayout?null:r.createElement("div",{className:"panel-heading"},r.createElement("div",{className:"panel-title"},r.createElement("span",{className:"igdb-autocomplete-title"},this.state.title),r.createElement("span",{className:"fa fa-times igdb-autocomplete-close pull-right",rel:"nofollow",onClick:this.hide})))}footer(){return this.minimalLayout?null:r.createElement("div",null,r.createElement("hr",null),r.createElement("div",{className:"igdb-autocomplete-footer overflow"},r.createElement("a",{href:`/advanced_search?q=${this.state.term}`,className:"btn btn-primary pull-right",onClick:this.hide},"Advanced Search"),r.createElement("a",{href:`/search?utf8=\u2713&q=${this.state.term}`,className:"btn nopad nomar",onClick:this.hide},"See all results for ",r.createElement("i",null,this.state.term))))}renderResults(){if(this.state.results){if(this.state.results&&this.props.customHandler)return this.state.results.map(this.allSuggestTemplate);if(void 0!==this.state.results.length)return this.state.results.slice(0,this.props.limit||5).map(this.resultTemplate)}else if(0==this.state.busy)return r.createElement("h4",{className:"nomar-bottom mar-lg-left"},"Sorry, there are no results!");return null}render(){const e=this.state.hidden?"":" show";return r.createElement("div",{className:"igdb-autocomplete-minimal"},this.props.name?r.createElement("input",{type:"hidden",name:this.props.name,value:this.state.selectedValue}):null,r.createElement("input",{ref:e=>this.inputElement=e,id:this.props.id,type:"text",name:this.props.paramKey,defaultValue:this.state.defaultTerm,className:"form-control header-search igdb-autocomplete-input",placeholder:this.props.placeholder,onFocus:this.focus,onKeyUp:this.debouncedKeyup,onKeyDown:this.arrowFunctions,autoComplete:"off"}),r.createElement("div",{className:`igdb-autocomplete-container${e}`,style:this.state.containerStyle,ref:e=>this.containerElement=e},r.createElement("div",{className:"panel panel-autocomplete"},this.header(),r.createElement("div",{className:"panel-body nopad"},this.renderResults(),this.footer()))))}}var T=C;class j extends r.Component{constructor(e){super(e),this.state=localStorage.getItem("search_debug")?JSON.parse(localStorage.getItem("search_debug")):{config:{},terms:[],results:{}},this.updateConfig=this.updateConfig.bind(this),this.updateTerm=this.updateTerm.bind(this),this.updateQuery=this.updateQuery.bind(this),this.resultsCount=this.resultsCount.bind(this)}updateConfig(e){let t;const s=l()(e.currentTarget).val();try{this.state.config=JSON.parse(s),this.state.configString=s}catch(a){t=a,this.state.configString=s}this.forceUpdate(),this.updateQuery()}updateTerm(e,t){const s=l()(t.currentTarget).val();this.state.terms[e]=s,this.forceUpdate(),this.updateQuery()}updateQuery(){let e="string"===typeof this.state.config?JSON.parse(this.state.config):this.state.config;return"string"===typeof e&&(e=JSON.parse(e)),"string"===typeof e&&(e=JSON.parse(e)),e.search=this.state.terms,l().ajax({url:"search_debug.json",data:e,success:function(e){return this.state.results=e,localStorage.setItem("search_debug",JSON.stringify({configString:this.state.configString,config:this.state.configString,terms:this.state.terms,results:this.state.results}))}.bind(this)})}resultsCount(){let e=0;const t=Object.assign({},this.state.results);return Object.keys(t).forEach((s=>{const a=t[s];null!=a.hits&&(e+=a.hits.hits.length)})),e}render(){return r.createElement("div",null,r.createElement("br",null),r.createElement("div",{className:"row"},r.createElement("div",{className:"col-sm-2"},r.createElement("p",null,"Config"),r.createElement("textarea",{className:"form-control",rows:"5",onChange:this.updateConfig,value:this.state.configString})),[0,1,2,3,4,5,6,7,8,9].map((e=>r.createElement("div",{key:`forms_${e}`,className:"col-sm-2"},r.createElement("div",{className:"form-group"},r.createElement("p",null,"Term"),r.createElement("input",{className:"form-control",type:"text",onChange:this.updateTerm.bind(this,e),value:this.state.terms[e]})))))),r.createElement("p",null,"Total Results: ",this.resultsCount()),r.createElement("table",{className:"table table-striped"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"Name"),r.createElement("th",null,"Type"),r.createElement("th",null,"Score"),r.createElement("th",null,"Visits"))),Object.keys(this.state.results).map((e=>{const t=this.state.results[e];return r.createElement("tbody",{key:`term_${e}`},r.createElement("tr",null,r.createElement("td",{colSpan:"4"},r.createElement("strong",null,e))),t.hits&&t.hits.hits?t.hits.hits.map(((t,s)=>r.createElement("tr",{key:`hit_${e}_${s}`},r.createElement("td",null,t._source.name||t._source.real_name," (",t._source.release_year,")"),r.createElement("td",null,t._type),r.createElement("td",null,t._score),r.createElement("td",null,t._source&&t._source.visits)))):null)}))))}}var O=j;class D extends r.Component{constructor(e){super(e),this.state={overall_score:Math.round(this.props.overall_score),scored:this.props.scored,unscored:this.props.unscored,show_all:!1,reviews_path:this.props.reviews_path},this.show_all=this.show_all.bind(this)}score_color(e){return e>=75?"success":e>=50?"warning":"danger"}score_description(e){switch(!0){case e>=90:return"Superb";case e>=75:return"Great";case e>=60:return"Good";case e>=40:return"Unimpressive";case e>=20:return"Bad";default:return"Awful"}}is_more(e){return!this.state.show_all&&e.length>10}show_all(){this.setState({show_all:!this.state.show_all})}render(){const e=this.state.scored,t=this.state.unscored;return r.createElement("div",{className:"row external-review"},e.length?r.createElement("div",{className:"col-xs-12 mar-lg-bottom"},r.createElement("h3",{className:"underscratch underscratch-green mar-lg-bottom","data-scrollspy":""},"Game Critics Reviews"),(()=>this.state.overall_score?r.createElement("h2",{className:"nomar-top mar-sm-bottom text-center"},this.score_description(this.state.overall_score),r.createElement("span",{className:`text-${this.score_color(this.state.overall_score)}`}," ",this.state.overall_score,"%")):null)(),(()=>this.state.overall_score?r.createElement("p",{className:"text-muted text-center"},"based on ",e.length," reviews"):null)()):null,e.map(((e,t)=>{const s=t<10||(this.state.show_all?"":"hide");return r.createElement("div",{key:`review_${e.id}`,className:"col-xs-6"},r.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:`external-review-item external-review-item-${this.score_description(e.score).toLowerCase()} ${s}`},r.createElement("span",null,e.source.name),e.score?r.createElement("div",{className:"pull-right"},`${e.score}%`):null))})),r.createElement("div",{className:this.is_more(e)?"col-xs-12 text-center mar-md-top":"hide"},r.createElement("div",{onClick:this.show_all,className:"text-purple cursor-pointer"},"Show All")),t?r.createElement("div",{className:"col-xs-12 mar-lg-top"},r.createElement("h3",{className:"underscratch underscratch-blue"},"Unscored Game Critics Reviews"),t.map(((e,t)=>r.createElement("a",{key:`review_${e.id}`,href:e.url,target:"_blank",rel:"noopener noreferrer",className:"external-review-item"},e.source.name,": ",e.name)))):null)}}var M=D;class R extends r.Component{constructor(e){super(e),this.score_description=this.score_description.bind(this)}score_description(e){return e?e>=90?"superb":e>=75?"great":e>=60?"good":e>=40?"unimpressive":e>=20?"bad":"awful":""}render(){const e=this.props.game,t="screenshot_big"===this.props.className?{paddingBottom:"57%"}:{};return r.createElement("a",{href:e.url,className:`review-panel review-panel-small review-panel-${this.score_description(e.rating)} embed-responsive embed-responsive-16by9`,style:t},r.createElement("div",{className:"review-panel-caption"},r.createElement("p",{className:"review-panel-title overflow-wrap"},e.name),r.createElement("p",{className:"review-panel-genres"},e.genres.split(",")[0])),e.rating?r.createElement("div",{className:"review-panel-rating"},Math.round(e.rating),"%"):null,r.createElement(w,{src:e.screenshot,className:`${this.props.className} embed-responsive-item`,responsive:"full-width"}))}}var P=R;var L=({game:e,href:t,overlay:s})=>{return React.createElement("a",{href:t||e.url,className:"game-card"},React.createElement(w,{src:e.cover,className:"cover_uniform game-card-image"}),s?React.createElement("div",{className:"game-card-overlay"},s):null,React.createElement("div",{className:"game-card-caption"},e.rating?React.createElement("div",{className:"game-card-aside text-"+(a=e.rating,a?a>=90?"superb":a>=75?"great":a>=60?"good":a>=40?"unimpressive":a>=20?"bad":"awful":"")},Math.round(e.rating),"%"):null,React.createElement("p",{className:"game-card-name"},e.name),React.createElement("small",{className:"game-card-subtitle"},e.genres.split(",")[0])));var a};class F extends r.Component{constructor(e){super(e),this.state={reviews:Object.keys(e.arr).map((t=>e.arr[t]))},this.textOverlay=this.textOverlay.bind(this),this.overlay=this.overlay.bind(this),this.scoreDescription=this.scoreDescription.bind(this),this.renderSixEleven=this.renderSixEleven.bind(this)}textOverlay(e){return r.createElement("div",{className:"review-panel-caption"},r.createElement("p",{className:"review-panel-title overflow-wrap"},e.name),r.createElement("p",{className:"review-panel-genres"},e.genres))}overlay(){return r.createElement("p",null,"Read",r.createElement("br",null),r.createElement("strong",null,"Reviews"))}scoreDescription(e){switch(!0){case!e:return"";case e>=90:return"superb";case e>=75:return"great";case e>=60:return"good";case e>=40:return"unimpressive";case e>=20:return"bad";default:return"awful"}}renderSixEleven(e,t){return e?t.map(((e,t)=>r.createElement("div",{key:`review3_${t}`,className:"col-xs-6 col-sm-5ths"},r.createElement(L,{href:e.url,game:e,overlay:this.overlay()})))):this.state.reviews.length>6?r.createElement("div",{className:"pad"},r.createElement("a",{className:"btn btn-block",href:"/reviews"},"Show All")):null}render(){const e=this.state.reviews.slice(0,3),t=this.state.reviews.slice(4,6);let s=[],a=!1;this.state.reviews[6]&&(a=!0,s=this.state.reviews.slice(6,11));const i=this.state.reviews.slice(11,31);return r.createElement("div",{className:"review-panels"},r.createElement("div",{className:"row"},e.map(((e,t)=>r.createElement("div",{key:`review1_${t}`,className:"col-sm-4"},r.createElement(P,{game:e,className:"screenshot_med"}))))),r.createElement("div",{className:"row"},r.createElement("div",{className:"col-lg-8"},this.state.reviews[3]?r.createElement(P,{game:this.state.reviews[3],className:"screenshot_big"}):null),t.map(((e,t)=>r.createElement("div",{key:`review2_${t}`,className:"col-sm-6 col-lg-4"},r.createElement(P,{game:e,className:"screenshot_med"}))))),r.createElement("div",{className:"row mar-lg-bottom"},this.renderSixEleven(a,s)),r.createElement("div",{className:"row fix-heights"},i.map(((e,t)=>r.createElement("div",{key:`review4_${t}}`,className:"col-xs-6 col-md-4 mar-md-bottom"},r.createElement("a",{href:e.url,className:"media"},r.createElement("div",{className:"media-left micro-container"},r.createElement(w,{src:e.cover,className:"cover_small"})),r.createElement("div",{className:"media-body media-middle"},e.name),r.createElement("div",{className:`media-right media-middle text-${this.scoreDescription(e.rating)}`},Math.floor(e.rating),"%")))))))}}var q=F;class z extends r.Component{constructor(e){super(e),this.state={overall_score:Math.round(e.overall_score),scored:e.scored,unscored:e.unscored,show_all:!1,reviews_path:e.reviews_path,count:e.count}}score_color(e){return e>=75?"success":e>=50?"warning":"danger"}score_description(e){switch(!0){case!e:return"";case e>=90:return"Superb";case e>=75:return"Great";case e>=60:return"Good";case e>=40:return"Unimpressive";case e>=20:return"Bad";default:return"Awful"}}is_more(e){return!this.state.show_all&&e.length>3}show_all(){this.setState({show_all:!this.state.show_all})}track_review(){mp.track("click","game_critic")}track_readmore(){mp.track("click","read_more_game_critic")}render(){let e=this.state.scored;if(this.state.count)return r.createElement("div",{className:"mar-lg-bottom"},r.createElement("h3",{className:"underscratch underscratch-green mar-lg-bottom","data-scrollspy":""},"Game Critics Reviews"),e.map(((e,t)=>{if(e)return r.createElement("div",{key:`review_${e.id}`},r.createElement("a",{onClick:this.track_review,href:e.url,target:"_blank",className:`external-review-item external-review-item-${this.score_description(e.score).toLowerCase()} ${t<3||this.state.show_all?"":"hide"}`},r.createElement("span",null,e.source.name),r.createElement("div",{className:"pull-right"},e.score?`${e.score}%`:""),r.createElement("div",{className:"external-review-item-progress",style:{width:e.score+"%"}})))})),r.createElement("div",{className:"mar-md-top mar-lg-bottom"},r.createElement("a",{onClick:this.track_readmore,href:this.state.reviews_path,className:"text-purple cursor-pointer"},"Read all ",this.state.count," critic reviews")))}}var B=z;var A=e=>{const[t,s]=r.useState(""),a=e.previewParent,i=e.previewTarget,n=(e,t)=>{l()(e.target).parents(a).find(i).html(t)},o=e=>{console.log(e),newrelic.noticeError(e)};return r.createElement(r.StrictMode,null,r.createElement("div",null,r.createElement("input",{type:"hidden",name:e.name,value:t}),r.createElement("input",{onChange:e=>(e=>{e.persist();const t=e.target.files[0],a=Math.round(t.size/1024);a>=51200?alert("File too Big, please select a file less than 50mb"):a<42?alert("File too small, please select a file greater than 42 bytes"):fetch("/file_uploads/presign").then((e=>e.json())).then((a=>{const r=new FormData;for(const[e,t]of Object.entries(a.fields))r.append(e,t);r.append("file",t),n(e,'<div class="d-flex justify-content-center"><div class="sbl-circ-path" role="status"/></div>'),fetch(a.url,{method:"POST",body:r}).then((e=>console.log(e))).catch(o).finally((()=>{const t=a.fields.key;s(t),i&&n(e,`<img class="img-responsive screenshot_big screenshot_big" src="/image_preview/${t.split("/")[1]}.jpg">`)}))})).catch(o)})(e),type:"file",accept:"image/png, image/jpeg, image/gif"})))};const I=({className:e,content:t,onClick:s,disabled:a})=>r.createElement("div",{className:`btn ${e||""} ${a?"disabled":""}`,onClick:a?null:s},t),U=({className:e,toggleElem:t,items:s,open:a,onBlur:i})=>{const n=a?"open":"";return r.createElement("div",{className:`${e||""} dropdown ${n}`,tabIndex:"-1",onBlur:i?e=>{var t=e.currentTarget;setTimeout((function(){t.contains(document.activeElement)||i()}),0)}:null},t,r.createElement("ul",{className:"dropdown-menu"},s))};class W extends r.Component{constructor(e){super(e),this.state={loading:!1},this.buttonClick=this.buttonClick.bind(this)}UNSAFE_componentWillReceiveProps(e){e.loading!=this.state.loading&&this.setState({loading:e.loading})}shouldComponentUpdate(e,t){return t.loading!==this.state.loading||e.className!==this.props.className||e.content!==this.props.content||e.disabled!==this.props.disabled||e.url!==this.props.url}performRequest(){this.setState({loading:!0},(()=>{$.ajax({url:this.props.url,type:this.props.type||"GET",dataType:this.props.dataType||"json",complete:this.props.processResponse})}))}buttonClick(){if(this.state.loading||this.props.disabled)return!1;this.props.requireLogin?E(this.props.loginMessage)&&this.performRequest():this.performRequest()}render(){return r.createElement(I,{disabled:this.props.disabled,className:`${this.state.loading?"m-progress":""} ${this.props.className}`,onClick:this.buttonClick,content:this.props.content})}}var V=W;class H extends r.Component{constructor(e){super(e),this.state={},this.dropDownToggle=this.dropDownToggle.bind(this)}componentDidMount(){l().ajax({url:this.props.notificationsUrl,dataType:"json",success:(e=>{this.setState({requests:e.requests})}).bind(this)})}dropDownToggle(e){return e.preventDefault(),this.setState({dropDownOpen:!this.state.dropDownOpen}),!1}acceptFriendHandler(e){let t=this.state.requests.slice(0);t=t.filter((t=>t.id!==e.id)),this.setState({requests:t})}declineFriendHandler(e){let t=this.state.requests.slice(0);t=t.filter((t=>t.id!==e.id)),this.setState({requests:t})}requestList(){return this.state.requests.map((e=>r.createElement("li",{key:`request_${e.id}`,className:"notification relative"},r.createElement("p",null,r.createElement("strong",null,r.createElement("a",{href:e.user.url},e.user.username))," ","sent you a friend request"),r.createElement("div",{className:"friendship-request"},r.createElement(V,{className:"btn-default btn-xs",url:`${e.user.url}/friendships`,content:"Accept",type:"POST",processResponse:this.acceptFriendHandler.bind(this,e)}),r.createElement(V,{className:"btn-danger btn-xs mar-sm-left",url:`${e.user.url}/friendship_requests/${e.id}`,content:"Decline",type:"DELETE",processResponse:this.declineFriendHandler.bind(this,e)})))))}onlineList(){return r.createElement("li",{key:"friendsonline"},r.createElement("ul",{className:"header-friends-online"},this.state.friends.map((e=>e.online?r.createElement("li",{key:`friend_${e.id}`,className:"header-friends-online-friend"},r.createElement("span",{className:"material-icons"},"circle"),e.slug):null))))}render(){let e=r.createElement("a",{className:"dropdown-toggle relative",href:"#",onClick:this.dropDownToggle},r.createElement("span",{className:"material-icons"},"person_add"),this.state.requests&&this.state.requests.length?r.createElement("span",{className:"notif-count"},this.state.requests.length):null,r.createElement("span",{className:"hidden-sm hidden-md hidden-lg"},"Friends")),t=[];return this.state.requests&&(t=t.concat(this.requestList())),this.state.friends&&(t=t.concat(this.onlineList())),window.current_user&&t.push(r.createElement("li",{key:"view_all_link"},r.createElement("span",{className:"text-center block mar-sm"},r.createElement("a",{href:`/users/${window.current_user.slug}/friends`},"View all friends")))),r.createElement(U,{className:"friends",toggleElem:e,items:t,open:this.state.dropDownOpen})}}var G=H,Y=s(8),J=s.n(Y);class K extends r.Component{constructor(e){super(e);const{placeholder:t}=e;this.state={rendered_date:t},this.tz=J().tz.guess(),this.from_now=this.from_now.bind(this)}componentDidMount(){this.from_now(),this.startTimer()}componentWillUnmount(){this.stopTimer()}startTimer(){this.timeout=setInterval(this.from_now,this.props.interval||6e4)}stopTimer(){clearInterval(this.timeout)}UNSAFE_componentWillReceiveProps(e){this.stopTimer(),this.from_now(),this.startTimer()}short(e){return this.props.short&&(e=(e=(e=(e=e.replace(" ago","")).replace(" minutes","m")).replace(" hours","h")).replace(" days","d")),e}localizeDate(e){return 1e3*(J()(e).unix()-(J()().unix()+60*J().tz(this.tz)._offset))}from_now(){const e="string"===typeof this.props.date?J()(this.props.date,"YYYY-MM-DD hh:mm:ss Z"):J().utc(this.props.date).local();this.props.format?this.setState({rendered_date:this.short(this.localizeDate(this.props.format))}):this.props.custom_format?this.setState({rendered_date:this.short(this.props.custom_format(this.localizeDate(e)))}):this.setState({rendered_date:this.short(e.fromNow())})}render(){return r.createElement("span",{className:this.props.className},this.state.rendered_date)}}var Q=K;class X extends r.Component{constructor(e){super(e),this.state={seen:!1},this.deleteNotification=this.deleteNotification.bind(this),this.onHover=this.onHover.bind(this)}onHover(){this.setState({seen:!0}),this.props.onMouseEnter()}actionText(){return this.props.options.text}deleteNotification(){$.ajax({url:`/notification_owners/${this.props.options.id}`,type:"DELETE"}),this.props.onDestroy(this.props.options.id)}deleteButton(){return r.createElement("a",{className:"notification-delete",rel:"nofollow",href:"#",onClick:this.deleteNotification},r.createElement("i",{className:"fa fa-times"}))}render(){return r.createElement("li",{className:"notification relative",onMouseEnter:this.onHover},this.deleteButton(),r.createElement("a",{className:this.props.options.seen||this.state.seen?"":"unseen",href:this.props.options.url,target:"_self"},r.createElement("div",{dangerouslySetInnerHTML:{__html:this.actionText()}}),r.createElement(Q,{date:this.props.options.created_at})))}}var Z=X;class ee extends r.Component{constructor(e){super(e),this.state={},this.onDestroy=this.onDestroy.bind(this)}onDestroy(e){let t=this.state.notifications.slice(0);t=t.filter((t=>t.id!==e)),this.setState({unseenCount:this.countUnseen(t),notifications:t})}countUnseen(e){return e?e.filter((e=>!e.seen)).length:0}notificationList(){return this.props.notifications.map((e=>r.createElement(Z,{options:e})))}render(){return r.createElement("ul",{className:"notifications"},this.notificationList())}}var te=ee;class se{static ujs_exists(){return!("undefined"===typeof React||null===React||!this.findNodes().length)}static findNodes(e){return e||(e=document.body),l()(e).find("[data-react-class]:not(.loaded)")}static mount(e){if(this.ujs_exists()){const t=this.findNodes(e);for(let e=0;e<t.length;++e){const s=t[e],a=s.getAttribute("data-react-class"),i=window[a];let r=s.getAttribute("data-react-props");const n=r&&JSON.parse(r);if("undefined"===typeof i){const e="Cannot find component: '"+a+"'";throw console&&console.log&&console.log("%c[react-rails] %c"+e+" for element","font-weight: bold","",s),new Error(e+". Make sure your component is globally available to render.")}s.classList.add("loaded"),ReactDOM.render(React.createElement(i,n),s)}}}static unmount(e){e||(e=document.body),l()(e).find("[data-react-class]").each(((e,t)=>ReactDOM.unmountComponentAtNode(t)))}static get(e){return this.ajax("GET",e)}static post(e){return this.ajax("POST",e)}static ajax(e,t){return new Promise((function(s,a){const i=Object.keys(t).map((function(e){return{name:e,params:t[e]}})),r="POST"===e?JSON.stringify({actions:i}):{actions:i};l().ajax({type:e,data:r,processData:"POST"!==e,url:"/react",dataType:"json",contentType:"application/json",success:function(e){s(e)},error:function(){a()}})}))}}var ae=class extends te{constructor(e){super(e),this.dropDownToggle=this.dropDownToggle.bind(this),this.sendSeen=this.sendSeen.bind(this),window.is_server||se.get({user_notifications:{limit:5}}).then((e=>{this.setState({notifications:e.user_notifications,unseenCount:this.countUnseen(e.user_notifications)})}).bind(this))}handleLiveNotification(e){var t=this.state.notifications.slice(0);t.unshift(e.data),this.setState({unseenCount:this.countUnseen(t),notifications:t})}dropDownToggle(e){return e.preventDefault(),this.setState({dropDownOpen:!this.state.dropDownOpen}),!1}notificationList(){return this.state.notifications&&this.state.notifications.length?this.state.notifications.map(((e,t)=>r.createElement(Z,{key:`notification_${t}`,options:e,onDestroy:this.onDestroy,onMouseEnter:this.sendSeen}))):[r.createElement("li",{key:"no_notifications"},r.createElement("p",{className:"text-center"},"No Notifications"))]}sendSeen(){this.state.unseenCount&&$.ajax({url:"/react",type:"POST",data:JSON.stringify({seen_notifications:null}),dataType:"json",contentType:"application/json",success:(e=>{this.setState({unseenCount:0})}).bind(this)})}render(){let e=r.createElement("a",{className:"dropdown-toggle relative",href:"#",onClick:this.dropDownToggle},r.createElement("span",{className:"material-icons"},"notifications"),r.createElement("span",{className:"notif-count "+(this.state.unseenCount?"":"hide")},this.state.unseenCount),r.createElement("span",{className:"hidden-sm hidden-md hidden-lg"},"Notifications")),t=this.notificationList();return t.push(r.createElement("li",{key:"view_all_link"},r.createElement("span",{className:"text-center block mar-sm"},r.createElement("a",{href:"/users/notifications"},"View all notifications")))),r.createElement(U,{className:"notif",toggleElem:e,items:t,open:this.state.dropDownOpen})}};class ie extends r.Component{render(){const{date:e=null,timeAgo:t=null,...s}=this.props,a=t&&r.createElement("span",null," ","(",r.createElement(Q,{date:c()(t),placeholder:"..."}),")");return e&&r.createElement("span",s,r.createElement("span",null,e),a)}}var re=ie;class ne extends r.Component{constructor(e){super(e);const t={interacted:!1,player:!1,width:this.props.width,height:this.props.height,autoplay:e.autoplay,setup:Object.assign({},{techOrder:["youtube"],sources:this.youtubeSrc(this.props.src),muted:this.props.muted||!0,plugins:{videoJsResolutionSwitcher:{default:"high",dynamicLabel:!0}},youtube:{iv_load_policy:3,rel:0,showinfo:0}},this.props.setup)};this.state=t,this.scroll_timeout=0,this.scroll=this.scroll.bind(this),this.play=this.play.bind(this),this.youtubeSrc=this.youtubeSrc.bind(this),this.onInteract=this.onInteract.bind(this),this.onReady=this.onReady.bind(this),this.onVolumeChange=this.onVolumeChange.bind(this),this.onVolumeChangeCallback=e.onVolumeCallback}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.log(e,t)}componentDidMount(){f||window.addEventListener("scroll",this.scroll);const e=this.props.volume>-1?this.props.volume:0;if(this.videoRef){const t=videojs(this.videoRef,this.state.setup,this.onReady).on("volumechange",this.onVolumeChange).on("mute",this.onVolumeChange).on("click",this.onInteract);this.props.onEnd&&t.on("ended",this.props.onEnd),this.props.onProgress&&t.on("timeupdate",this.props.onProgress),this.props.onMediaError&&t.on("error",this.props.onMediaError),this.setState({player:t},(function(){e&&(this.state.player.muted(!1),this.state.player.volume(e)),e||this.state.player.muted(!0),this.props.src.indexOf("imgur")>-1&&this.state.player.controlBar.volumeMenuButton.addClass("hide")}))}}UNSAFE_componentWillReceiveProps(e){e&&(e.src!==this.props.src&&(this.state.player.src(this.youtubeSrc(e.src)),e.autoplay&&(this.state.autoplay=e.autoplay,this.play())),e.width!==this.state.width&&this.setState({width:e.width,height:e.height},(()=>{this.state.player.width(e.width),this.state.player.height(e.height)})))}shouldComponentUpdate(e,t){return e.src!==this.props.src||(t.width!==this.state.width||t.height!==this.state.height||!1!==t.player)}componentWillUnmount(){this.state.player&&this.state.player.isReady_&&this.state.player.dispose(),window.removeEventListener("scroll",this.scroll)}scroll(){null!==this.scroll_timeout&&clearTimeout(this.scroll_timeout),this.scroll_timeout=setTimeout(this.play,100)}play(){if("1"===localStorage.getItem("enableVideoAutoplay")&&this.state.autoplay&&this.state.player){(e=>{var t,s;if(e){for(s=e.offsetTop,e.offsetLeft,e.offsetWidth,t=e.offsetHeight;e.offsetParent;)s+=(e=e.offsetParent).offsetTop,e.offsetLeft;return s+t<window.pageYOffset+window.innerHeight&&s>window.pageYOffset}})(this.state.player.el_)?this.state.player.play():this.state.player.pause()}}generateSrc(e){let t=e;return Modernizr.video&&(Modernizr.video.webm||(t=e.replace(".webm",".mp4"))),e.indexOf(".gifv")>-1?[{type:"video/mp4",src:e.replace("gifv","mp4")},{type:"video/webm",src:e.replace("gifv","webm")}]:[{src:t}]}youtubeSrc(e){let t=e;return t&&-1===t.indexOf(".")&&(t=`https://www.youtube.com/watch?v=${e}`),[{type:"video/youtube",src:t}]}onInteract(){this.state.interacted||(window.removeEventListener("scroll",this.scroll),this.state.player.muted(!1),this.state.player.volume(.75),this.setState({interacted:!0}),this.onVolumeChange())}onReady(){this.state.autoplay&&!window.is_mobile&&this.play(),this.props.onReady&&this.props.onReady(this.state.player)}onVolumeChange(){if(this.onVolumeChangeCallback){const e=this.state.player.muted()||this.state.setup.muted?0:this.state.player.volume();this.onVolumeChangeCallback(e)}}render(){return window.is_mobile?r.createElement("div",{className:"embed-responsive embed-responsive-16by9"},r.createElement("iframe",{className:`embed-responsive-item ${this.props.className}`,src:`https://www.youtube.com/embed/${this.state.setup.sources[0].src.split("=")[1]}`,frameBorder:"0",allowFullScreen:!0})):r.createElement("div",{"data-vjs-player":!0},r.createElement("video",{ref:e=>{this.videoRef=e},className:`video-js vjs-default-skin ${this.props.className}`,style:this.props.style,width:this.state.width,height:this.state.height,controls:!0,preload:"auto"}))}}var le=ne;class oe extends r.Component{constructor(e){super(e),this.state={ids:[],meta:{},meta_switch:!1,autoplay:!0},this.switch_interval=0,this.next_trailer_json={},this.has_started=!1,this.prepareNextTrailer=this.prepareNextTrailer.bind(this),this.playNextTrailer=this.playNextTrailer.bind(this),this.onReady=this.onReady.bind(this),this.onEnd=this.onEnd.bind(this),this.onProgress=this.onProgress.bind(this),this.onStart=this.onStart.bind(this),this.prepareNextTrailer(!0),this.switch_inteval=setInterval((()=>{this.setState({meta_switch:!this.state.meta_switch})}),5e3)}componentWillUnmount(){clearInterval(this.switch_inteval)}prepareNextTrailer(e){null==e&&(e=!1);const t=!(this.state.ids.length>15||!this.state.ids.length)&&{ids:this.state.ids.join(",")};l().ajax({url:"/next_trailer",data:t,success:function(t){if(this.next_trailer_json=t,e)return this.playNextTrailer()}.bind(this)})}playNextTrailer(){let e;this.state.ids.push(this.next_trailer_json.meta.id);const{release_date:t,release_date_time_ago:s}=this.next_trailer_json.meta;return this.setState({src:`https://youtu.be/${this.next_trailer_json.video.video_id}`,meta:this.next_trailer_json.meta,platforms:function(){let t,s;const a=this.next_trailer_json.platforms,i=[];for(t=0,s=a.length;t<s;t+=1)e=a[t],i.push(e[0]);return i}.call(this).join(" / "),release_date:t,release_date_time_ago:s,ids:this.state.ids})}onReady(){}onEnd(){this.has_started=!1,this.playNextTrailer()}onProgress(){this.has_started||(this.onStart(),this.has_started=!0)}onStart(){this.prepareNextTrailer()}render(){return r.createElement("div",{className:"igdbtv-container",style:{height:this.props.fullscreen?"100vh":"797px"}},this.state.src?r.createElement(me,{className:"igdbtv",style:{height:this.props.fullscreen?"calc(100vh - 118px)":"648px"},autoplay:!0,src:this.state.src,onReady:this.onReady,onEnd:this.onEnd,onProgress:this.onProgress}):null,r.createElement("div",{ref:"media",className:"igdbtv-meta media col-xs-12"},this.state.meta.cloudinary_cover?r.createElement("div",{className:"media-left media-middle"},r.createElement("a",{href:`/games/${this.state.meta.slug}`},r.createElement(w,{src:this.state.meta.cloudinary_cover,force_load:!0,className:"cover_small"}))):null,r.createElement("div",{className:"media-body media-middle"},r.createElement("h1",{className:"nomar-top"},r.createElement("a",{href:`/games/${this.state.meta.slug}`},this.state.meta.name)),this.state.platforms?r.createElement("div",{className:"igdbtv-metaswitch"},r.createElement("h2",{className:this.state.meta_switch?"opacity0":"opacity1"},this.state.platforms),r.createElement("h2",{className:this.state.meta_switch?"opacity1":"opacity0"},r.createElement(re,{date:this.state.release_date,timeAgo:this.state.release_date_time_ago}))):null),r.createElement("div",{className:"media-right media-middle text-right"},r.createElement("div",{className:"pull-right cursor-pointer igdbtv-skip",onClick:this.onEnd},"Skip",r.createElement("span",{className:"material-icons"},"chevron_right")))))}}var ce=oe;class me extends le{scroll(){return!1}play(){this.state.player&&this.state.player.play()}}s(9154);class de extends r.Component{constructor(e){super(e),this.state={active:!1,loading:!1}}UNSAFE_componentWillReceiveProps(e){e.loading?this.setState({active:e.active,loading:!0}):this.setState({loading:!1})}followHandler(e){const t="Followed"===(e=e.responseJSON).result||"Unfollow"===e.result;t&&mp.track("follow_game",`/games/${this.props.slug}`),this.props.followedCallback&&this.props.followedCallback(t),this.setState({loading:!1,active:t})}render(){const e=`/games/${this.props.id}/${this.props.follow?"follows":"hypes"}`;return r.createElement(V,{className:`btn-${this.state.active?"default":"primary"} ${this.props.className}`,url:e,content:this.state.active?"Following":"Follow",requireLogin:!0,loading:this.state.loading,type:"POST",processResponse:this.followHandler.bind(this)})}}var he=de;class ue extends r.Component{constructor(e){super(e);let t=this.props.html||"",s=t.replace(/(<([^>]+)>)/gi,"").substring(0,this.props.limit);s+="... <span class='text-purple cursor-pointer'>Read More</span>",e.noProcess||(t=(e=>{if(!e)return"";let t=[];const s=(e,s)=>(t.push({processor:e,value:s}),`|%${t.length-1}%|`),a=(t,s)=>(s=s.replace(/[\<\>\"]/g,"")).indexOf("igdb.com")>-1?e.replace(t,`<a href="${s}" target="_self">${s}</a>`):e.replace(t,`<a href="${s}" target="_blank" rel="nofollow noreferrer nofollow">${s}</a>`),i=(t,s)=>e.replace(t,`<a href="mailto:${s}">${s}</a>`),r=(t,s)=>e.replace(t,`<a href="/users/${s.substring(1).toLowerCase()}" target="_blank">${s}</a>`),n=(e=e.replace(/(<([^>]+)>)/gi,"").replace(/(https?:\/\/[^\s]+)/g,(e=>s(a,e))).replace(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi,(e=>s(i,e))).replace(/@[a-zA-Z0-9._-]*/gi,(e=>s(r,e))).replace(/\n/g,"<br />")).match(/\|\%(\d*)\%\|/g);return n&&n.forEach((s=>{const a=s.substring(2,s.length-2);let i=t[a];e=i.processor(s,i.value)})),e=p().replace(e)})(t)),this.state={html:t,truncated:s,limit:this.props.limit,expanded:!1,className:this.props.className||""},this.expand=this.expand.bind(this)}expand(){this.setState({expanded:!0})}render(){return this.state.expanded||this.state.html.length<this.state.limit?r.createElement("div",{className:this.state.className,dangerouslySetInnerHTML:{__html:this.state.html}}):r.createElement("div",{className:this.state.className,onClick:this.expand,dangerouslySetInnerHTML:{__html:this.state.truncated}})}}var pe=ue;class ge extends r.Component{constructor(e){super(e),this.state={loading:!0,follow_loading:!0},e.game&&e.game.release_dates&&(this.release_dates=e.game.release_dates,this.release_dates.sort(((e,t)=>e.date-t.date))),this.state.featuredReleaseDate=this.setFeaturedReleaseDate(window.user_country),this.regions=[],this.tz=moment.tz.guess(),Object.keys(this.props.regions).forEach((e=>this.regions[this.props.regions[e]]=e)),this.formatDate=this.formatDate.bind(this)}componentDidMount(){this.getUserCountry(),this.getHypedData(),l()(".game-list-inline").slick({arrows:!0,dots:!1,adaptiveHeight:!1,slidesToShow:6,slidesToScroll:6,infinite:!1,swipeToSlide:!0,nextArrow:"<div class='slick-arrow-next'><span class='material-icons'>keyboard_arrow_right</span></div>",prevArrow:"<div class='slick-arrow-prev'><span class='material-icons'>keyboard_arrow_left</span></div>"})}localizeDate(e){return moment(e).unix()-(moment().unix()+60*moment.tz(this.tz)._offset)}getUserCountry(){this.state.geoip||l().getJSON(this.props.geoip_url,(e=>{window.user_country=e,this.setState({featuredReleaseDate:this.setFeaturedReleaseDate(e)})}))}getHypedData(){b()?se.get({followed:{id:this.props.game.id}}).then((e=>{this.setState({followed:e.followed},(()=>{this.setState({follow_loading:!1})}))})):this.setState({follow_loading:!1})}getPlatform(e){return this.props.game.platforms.find((t=>t.indexOf(e.platform)>-1))[0]}setFeaturedReleaseDate(e){if(e){const t=e.region;return this.release_dates.filter((e=>e.region===t))[0]||this.release_dates.filter((e=>8===e.region))[0]||this.release_dates[0]}return this.release_dates[0]}formatDate(e){const t=moment.duration(e),s=t.asDays();return s>0?`${Math.floor(s)} days, ${t.hours()} hours, ${t.minutes()} minutes and ${t.seconds()} seconds.`:`Released ${t.humanize()} ago.`}featuredReleaseDate(){if(this.state.featuredReleaseDate){const e=moment(this.state.featuredReleaseDate.date).diff(moment(),"days"),t=this.state.featuredReleaseDate.region;return f()?r.createElement("h3",null,this.formatDate(1e3*this.localizeDate(this.state.featuredReleaseDate.date))):r.createElement("div",null,e>0?r.createElement("h3",null,`${this.regions[t]}: ${moment(this.state.featuredReleaseDate.date).format("Do MMMM, YYYY")}`):null,r.createElement("h3",null,e>0?r.createElement("div",{className:"countdown","data-date":this.state.featuredReleaseDate.date}):`Already released ${8===t?"":"in "}${this.regions[t]} on ${this.getPlatform(this.state.featuredReleaseDate)}`),r.createElement("br",null),r.createElement("a",{className:"hide",itemProp:"url",href:`${this.props.game.url}`},this.props.game.name))}return null}render(){return r.createElement("div",null,this.featuredReleaseDate(),r.createElement("div",null,r.createElement(he,{id:this.props.game.id,className:"btn btn-primary btn-lg pull-left mar-lg-right",loading:this.state.follow_loading,active:this.state.followed,follow:!0}),r.createElement("a",{className:"btn btn-default btn-lg",href:this.props.game.url},"Learn more"," ",f()?null:r.createElement("span",null,"about ",r.createElement("strong",null,this.props.game.name)))),r.createElement("br",null),r.createElement("br",null),r.createElement("table",{className:"table table-condensed"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"Region"),r.createElement("th",null,"Time left until release day"),r.createElement("th",null,"Platform"))),r.createElement("tbody",null,this.props.game&&this.release_dates.map((e=>r.createElement("tr",{key:e.id},r.createElement("td",null,this.regions[e.region]),r.createElement("td",null,r.createElement(Q,{date:e.date,custom_format:this.formatDate,interval:1e3})),r.createElement("td",null,this.getPlatform(e))))))),this.props.summary?r.createElement("div",null,r.createElement("h3",null,"Description"),r.createElement(pe,{limit:450,html:this.props.summary,itemProp:"description"})):null)}}var _e=ge;var fe=function({game:e,child_games:t}){const[s,a]=(0,r.useState)(void 0),{release_date:i,category_parent:n,category:l}=e,o=e.cloudinary_cover||"nocover",m=e.url_prefix||"games";return(0,r.useEffect)((()=>{se&&n&&!s&&se.get({game:{id:n}}).then((e=>{a(e.game)}))}),[]),r.createElement("div",{className:"media",title:e.name},r.createElement("div",{className:"media-left width-90"},r.createElement("div",{className:"game_cover"},r.createElement("a",{href:`/games/${e.slug}`},r.createElement("img",{className:"object-scale-down",src:`https://images.igdb.com/igdb/image/upload/t_cover_small/${o}.png`,alt:e.name,loading:"lazy"}),r.createElement("img",{className:"cover-big",style:{display:"none"},src:`https://images.igdb.com/igdb/image/upload/t_cover_big/${o}.png`,alt:e.name,loading:"lazy"})))),r.createElement("div",{className:"media-body"},r.createElement("a",{className:"overflow-wrap link-dark h4 mt-0",href:`/${m}/${e.slug}`},e.name,i?r.createElement("time",{className:"game-shortdate text-muted small",dateTime:i}," ","(",c()(i).format("YYYY"),")"):null),e.rating_score?r.createElement("div",null,"Rated: ",e.rating_score," / 100"):null,e.simple_platforms?r.createElement("div",{className:"mar-md-bottom"},e.simple_platforms.map(((t,s)=>r.createElement(r.Fragment,{key:s}," ",t[1]?r.createElement("a",{href:`/top-100/games/platform/${t[1]}`},t[0]):r.createElement("span",null,t[0])," ",s<e.simple_platforms.length-1&&" / ")))):null,l&&r.createElement("div",{className:"game-type-container"},r.createElement("span",{className:`game-type ${l.key}`},l.name),s&&r.createElement("span",null,"of ",r.createElement("a",{href:`/games/${s.slug}`},s.name)," (",c()(s.release_date).format("YYYY"),")")),t?t.map((e=>r.createElement("div",{key:`dlc_${e.parent}_${e.id}`,className:"media overflow"},r.createElement("div",{className:"media-left"},r.createElement("span",{className:`game-type ${e.category_key}`},e.category)),r.createElement("div",{className:"media-body"},r.createElement("h4",{className:"media-heading"},r.createElement("a",{href:e.url},r.createElement("span",null,e.name))," ",r.createElement("small",{className:"game-shortdate text-muted"},r.createElement("span",null,6==e.status?"Cancelled":e.year||"TBA"),r.createElement("strong",null,e.rating?`${e.rating_score} / 100`:""))),r.createElement("hr",{className:"nomar"}))))):null))};var be=function(e){function t(t){const{child_games:s}=e;if(!s||!s.length)return;return s.filter((e=>e.parent&&e.parent.length&&e.parent[0]===t))}return e.games.map(((e,s)=>r.createElement(fe,{game:e,child_games:t(e.id),key:`${s}_${e.id}`})))};var ve=({games:e})=>r.createElement("div",{className:"game-grid"},e.map((e=>r.createElement("a",{key:`gamegrid-${e.id}`,href:e.url,className:"game-grid-item"},r.createElement("div",{className:"game-grid-caption"},e.name),r.createElement(w,{src:e.cloudinary_cover,className:"cover_med"})))));class Ee extends r.Component{constructor(e){super(e),this.state=Object.assign({},e,{selected_tab:e.defaultTab}),this.isTabSelected=this.isTabSelected.bind(this),this.selectTab=this.selectTab.bind(this),this.idify=this.idify.bind(this),this.activeWidth=this.activeWidth.bind(this)}componentDidMount(){this.setState({tabs_size:this.activeWidth(this.state.selected_tab)})}isTabSelected(e){return(this.state.selected_tab||0)===e?"active":""}selectTab(e,t,s){return s.preventDefault(),this.setState({tabs_size:this.activeWidth(e),selected_tab:e}),this.state.callback&&this.state.callback(e,t),!1}idify(e){return e.toLowerCase().replace(/[^a-z]*/g,"")}activeWidth(e){const t=l()(this[`tab_${e||0}`]);return[`${t.width()}px`,`${t.position().left}px`]}render(){return r.createElement("div",{className:`compwnent-tabs ${this.props.className||""}`},r.createElement("ul",{className:"compwnent-tabs-list"},this.state.items.map(((e,t)=>{const s=`tab_${t}`;return r.createElement("li",{key:s,ref:e=>{this[s]=e},className:`${this.isTabSelected(t)} ${e.className||""}`},"object"==typeof e?r.createElement("a",{target:"_self",href:e.url,onClick:this.selectTab.bind(this,t,e)},e.name):r.createElement("div",{onClick:this.selectTab.bind(this,t,e)},e))}))),this.state.tabs_size?r.createElement("div",{className:"compwnent-tabs-follower",style:{width:this.state.tabs_size[0],left:this.state.tabs_size[1]}}):null)}}var we=Ee;class ye extends r.Component{constructor(e){super(e),this.addLinkToList=this.addLinkToList.bind(this),this.renderEditSentence=this.renderEditSentence.bind(this),this.renderNoWebsite=this.renderNoWebsite.bind(this),this.renderWebsite=this.renderWebsite.bind(this),this.renderWebsitesList=this.renderWebsitesList.bind(this);const{websites:t,websitesConfig:s}=this.props;this.websiteLists=s.reduce((([e,s],a)=>{const i=t&&t.find((({site:e})=>a.id===e));if(!i)return[e,s];const{icon:r,svg:n,name:l,type:o}=a,c={...i,type:o,icon:r,svg:n,name:l};return[this.addLinkToList("store",e,c),this.addLinkToList("social",s,c)]}),[[],[]])}addLinkToList(e,t,s){return e!==s.type?t:[...t,s]}renderEditSentence(){const{editUrl:e,promptLogin:t,mobile:s}=this.props;if(s)return null;return[" Care to ",b()?r.createElement("a",{href:e},"add one"):r.createElement("span",{className:"text-purple cursor-pointer",onClick:t},"add one"),"?"]}renderNoWebsite(){return r.createElement("div",{className:"row",key:"no-website"},r.createElement("p",{className:"col-xs-12"},"Hmm... no websites found for this game.",this.renderEditSentence()))}renderWebsite({name:e,icon:t,svg:s,url:a},i){const{mobile:n}=this.props,l=n?6:4;return r.createElement("a",{className:`website-link col-md-${l}`,key:`website_${i}`,href:a,target:"_blank",rel:"noopener noreferrer nofollow"},s?r.createElement("span",{className:`icon icon-${s} icon-2x`,alt:e}):r.createElement("span",{className:`${t} fa-2x`}),r.createElement("span",{className:"no-wrap pl-2"},e))}renderWebsitesList(e){return r.createElement("div",{className:"row",key:"row"},e.map(this.renderWebsite))}render(){const e=this.websiteLists.filter(((e=[])=>e.length)).reduce(((e,t,s)=>s?[e,r.createElement("hr",{className:"my-1",key:"hr1"}),this.renderWebsitesList(t)]:[this.renderWebsitesList(t)]),[]);return e.length?r.createElement("div",null,e):this.renderNoWebsite()}}var Ne=ye;class ke extends r.Component{constructor(e){super(e),this.state=Object.assign({},{size:"100px",background:"#FFFFFF",track:"#DDDDDD",bar:"#FF0000",progress:100,description:!!this.props.progress&&v(this.props.progress),initialised:0,className:"",hideDescription:!1,strokeWidth:7},this.props)}componentDidMount(){setTimeout((()=>{this.setState({initialised:1})}).bind(this),1e3)}render(){const e=this.state.description&&!this.state.hideDescription?50:60,t=this.state.description&&!this.state.hideDescription?30:34,s=this.state.description?`filter-${this.state.description.class} ${this.state.className}`:this.state.className,a=["0, 251.2",`${2.512*this.state.progress},251.2`];return r.createElement("svg",{className:`gauge ${s}`,viewBox:"0 0 110 110",width:this.state.size,height:this.state.size,style:{width:this.state.size,textAlign:"center"}},r.createElement("circle",{cx:"55",cy:"55",r:"55",fill:this.state.background}),r.createElement("path",{strokeLinecap:"round",strokeWidth:this.state.strokeWidth,stroke:"#F3F3F3",fill:"none",strokeDasharray:"251.2, 251.2",d:"M55 15 a 40 40 0 0 1 0 80 a 40 40 0 0 1 0 -80"}),this.state.progress?r.createElement("path",{className:"gauge-progress",strokeLinecap:"round",strokeWidth:this.state.strokeWidth,fill:"none",d:"M55 15 a 40 40 0 0 1 0 80 a 40 40 0 0 1 0 -80",style:{strokeDasharray:a[this.state.initialised],transition:"stroke-dasharray 3s"}}):null,this.state.progress?r.createElement("text",{x:"55",y:e,textAnchor:"middle",dy:"7",fill:"#34373b",fontSize:t},Math.round(this.state.progress)):r.createElement("text",{x:"55",y:e,textAnchor:"middle",dy:"7",fill:"#34373b",fontSize:"30"},"N/A"),this.state.description&&!this.state.hideDescription?r.createElement("text",{className:"gauge-description",x:"55",y:"67",textAnchor:"middle",dy:"7",fontSize:"12"},this.state.description.word):null)}}var xe=ke;class Se extends r.Component{constructor(e){super(e),this.detectVideoType=this.detectVideoType.bind(this),this.detectImageType=this.detectImageType.bind(this),this.setFilters=this.setFilters.bind(this),this.isVideoIncluded=this.isVideoIncluded.bind(this),this.isImageIncluded=this.isImageIncluded.bind(this),this.mediaTypeChange=this.mediaTypeChange.bind(this),this.toggleMenu=this.toggleMenu.bind(this),this.selectThumb=this.selectThumb.bind(this),this.getVideoData=this.getVideoData.bind(this),this.doScroll=this.doScroll.bind(this),this.showHideScrolls=this.showHideScrolls.bind(this),this.onVolumeChange=this.onVolumeChange.bind(this),this.renderVideos=this.renderVideos.bind(this),this.renderImages=this.renderImages.bind(this);const t=this.props.thumb_width,s=this.props.videos?this.props.videos.length:0,a=this.props.images?this.props.images.length:0,i=s+a,r=this.setFilters();this.state=Object.assign({},this.props,{thumb_width:t,media_types:r[0],media_types_selected:r[1],videos_count:s,images_count:a,total_count:i,menu_out:!1,selected_thumb:!1,show_left_scroll:!1,show_right_scroll:i>3,volume:0})}componentDidCatch(e,t){console.log(e,t)}componentDidMount(){this.state.videos&&this.state.videos.forEach(((e,t)=>{this.getVideoData(t)}))}UNSAFE_componentWillReceiveProps(e){e.thumb_width!=this.state.thumb_width&&this.setState({thumb_width:e.thumb_width,style:e.style})}detectVideoType(e){const t=e.title.toLowerCase();return t.includes("play")?"Gameplay Videos":t.includes("trailer")?"Trailers":"Other Videos"}detectImageType(e){return e.title.toLowerCase().includes("artwork")?"Artwork":"Screenshot"}setFilters(){const e=[];return this.props.videos&&this.props.videos.forEach((t=>{const s=this.detectVideoType(t);e.includes(s)||e.push(s)})),this.props.images&&this.props.images.forEach((t=>{const s=this.detectImageType(t);e.includes(s)||e.push(s)})),[e,e.map((()=>1))]}isVideoIncluded(e){const t=this.detectVideoType(e);return this.state.media_types_selected[this.state.media_types.indexOf(t)]}isImageIncluded(e){const t=this.detectImageType(e);return this.state.media_types_selected[this.state.media_types.indexOf(t)]}mediaTypeChange(e){const t=this.state.media_types_selected[e];return this.state.media_types_selected[e]=t?0:1,this["thumbs-track-wrapper"].scrollLeft=0,this.state.show_left_scroll=!1,this.state.show_right_scroll=this.state.total_count>3,this.forceUpdate()}toggleMenu(e){return this.setState({menu_out:e},this.showHideScrolls)}selectThumb(e,t,s){if(e&&e.id!==this.state.selected_thumb.id){let a=0;if(t){s&&(a=.75);const t=this.trackWidth(),i=this["thumbs-track-wrapper"];let r=0;this.props.videos.forEach(((t,s)=>{t.id===e.i&&(r=s)}));const n=this[`video_${r}`].getBoundingClientRect(),l=i.getBoundingClientRect();n.left+640>=l.left+t&&this.doScroll(1)}this.setState({selected_thumb:e,volume:a||0},(function(){t&&mp.track("play",e.title),this.state.onTogglePlayer()}))}}getVideoData(e){const t=this.state.videos[e];l().ajax({url:`https://www.googleapis.com/youtube/v3/videos?part=snippet&fields=items(snippet(channelTitle,title),statistics(viewCount))&id=${t.url}`,dataType:"jsonp",success:function(t){if(t.items){const s=t.items[0];if(s){this.state.videos[e].title=s.snippet.title,this.state.videos[e].author=s.snippet.channelTitle;const t=this.setFilters({images_count:this.state.images_count});this.state.media_types=t[0],this.state.media_types_selected=t[1],this.forceUpdate()}}}.bind(this)})}doScroll(e){const t=this.state.thumb_width+75;l()(this["thumbs-track-wrapper"]).animate({scrollLeft:e?`+=${t}`:`-=${t}`},300,this.showHideScrolls)}showHideScrolls(){let e,t,s;const a=this["thumbs-track-wrapper"],i=this["thumbs-track"];if(a)return 0===a.scrollLeft?(e=!1,t=!0):(e=!this.state.menu_out,s=this.trackWidth(),t=a.scrollLeft<=Math.floor(i.getBoundingClientRect().width)-s),this.setState({show_left_scroll:e,show_right_scroll:t})}trackWidth(){return Math.min($win.width(),1880)}onVolumeChange(e){this.setState({volume:e})}renderVideos(){return this.state.videos?this.state.videos.map(((e,t)=>{if(this.isVideoIncluded(e)){const s=this.state.selected_thumb?JSON.stringify(this.state.selected_thumb)===JSON.stringify(e):0===t,a=s?"active":"",i=`video_${t}`,n=s&&!window.is_server?r.createElement(le,{autoplay:1,volume:this.state.volume,src:`https://youtu.be/${e.url}`,className:"720p",onEnd:this.selectThumb.bind(this,this.state.videos[t+1],1,!1),onVolumeChange:this.onVolumeChange,width:this.state.thumb_width,height:9*this.state.thumb_width/16}):r.createElement(w,{src:`https://i.ytimg.com/vi/${e.url}/sddefault.jpg`,className:"720p",responsive:"n",force_load:!0});return r.createElement("div",{key:i,ref:e=>{this[`video_${t}`]=e},className:`media-thumbs-item media-thumbs-item-video ${a}`},r.createElement("div",null,n),r.createElement("div",{className:"media-thumbs-item-title-wrapper"},r.createElement("div",{className:"media-thumbs-item-title"},e.title),r.createElement("div",{className:"media-thumbs-item-author"},e.author)),r.createElement("div",{className:"media-thumbs-item-icon",onClick:this.selectThumb.bind(this,e,1,!0)},r.createElement("span",{className:"material-icons"},"play_arrow")))}return null})):null}renderImages(){return this.state.images?this.state.images.map(((e,t)=>this.isImageIncluded(e)?r.createElement("div",{key:`image_${t}`,className:"media-thumbs-item media-thumbs-item-image"},r.createElement(w,{src:e,className:"720p",responsive:"n",force_load:!0}),r.createElement("div",{className:"media-thumbs-item-title-wrapper"},r.createElement("div",{className:"media-thumbs-item-title"},e.title)),r.createElement("a",{href:g(e,"original"),className:"media-thumbs-item-icon dead",rel:"noopener noreferrer"},r.createElement("span",{className:"material-icons"},"zoom_in"))):null)):null}render(){const e=this.state.total_count?"":"hide";return r.createElement("div",{ref:e=>this.mediaThumbsContainer=e,className:`media-thumbs ${e}`,style:this.state.style},r.createElement("div",{className:"media-thumbs-controls-wrapper"},r.createElement("div",{className:"media-thumbs-controls"},!this.state.menu_out&&this.state.videos_count?r.createElement("div",{className:"media-thumbs-menu-button",onClick:this.toggleMenu.bind(this,!0)},r.createElement("span",{className:"material-icons"},"menu")):null,r.createElement("div",{className:"media-thumbs-menu-container",style:{marginLeft:this.state.menu_out?0:-360}},r.createElement("div",{className:"media-thumbs-menu"},this.state.media_types.map(((e,t)=>{const s=`filter_${t}`;return r.createElement("div",{key:s,className:"form-group"},r.createElement("input",{id:s,className:"checkbox",type:"checkbox",checked:this.state.media_types_selected[t],onChange:this.mediaTypeChange.bind(this,t)}),r.createElement("label",{htmlFor:s},e))})),r.createElement("div",{className:"media-thumbs-menu-close",onClick:this.toggleMenu.bind(this,!1)},r.createElement("div",{className:"material-icons"},"chevron_left"))))),r.createElement("div",{className:"media-thumbs-scroll media-thumbs-scroll-left "+(this.state.show_left_scroll&&!this.state.menu_out?"":"hide"),onClick:this.doScroll.bind(this,0)},r.createElement("div",{className:"noselect material-icons"},"chevron_left")),r.createElement("div",{className:"media-thumbs-scroll media-thumbs-scroll-right "+(this.state.show_right_scroll?"":"hide"),onClick:this.doScroll.bind(this,1)},r.createElement("div",{className:"noselect material-icons"},"chevron_right"))),r.createElement("div",{className:"media-thumbs-track-scrollbar-hider"},r.createElement("div",{ref:e=>{this["thumbs-track-wrapper"]=e},className:"media-thumbs-track-wrapper"},r.createElement("div",{className:"media-thumbs-track",ref:e=>{this["thumbs-track"]=e},style:{width:"max-content"}},this.renderVideos(),this.renderImages()))))}}var Ce=Se;const $e={id:22,regions:[2]},Te=[$e];class je extends r.Component{constructor(e){super(e),this.getUserGeo=this.getUserGeo.bind(this),this.serviceName=this.serviceName.bind(this),this.renderButton=this.renderButton.bind(this),this.getButtons=this.getButtons.bind(this),this.state={loading:!0,geoRegion:window.geoRegion}}componentDidMount(){this.getUserGeo()}getUserGeo(){this.state.geoRegion||l().getJSON(this.props.geoipUrl,(e=>{window.geoRegion=e.region,this.setState({geoRegion:e.region})}))}getButtons(){const e=[],t=this.props.bundledInGames.map((e=>e.external_games)).flat()||[],s=this.props.versionsGames.map((e=>e.versions_slug===this.props.current_slug?e.external_games:[])).flat()||[],a=this.state.geoRegion;return Te.forEach((i=>{const r=(this.props.externalGames||[]).filter(this.byPlatform(i,a)),n=t.filter(this.byPlatform(i,a)),l=s.filter(this.byPlatform(i,a));r.length?e.push(this.renderButton(r[0])):n.length?e.push(this.renderButton(n[0])):l.length&&e.push(this.renderButton(l[0]))})),e}render(){const e=this.getButtons();return e.length?r.createElement("div",null,e):null}byPlatform(e,t){return s=>s.category===e.id&&e.regions.includes(t)}serviceName(e){return e.category===$e.id?"Luna":e.category_name}svg(e){return e.category===$e.id&&"luna"}renderButton(e){const t=this.svg(e),s=this.serviceName(e);return r.createElement("a",{className:"btn btn-secondary btn-block mar-lg-bottom",href:e.url,target:"_blank"},t?r.createElement("span",{className:`icon icon-lg icon-${t}`,alt:`${s} icon`}):null,` Play on ${s}`)}}var Oe=je;const De=()=>document.querySelector("[name='csrf-token']").content;var Me=function(e){const t=e.className||"",[s,a]=r.useState({loading:!1,index:e.rating,rating_delete_url:e.ratingDeletePath}),[i,n]=r.useState(!1),l=e.callback,o=()=>{s.loading&&a({index:0,loading:!1,rating_delete_url:null})},c=e=>parseInt(e.target.dataset.star),m=t=>{if(s.loading)return;a({loading:!0});const i=s.index,r=e.half?i+1:i,n=c(t);n===r?p():u(n)},d=e=>{n(c(e))},h=()=>{i&&!s.loading&&n(!1)},u=t=>{if(!b())return o(),E("rate_game"),!1;const s={location_context:"games_rating_component",location_medium:"star_rating",overall:t,story:t,graphics:t,audio:t,controls:t,fun:t};fetch(e.ratingPath,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"X-CSRF-Token":De(),"Content-Type":"application/json"},referrerPolicy:"no-referrer",body:JSON.stringify(s)}).then((e=>e.json())).then((t=>{var s;t.delete_url&&(mp.track("rate_game",e.gameId),a({loading:!1,rating_delete_url:t.delete_url,index:t.t}),window.notify("Your rating has been submitted.","success","Thanks!"),s=t.t,l&&l(s))}))},p=()=>b()?null===s.rating_delete_url?(o(),!1):void fetch(s.rating_delete_url,{method:"DELETE",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"X-CSRF-Token":De(),"Content-Type":"application/json"},referrerPolicy:"no-referrer"}).then((()=>{a({index:0,loading:!1,rating_delete_url:null}),window.notify("Your rating has been removed.","success")})):(o(),E("rate_game"),!1);return r.useEffect((()=>{null!==e.ratingInfoPath&&b()&&fetch(e.ratingInfoPath,{method:"GET",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},referrerPolicy:"no-referrer"}).then((e=>e.json())).then((e=>{null!==e.overall&&a({index:e.overall,rating_delete_url:e.delete_url})}))}),[]),r.createElement("div",{className:`rating ${t}`},i?r.createElement("div",{className:"rating-star-label label label-default"},v(i).word):null,[10,9,8,7,6,5,4,3,2,1].map((t=>{const a=s.index===t?s.loading?"loading active":"active":null,i=t+1===s.index&&e.half?"half":"";return r.createElement("div",{key:`star_${t}`,className:a,onClick:m,onMouseOver:d,onMouseOut:h},r.createElement("div",{className:`rating-star ${i}`,"data-star":t}))})))};class Re extends r.Component{constructor(e){super(e),this.state={hovered:!1,selected:e.selected},this.getListName=this.getListName.bind(this),this.isChecked=this.isChecked.bind(this),this.wasInitiallyChecked=this.wasInitiallyChecked.bind(this),this.check=this.check.bind(this),this.hover=this.hover.bind(this),this.getCount=this.getCount.bind(this)}getListName(e){const t=this.props.lists.filter((t=>t[0].indexOf(e)>-1));if(t)return t[0]}isChecked(e){return this.state.selected.some((t=>t.indexOf(e)>-1))}wasInitiallyChecked(e){return this.props.initiallySelected.some((t=>t.indexOf(e)>-1))}check(e){if(is_logged_in()){let t=[e],s="added to";const a=this.isChecked(e)?"remove":e;this.isChecked(e)&&(t=[],s="removed from"),this.setState({selected:t},(()=>{const t=this.getListName(e);notify(`${this.props.name} has been ${s} your "${t[1]}" list`,"success"),mp.track("set_play_status",t[0]),fetch(`${window.location.origin}/add_to_special_list?id=${this.props.gameID}&context=${this.props.trackingContext}`,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},referrerPolicy:"no-referrer",body:JSON.stringify({authenticity_token:document.querySelector("[name='csrf-token']").content,list:a})})}))}else E("want_playing_played")}hover(e){this.setState({hovered:e})}getCount(e){const t=this.props.counts[e],s=this.props.lists[e][0],a=this.wasInitiallyChecked(s);if(this.isChecked(s)){if(!a)return t+1}else if(a)return t-1;return t}render(){if(this.props.lists){const e=!(this.state.selected.length>0);return r.createElement("form",{ref:e=>{this.form=e},className:"wpp btn-group btn-group-justified","data-remote":"true"},this.props.lists.map(((e,t)=>{const s=this.isChecked(e[0]),a=s?"active":"",i=this.getCount(t),n=s&&this.state.hovered===e[0]?"cancel":e[2];let l="";return"playing"!==e[0]&&"played"!==e[0]||this.props.released||(l="disabled"),r.createElement("label",{key:`list_${e[0]}`,className:`btn wpp__button ${a} ${l}`,onMouseEnter:this.hover.bind(this,e[0]),onMouseLeave:this.hover.bind(this,0)},r.createElement("input",{type:"checkbox",name:"list",value:e[0],className:"radio",checked:s,onChange:this.check.bind(this,e[0])}),r.createElement("div",{className:"material-icons "+("small"===this.props.size?"wpp__button-icon--small":"")},n),r.createElement("div",{className:"text-uppercase"},e[1]),r.createElement("div",{className:"text-muted"},i))})),r.createElement("input",{type:"checkbox",name:"list",value:"remove",className:"hide",checked:e,onChange:this.check}))}return null}}var Pe=Re;class Le extends r.Component{constructor(e){let t,s;super(e),this.categories=["Main Game","DLC / Addon","Expansion","Bundle","Standalone Expansion","Mod","Episode","Season","Remake","Remaster","Expanded Game","Port","Fork"],this.props.screenshots?(t=this.props.screenshots[Math.floor(Math.random()*this.props.screenshots.length)],s=g(t,"screenshot_big")):s="https://images.igdb.com/igdb/image/upload/t_original/default-bg_kivul9.jpg",this.state=Object.assign({wpp:{counts:[],initially_selected:[],selected:[],lists:[["want_to_play","Want","schedule"],["playing","Playing","games"],["played","Played","check_circle"]]},userDataLoaded:!1,isFirstRender:!0,qualityControlPassed:!1,qualityControlFailed:!1},this.props,{title_class:this.props.screenshots?"":"banner-title-dark",banner:{backgroundImage:`url(${s})`},first_gauge_size:136,selected_tab:0,hyped:!1,hype_loading:!!this.props.current_user},this.getThumbSize()),this.save_list=this.save_list.bind(this),this.prompt_login=this.prompt_login.bind(this),this.genres=this.genres.bind(this),this.platforms=this.platforms.bind(this),this.is_tab_selected=this.is_tab_selected.bind(this),this.select_tab=this.select_tab.bind(this),this.share_focus=this.share_focus.bind(this),this.facebook_share=this.facebook_share.bind(this),this.getThumbSize=this.getThumbSize.bind(this),this.calculate_media_thumbs_height=this.calculate_media_thumbs_height.bind(this),this.toggle_player_space=this.toggle_player_space.bind(this),this.isServerOrFirstRender=this.isServerOrFirstRender.bind(this),this.fetchData=this.fetchData.bind(this)}componentDidMount(){this.setState({isFirstRender:!1});const e={id:this.state.id},t={wpp:e,can_change_game:e,localized_changes:e};this.fetchData(t,e),window.addEventListener("user_data",(()=>{this.fetchData(t,e)})),window.is_server||(window.onresize=h((()=>this.setState(this.getThumbSize())).bind(this),100));let s=localStorage.getItem("visited_games");s=s?s.split(","):[],s.length>30&&s.shift();const a=s.indexOf(this.state.id.toString());return a>-1&&s.splice(a,1),s.push(this.state.id),localStorage.setItem("visited_games",s)}fetchData(e,t){this.props.current_user&&se?(e.game_rated=t,e.lists=t,this.state.can_rate||(e.hyped=t),this.state.can_rate&&(e.followed=t),se.get(e).then((e=>{this.setState(e,(function(){this.setState({hype_loading:!1})}))}))):se.get(e).then((e=>this.setState(e)))}isServerOrFirstRender(){return window.is_server||!this.state||this.state.isFirstRender}getThumbSize(){const e=(this.isServerOrFirstRender()?1366:window.innerWidth)<=1366?480:640;return{media_thumbs_width:e,media_thumbs_height:this.props.videos||this.props.screenshots||this.props.artwork?this.calculate_media_thumbs_height(null,e):0}}save_list(e){const t=this.state.lists[e],s=t.in_list?"delete":"post",a=t.in_list?"/list_entries/remove_game":"/list_entries",i=t.in_list?"DELETE":"POST",r={game_id:this.state.id,list_id:this.state.lists[e].id,tracking_context:"games_add_to",tracking_medium:"custom_lists_checkbox"};fetch(a,{method:i,mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"X-CSRF-Token":document.querySelector("[name='csrf-token']").content,"Content-Type":"application/json"},referrerPolicy:"no-referrer",body:JSON.stringify(r)}).then((t=>(this.state.lists[e].in_list="delete"!==s,this.forceUpdate())))}prompt_login(){return l()("#login-menu a[data-remote]").click(),!1}genres(){const e=this.state.genres.map((e=>r.createElement("a",{key:`genre_${e.name}`,href:`/genres/${e.to_param}`},e.name)));return _(e,", ")}platforms(){const e=this.state.platforms.map((e=>r.createElement("a",{key:`platforms_${e[2]}`,href:`/platforms/${e[1]}`},e[0])));return _(e,", ")}is_tab_selected(e){return this.state.selected_tab===e?"":"hide"}select_tab(e){return this.setState({selected_tab:e})}share_focus(e){return e.currentTarget.setSelectionRange(0,e.currentTarget.value.length)}facebook_share(e){return FB&&FB.ui({app_id:"890353974317090",method:"share",href:this.state.short_url,message:e}),!1}calculate_media_thumbs_height(e,t){return null==e&&(e=0),9*(t||this.state.media_thumbs_width)/16+e+45}toggle_player_space(e){return this.setState({media_thumbs_height:this.calculate_media_thumbs_height(e)})}blank(){return!1}renderReleaseDate(){if(this.state.release_date){const{release_date:e,release_date_time_ago:t}=this.state,s=r.createElement("h2",{className:"banner-subheading"},r.createElement(re,{date:e,timeAgo:t}));return this.state.can_rate?s:r.createElement("a",{href:this.state.edit_url.replace("/edit","/countdown")},s)}}renderEditButton(){const e=!this.isServerOrFirstRender()&&this.props.current_user?{href:this.state.edit_url}:{href:"/dialog/login","data-remote":!0,"data-role":"button","data-modal":"ajax-modal"};return r.createElement("a",Object.assign({className:"btn btn-default btn-xs banner-title-button"},e),"Edit")}renderQualityControlButtons(){const{current_user:e}=this.props;if(e&&(9===e.role||10===e.role)){const e={href:this.props.data_tracking_quality_control_path},t="banner-qc-button",s=`btn btn-xs ${t} ${t}`,a=this.state.qualityControlPassed?s+"-white":s+"-green",i=this.state.qualityControlFailed?s+"-white":s+"-red";return r.createElement("div",null,r.createElement("a",Object.assign({className:a,"data-method":"post","data-remote":"true","data-params":'{"location_context": "game_quality_control", "location_medium": "quality_control_good"}',onClick:()=>{this.setState({qualityControlPassed:!0})}},e),"QC+1"),r.createElement("a",Object.assign({className:i,"data-method":"post","data-remote":"true","data-params":'{"location_context": "game_quality_control", "location_medium": "quality_control_bad"}',onClick:()=>{this.setState({qualityControlFailed:!0})}},e),"QC-1"))}}renderPendingValidation(){const e=[];if(this.state.can_change_game&&e.push(r.createElement("a",{href:this.state.changes_path},"Game Page contribution (NA Standard)")),this.state.localized_changes&&this.state.localized_changes.forEach((t=>e.push(r.createElement("span",null,e.length>0&&", ",r.createElement("a",{href:t.path},"Localization contribution (",t.region,")"))))),0!==e.length)return r.createElement("div",{className:"notif alert alert-success mar-md-bottom"},r.createElement("span",null,r.createElement("b",null,"Data validation on this page is currently pending.")," You can review and help validation by leaving a comment on the following:"," "),e)}render(){let e;e=this.props.cover?this.props.cover:{cloudinary_id:"nocover",image_width:1530,image_height:2157};const t=264/(e.image_width/e.image_height),s=`${this.state.name} on IGDB.com`,a=t/1.25,{media_thumbs_height:i,media_thumbs_width:n}=this.getThumbSize(),l=["About","Add to","Share"];return this.state.is_pending&&l.splice(1,1),r.createElement("div",{className:"gamepage-header"},r.createElement("div",{className:"parallax-container"},r.createElement("div",{className:"parallax-background",style:this.state.banner})),r.createElement("div",{className:"gamepage-header-info",style:{top:`-${a}px`,paddingBottom:i-a}},r.createElement("div",{className:"gamepage-cover"},r.createElement(w,{height:t,src:g(e,"cover_big",!0),className:"cover_big"}),!this.state.is_pending&&r.createElement(r.Fragment,null,r.createElement("div",{className:"gamepage-actions"},r.createElement(he,{id:this.state.id,slug:this.state.slug,loader_path:this.state.loader_path,className:"btn-block mar-lg-bottom",loading:this.state.hype_loading,active:this.state.followed||this.state.hyped,follow:this.state.can_rate,count:this.state.hypes_count}),r.createElement(Oe,{geoipUrl:this.state.geoip_url,current_slug:this.state.slug,versionsGames:this.state.versions_games,bundledInGames:this.state.bundles,externalGames:this.state.external_games})),r.createElement("div",{className:"text-muted mar-lg-bottom text-center"},"Followers: ",this.state.hypes_count),r.createElement(Pe,{trackingContext:"games_default_list",key:"wpp"+this.state.wpp.id,lists:this.state.wpp.lists,counts:this.state.wpp.counts,selected:this.state.wpp.selected,initiallySelected:this.state.wpp.initially_selected,name:this.state.wpp.name,gameID:this.state.wpp.id,released:this.state.can_rate}))),r.createElement("div",{className:"gamepage-summary"},r.createElement("div",{className:"gamepage-title-container",style:{height:t/1.25-15+"px"}},r.createElement("div",{className:"gamepage-title-wrapper"},r.createElement("h1",{className:`banner-title ${this.state.title_class}`},this.state.name,this.renderEditButton(),this.renderQualityControlButtons()),this.renderReleaseDate(),this.state.developers&&this.state.developers.length?r.createElement("a",{href:this.state.developers[0][1]},r.createElement("h3",{className:"banner-subsubheading"},this.state.developers[0][0])):null,this.state.status?r.createElement("div",{className:"gamepage-status"},this.state.status):null)),r.createElement("div",{className:"gamepage-tabs"},r.createElement(we,{items:l,callback:this.select_tab}),this.renderPendingValidation(),r.createElement("div",{className:this.is_tab_selected(0)},(()=>{if(this.state.category>0&&this.state.extension){const e=this.state.extension,t=this.categories[this.state.category];switch(this.state.category){case 1:case 2:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 4:return r.createElement("p",null,r.createElement("strong",null,this.state.name)," is"," ",2===this.state.category?"an":"a"," ",`${t} for `,r.createElement("a",{href:`/games/${e.slug}`},e.name));case 3:return r.createElement("p",null,r.createElement("strong",null,this.state.name)," ","is part of the ",r.createElement("a",{href:`/games/${e.slug}`},e.name),"bundle")}return null}})(),this.state.genres.length?r.createElement("p",null,r.createElement("span",{className:"text-semibold"},"Genre: "),this.genres()):null,this.state.platforms.length?r.createElement("p",null,r.createElement("span",{className:"text-semibold"},"Platforms: "),this.platforms()):null,this.state.versions_count?r.createElement("p",null,r.createElement("strong",null,"Editions"),":"," ",r.createElement("a",{href:`/games/${this.state.versions_slug}/editions`},this.state.versions_count>1?`See ${this.state.versions_count} more editions of this game`:"See the alternative edition of this game")):null,"<p></p>"!==this.state.summary?r.createElement(pe,{html:this.state.summary,limit:430}):r.createElement("p",null,"This game is missing a summary,"," ",r.createElement("a",{href:"#",onClick:this.prompt_login},"register an account")," ","to add one."),r.createElement("br",null),r.createElement("br",null),r.createElement(Ne,{editUrl:this.state.edit_url,promptLogin:this.prompt_login,websitesConfig:this.props.website_links,websites:this.props.websites})),!this.state.is_pending&&r.createElement("div",{className:this.is_tab_selected(1)},r.createElement("div",{className:"row"},(()=>this.state.lists&&this.state.lists[0]?this.state.lists.map(((e,t)=>{const s=`addto_list_${e.id}`,a=!!e.in_list&&"checked";return r.createElement("div",{key:s,className:"field-group col-md-4"},r.createElement("input",{className:"checkbox",id:s,type:"checkbox",value:e.id,onChange:this.save_list.bind(this,t),checked:a}),r.createElement("label",{className:"inline-block",htmlFor:s},r.createElement("div",{className:"gamepage-addtolist-label overflow-wrap"},e.name)))})):r.createElement("p",{className:"pad"},"No lists available, why not ",this.props.current_user?r.createElement("a",{href:this.state.new_list_path},"create one"):r.createElement("span",{className:"text-purple cursor-pointer",onClick:()=>E("create_list")},"create one"),"?"))()),r.createElement("br",null),this.props.current_user?r.createElement("a",{href:this.state.new_list_path,className:"btn btn-primary"},"Create new list"):r.createElement("div",{className:"btn btn-primary",onClick:()=>E("create_list")},"Create new list")),r.createElement("div",{className:this.is_tab_selected(this.state.is_pending?1:2)},r.createElement("a",{className:"btn mar-sm-right btn-facebook btn-sm",href:"#",target:"_parent",onClick:this.facebook_share.bind(this,s),rel:"noopener noreferrer nofollow"},r.createElement("span",{className:"fab fa-facebook fa-lg mar-md-right"}),"Facebook"),r.createElement("a",{className:"btn mar-sm-right btn-twitter btn-sm",href:`https://twitter.com/intent/tweet?text=${s}+${this.state.short_url}`,target:"_parent",rel:"noopener noreferrer nofollow"},r.createElement("span",{className:"fab fa-twitter fa-lg mar-md-right"}),"Tweet"),r.createElement("a",{className:"btn mar-sm-right btn-google-plus btn-sm",href:`https://plus.google.com/share?url=${this.state.short_url}`,target:"_blank",rel:"noopener noreferrer nofollow"},r.createElement("span",{className:"fab fa-google-plus fa-lg mar-md-right"}),"Google"),r.createElement("br",null),r.createElement("br",null),r.createElement("div",{className:"input-group"},r.createElement("span",{className:"input-group-addon"},r.createElement("div",{className:"fa fa-link"})),r.createElement("input",{ref:"share_shorturl",className:"form-control",type:"text",value:this.state.short_url,"data-clipboard-text":this.state.short_url,onClick:this.share_focus,onChange:this.blank}))))),r.createElement("div",{className:"gamepage-gauge",style:{marginTop:t/1.25-15-this.state.first_gauge_size/2+"px"}},r.createElement(xe,{size:`${this.state.first_gauge_size}px`,progress:this.state.rating,strokeWidth:6}),r.createElement(xe,{className:"gauge-twin",size:"105px",progress:this.state.external_reviews,hideDescription:!0}),r.createElement("div",{className:"pad gauge-info"},this.state.can_rate?this.state.ratings_count>4?r.createElement("div",{className:"gauge-single-info text-muted"},"Based on ",this.state.ratings_count,r.createElement("div",{className:"text-semibold"}," member ratings")):r.createElement("div",{className:"gauge-single-info text-muted"},"Need more ratings"):r.createElement("div",{className:"gauge-single-info text-muted"},"Not yet released"),this.state.external_reviews_count?r.createElement("div",{className:"gauge-twin-info text-muted"},"Based on ",this.state.external_reviews_count,r.createElement("div",{className:"text-semibold"}," critic ratings")):r.createElement("div",{className:"gauge-twin-info text-muted"},"Critic Score Unavailable")),r.createElement("hr",null),r.createElement("br",null),this.state.can_rate?r.createElement("div",null,r.createElement("strong",{className:"block mar-md-bottom"},"How would you rate this game?"),r.createElement(Me,{rating:this.state.game_rated&&this.state.game_rated.overall,ratingPath:this.state.rating_path,ratingInfoPath:this.state.rating_info_url,ratingDeletePath:this.state.rating_delete_url,gameId:this.state.id}),r.createElement("br",null)):null,this.state.ratings_count>4?r.createElement("div",{className:"pt-4"},r.createElement("strong",{className:"block mar-md-bottom"},"Rating breakdown"),r.createElement("img",{src:`/games/${this.state.slug}/rating_breakdown.svg`,alt:`Rating breakdown of ${this.state.name}`})):null)),r.createElement(Ce,{videos:this.state.videos,images:(this.state.screenshots||[]).concat(this.state.artwork||[]).concat(this.state.localized_covers||[]),style:{marginTop:`-${i}px`},thumb_width:n,onTogglePlayer:this.toggle_player_space}))}}var Fe=Le;class qe extends r.Component{constructor(e){let t,s,a;super(e),this.social_sites=this.props.website_links,this.state={},this.props.screenshots?(s=this.props.screenshots[Math.floor(Math.random()*this.props.screenshots.length)],a=g(s,"screenshot_big")):a="https://images.igdb.com/igdb/image/upload/t_screenshot_big/default-bg_kivul9.jpg",t=this.props.cover?this.props.cover:{cloudinary_id:"nocover",image_width:1530,image_height:2157};const i=264/(t.image_width/t.image_height);this.state=Object.assign({isFirstRender:!0,wpp:{counts:[],initially_selected:[],selected:[],lists:[["want_to_play","Want","schedule"],["playing","Playing","games"],["played","Played","check_circle"]]}},this.props,{title_class:this.props.screenshots?"":"banner-title-dark",banner:a,cover_height:i?Math.round(i):null,release_date_obj:c()(this.props.release_date_time_ago),selected_tab:0,hyped:!1,hype_loading:b(),new_cover:t}),this.saveList=this.saveList.bind(this),this.promptLogin=this.promptLogin.bind(this),this.isTabSelected=this.isTabSelected.bind(this),this.selectTab=this.selectTab.bind(this),this.hypeSend=this.hypeSend.bind(this),this.ratingClick=this.ratingClick.bind(this),this.ratingSend=this.ratingSend.bind(this),this.ratingDelete=this.ratingDelete.bind(this),this.isServerOrFirstRender=this.isServerOrFirstRender.bind(this),this.fetchData=this.fetchData.bind(this)}componentDidMount(){this.setState({isFirstRender:!1});const e={id:this.state.id},t={wpp:e};this.fetchData(t,e),window.addEventListener("user_data",(()=>{this.fetchData(t,e)}))}fetchData(e,t){b()?(e.game_rated=t,e.lists=t,this.state.can_rate||(e.hyped=t),this.state.can_rate&&(e.followed=t),se.get(e).then((e=>this.setState(l().extend({hype_loading:!0,user_rating:!!e.game_rated&&e.game_rated.overall,rating_delete_url:!!e.game_rated&&e.game_rated.delete_url},e),(function(){this.setState({hype_loading:!1})}))))):se.get(e).then((e=>this.setState(e)))}isServerOrFirstRender(){return window.is_server||!this.state||this.state.isFirstRender}saveList(e){const t=this.state.lists[e],s=t.in_list?"delete":"post",a=t.in_list?"/list_entries/remove_game":"/list_entries";t.in_list;l().ajax({url:a,type:s,headers:{"X-CSRF-Token":document.querySelector("[name='csrf-token']").content},data:{game_id:this.state.id,list_id:this.state.lists[e].id,tracking_context:"games_add_to",tracking_medium:"custom_lists_checkbox"},success:function(){this.state.lists[e].in_list="delete"!==s,this.forceUpdate()}.bind(this)})}promptLogin(){return l()("#login-menu a[data-remote]").click(),!1}isTabSelected(e){return this.state.selected_tab===e?"":"hide"}selectTab(e){return this.setState({selected_tab:e})}hypeSend(){return b()?(this.setState({hype_loading:!0}),l().ajax({url:this.state.hype_path,type:"POST",dataType:"json",success:function(e){return this.setState({hype_loading:!1,hyped:"Unfollow"===e.result})}.bind(this)}),null):this.promptLogin()}ratingClick(){return b()?null:this.promptLogin()}ratingSend(e){if(!b())return this.promptLogin();const t=l()(e.currentTarget).val();return t?(this.setState({user_rating:t}),l().ajax({url:this.state.rating_path,type:"POST",dataType:"json",data:{overall:t,story:t,graphics:t,audio:t,controls:t,fun:t},success:function(e){e.delete_url&&(this.setState({user_rating:e.t,rating_delete_url:e.delete_url}),window.notify("Your rating has been submitted.","success","Thanks!"))}.bind(this)}),null):(this.ratingDelete(),null)}ratingDelete(){return b()?(this.setState({user_rating:!1,rating_delete_url:!1}),this.state.rating_delete_url&&l().ajax({url:this.state.rating_delete_url,type:"DELETE",success:function(){this.setState({user_rating:!1,rating_delete_url:!1})}.bind(this)}),null):this.promptLogin()}renderRating(){let e,t;return this.state.rating&&(e=v(this.state.rating).class),this.state.external_reviews&&(t=v(this.state.external_reviews).class),this.state.can_rate?r.createElement("div",{className:"clearboth"},r.createElement("div",{className:`col-xs-6 gamepage-mobile-score-container filter-${e}`},r.createElement("div",{className:"gamepage-mobile-score"},this.state.rating||"N/A"),r.createElement("div",{className:"gamepage-mobile-score-description"},"based on ",Math.round(this.state.ratings_count)," members")),r.createElement("div",{className:`col-xs-6 gamepage-mobile-score-container filter-${t}`},r.createElement("div",{className:"gamepage-mobile-score"},Math.round(this.state.external_reviews)||"N/A"),r.createElement("div",{className:"gamepage-mobile-score-description"},"based on ",this.state.external_reviews_count," critics"))):this.state.external_reviews_count>0?r.createElement("div",{className:`gamepage-mobile-score-container filter-${t}`},r.createElement("div",{className:"gamepage-mobile-score"},Math.round(this.state.external_reviews)||"N/A"),r.createElement("div",{className:"gamepage-mobile-score-description"},"based on ",this.state.external_reviews_count," critics")):r.createElement("div",{className:"gamepage-mobile-score-container"},r.createElement("div",{className:"gamepage-mobile-score"},this.state.hypes_count||0),r.createElement("div",{className:"gamepage-mobile-score-description"},"Hypes"))}render(){const e=["Websites","About"];this.state.is_pending||e.push("Add To");const t=this.isServerOrFirstRender()?{}:{backgroundImage:`url(${this.state.banner})`};return r.createElement("div",{className:"gamepage-mobile-header"},r.createElement("div",{className:"gamepage-mobile-header-banner",style:t},r.createElement("div",{className:"gamepage-mobile-header-title-wrapper"},r.createElement("h1",{className:"gamepage-mobile-header-title"},this.state.name),this.state.release_date_obj.isValid()?r.createElement("div",{className:"text-muted gamepage-mobile-header-year"},this.state.release_date_obj.year()):this.state.release_date?r.createElement("div",{className:"text-muted gamepage-mobile-header-year"},this.state.release_date):null),r.createElement("div",{className:"gamepage-mobile-header-cover"},r.createElement(w,{src:this.state.new_cover,className:"cover_small"}),this.state.can_rate?r.createElement("div",null,r.createElement("div",{className:"gamepage-mobile-rating-btn",onClick:this.ratingClick},this.state.user_rating?r.createElement("span",{className:"gamepage-mobile-rating-rated"},this.state.user_rating):r.createElement("span",{className:"material-icons"},"star")),b()?r.createElement("select",{className:"gamepage-mobile-rating-select",onChange:this.ratingSend,value:this.state.user_rating},r.createElement("option",{value:""},"None"),[10,9,8,7,6,5,4,3,2,1].map((e=>r.createElement("option",{key:`rating_opt_${e}`,value:e},e)))):null):r.createElement(he,{id:this.state.id,loader_path:this.state.loader_path,className:"gamepage-mobile-hype-btn",loading:this.state.hype_loading,active:this.state.followed||this.state.hyped,follow:this.state.can_rate,count:this.state.hypes_count}))),!this.state.is_pending&&r.createElement(Pe,{trackingContext:"games_default_list",key:"wpp"+this.state.wpp.id,lists:this.state.wpp.lists,counts:this.state.wpp.counts,selected:this.state.wpp.selected,initiallySelected:this.state.wpp.initially_selected,name:this.state.wpp.name,gameID:this.state.wpp.id,released:this.state.can_rate}),r.createElement("div",{className:"gamepage-summary"},r.createElement("div",{className:"gamepage-tabs"},r.createElement(we,{items:e,callback:this.selectTab,className:"row"}),r.createElement("div",{className:this.isTabSelected(1)},"<p></p>"!==this.state.summary?r.createElement(pe,{html:this.state.summary,limit:180,className:"article"}):null),r.createElement("div",{className:`clearfix px-2 ${this.isTabSelected(0)}`},r.createElement("div",{className:"row fix-heights"},this.state.websites&&this.state.websites.map(((e,t)=>{if([13,12,11,10].indexOf(e.site)>-1){const s=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;if((11==e.site||10==e.site)&&!s)return null;if(12==e.site&&s)return null;if(13==e.site)return null;let a=!1;switch(e.site){case 13:a="https://images.igdb.com/igdb/image/upload/t_original/steam_zstrel.png";break;case 12:a="https://images.igdb.com/igdb/image/upload/t_original/ae9f6f24-ed1b-11e6-89bf-05a4c2aba3e4_oanh54.png";break;case 11:case 10:a="https://images.igdb.com/igdb/image/upload/t_original/ae78d45e-ed1b-11e6-921d-4bf92c0ce791_s1qrtu.png"}return r.createElement("div",{className:"col-xs-6 mar-lg-bottom",key:`largeWebsite_${t}`},r.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer"},r.createElement(w,{src:a,force_load:!0,alt:"steam"})))}return null}))),r.createElement(Ne,{websitesConfig:this.props.website_links,websites:this.props.websites,mobile:!0})),!this.state.is_pending&&r.createElement("div",{className:this.isTabSelected(2)},this.state.lists&&this.state.lists.length?this.state.lists.map(((e,t)=>{const s=`addto_list_${e.id}`,a=!!e.in_list&&"checked";return r.createElement("div",{key:s,className:"form-group"},r.createElement("input",{className:"checkbox",id:s,type:"checkbox",value:e.id,onChange:this.saveList.bind(this,t),checked:a}),r.createElement("label",{className:"inline-block",htmlFor:s},r.createElement("span",{className:"gamepage-addtolist-label overflow-wrap"},e.name)))})):null))),r.createElement("div",{className:"row text-center"},this.renderRating()))}}var ze=qe;class Be extends r.Component{constructor(e){super(e),this.state={games:e.games,static:e.static,title:e.title,platforms_path:e.platforms_path,filter:e.filter,url:e.url,loading:void 0},this.changeSort=this.changeSort.bind(this),this.setPlatform=this.setPlatform.bind(this)}componentDidMount(){let e;this.state.static||(e=localStorage.getItem("platform_preference"),e&&this.setPlatform(e))}changeSort(e,t){const s=e||this.state.ssort||"date",a=t>=0?t:this.state.current;this.setState({loading:!0,ssort:s,current:a});const i=this.state.pfilter,r={ssort:s,limit:10,filter:this.state.filter};i&&(r.pfilter=i),$.get("/games/catalog",r,(e=>{this.setState({games:e,loading:!1})}))}setPlatform(e){this.setState({pfilter:e},(function(){this.changeSort()}))}render(){return r.createElement("div",null,r.createElement("div",{className:"pull-right"},this.state.sorting?this.state.sorting.map(((e,t)=>{const s=(this.state.current||0)===t?"active":"";return r.createElement("div",{key:e[1],className:`btn btn-default btn-xs mar-sm-left ${s}`,onClick:this.changeSort.bind(this,e[1],t)},e[0])})):null),this.state.title?r.createElement("h3",{className:"underscratch underscratch-yellow"},r.createElement("a",{href:this.state.url+(this.state.pfilter?`?pfilter=${this.state.pfilter}`:"")},this.state.title)):null,this.state.games.length?this.state.games.map(((e,t)=>{const{release_date:s,release_date_time_ago:a}=e,i=this.state.loading?"loading-animated":"",n=e.cloudinary_cover||"nocover";return r.createElement("div",{key:`${t}_${e.id}`,className:`media ${i}`},r.createElement("div",{className:"media-left"},r.createElement("div",{className:"width-40"},r.createElement("div",{className:"game_cover"},r.createElement(w,{className:"cover_small",src:n,alt:e.name})))),r.createElement("div",{className:"media-body"},r.createElement("a",{className:"overflow-wrap",href:`/games/${e.slug}`},e.name),r.createElement("span",{title:e.release_date,className:"text-muted"},r.createElement(re,{date:s,timeAgo:a}))))})):r.createElement("h5",null,"No Results"))}}var Ae=Be;class Ie extends r.Component{constructor(e){super(e),this.newFeature=this.newFeature.bind(this),this.toggleEditMode=this.toggleEditMode.bind(this),this.doSubmit=this.doSubmit.bind(this),this.onScroll=this.onScroll.bind(this);const t=Object.assign({},e.version,{editMode:!1,modified:!1,tdWidths:[]});t.features&&(t.features=this.ensureDefaultValues(t.features,t.versions)),this.initialFeaturesState=JSON.stringify(t.features),this.state=t,this.styles={featureTD:{textAlign:"center",verticalAlign:"middle",minWidth:"90px"},featureTitle:{verticalAlign:"middle",minWidth:"350px"}},this.isAffixed=!1}componentDidMount(){this.props.changes&&window.notify("These versions have changes waiting for validation.","warning","Changes need validating!","versions/changes"),setTimeout((()=>{this.captureTableHeaders(),window.addEventListener("scroll",this.onScroll)}),800)}componentWillUnmount(){window.removeEventListener("scroll",this.onScroll)}onScroll(){window.scrollY+15>=this.tableHeader.coverTop&&!1===this.isAffixed?this.setState({coverHeaderStyle:{position:"fixed",top:0,borderTop:"15px solid white"},titleHeaderStyle:{position:"fixed",top:this.tableHeader.coverHeight+15},tablePanelStyle:{paddingTop:this.tableHeader.totalHeight}},(()=>{this.isAffixed=!0})):window.scrollY+15<this.tableHeader.coverTop&&!0===this.isAffixed&&this.setState({coverHeaderStyle:{},titleHeaderStyle:{},tablePanelStyle:{}},(()=>{this.isAffixed=!1}))}captureTableHeaders(){const e=l()(this.CoversTrElem),t=l()(this.TitlesTrElem),s=e.height();this.tableHeader={coverTop:e.offset().top,titleTop:t.offset().top,coverHeight:s,totalHeight:s+t.height()},this.setState({tdWidths:e.find("td").map(((e,t)=>l()(t).outerWidth()))})}doSubmit(e){this.state.modified&&(this.initialFeaturesState=JSON.stringify(this.state.features),this.setState({modified:!1},(()=>{const e=l()(this.submitForm);l().ajax({url:e.attr("action"),type:e.attr("method"),data:e.serialize(),success:e=>{window.notify("Version update saved!","success");const t=this.ensureDefaultValues(e.features,e.versions);this.initialFeaturesState=JSON.stringify(t),this.setState({id:e.id,features:t,versions:e.versions,editMode:!this.state.editMode})}})})))}componentWillUpdate(e,t){return t.modified=JSON.stringify(t.features)!==this.initialFeaturesState,t}updateFeature(e,t,s){if(this.state.editMode){let a=this.state.features.slice(0);this.setState({features:a.map((a=>(a.id===e&&(a=t(a,s)),a)))})}}updateFeatureValue(e,t,s,a){this.updateFeature(e,((e,a)=>(e.values=e.values.map((e=>(e.id===t&&(e=s(e,a)),e))),e)),a)}boolClick(e,t){this.updateFeatureValue(e,t,(e=>{switch(Math.abs(e.value)){case 0:e.value=1;break;case 1:e.value=2;break;case 2:e.value=0}return e}))}textValueUpdate(e,t,s){this.updateFeatureValue(e,t,((e,t)=>(e.value=t.currentTarget.value,e)),s)}featureTitleUpdate(e,t){this.updateFeature(e,((e,t)=>(e.title=t.currentTarget.value,e)),t)}featureDescriptionUpdate(e,t){this.updateFeature(e,((e,t)=>(e.description=t.currentTarget.value,e)),t)}featureMove(e,t){let s=this.state.features.slice(0),a=s.filter((t=>t.id===e))[0].position,i=t?a+1:a-1;s=s.map((t=>(t.position===i?t.position=a:t.id===e&&(t.position=i),t))),this.setState({features:s})}featureDelete(e){let t=this.state.features.slice(0),s=t.map((e=>e.id)).indexOf(e);t[s].id>=1e5?t.splice(s,1):t[s]._destroy=!0,this.setState({features:t})}toggleUserHighlight(e){this.setState((t=>{t.users.map((t=>(t.name===e.name&&(t.highlighted=!t.highlighted),t)))}))}toggleEditMode(){this.setState({editMode:!this.state.editMode},(()=>{this.captureTableHeaders(),window.scroll(0,0)}))}covers(){return r.createElement("tr",{ref:e=>this.CoversTrElem=e,style:this.state.coverHeaderStyle},r.createElement("td",{style:{width:this.state.tdWidths[0]}},this.editForm()),this.state.versions.map(((e,t)=>r.createElement("td",{key:`cover${t}`,className:"text-center",style:{verticalAlign:"bottom",width:this.state.tdWidths[t+1]}},r.createElement(w,{src:e.cloudinary_cover,className:"cover_med inline-block",style:{height:"120px",width:"85px"}})))))}titles(){return r.createElement("tr",{ref:e=>this.TitlesTrElem=e,className:"no-border",style:this.state.titleHeaderStyle},r.createElement("td",{className:"v-middle",style:{width:this.state.tdWidths[0]}},window.current_user&&window.current_user.karma>100?r.createElement("div",{className:"btn btn-sm btn-sm "+(this.state.editMode?"btn-default":"btn-primary"),onClick:this.toggleEditMode},"Edit Mode"):null,this.state.editMode?r.createElement("div",{className:"btn btn-primary btn-sm pull-right "+(this.state.modified?"":"disabled"),onClick:this.doSubmit},"Save"):null),this.state.versions.map(((e,t)=>r.createElement("td",{key:`version${e.id}`,className:"text-center v-middle",style:{width:this.state.tdWidths[t+1]}},r.createElement("a",{href:e.url},e.version_title||e.name)))))}releaseDates(){return r.createElement("tr",null,r.createElement("td",null,"Initial release date"),this.state.versions.map((e=>r.createElement("td",{key:`releaseDate${e.id}`,className:"text-muted text-center"},c()(e.release_date).format("MMM Do, YYYY")))))}platforms(){return r.createElement("tr",null,r.createElement("td",null,"Platforms"),this.state.versions.map((e=>r.createElement("td",{key:`platforms${e.id}`,className:"text-muted text-center"},e.platforms.map((e=>e[1].split("--")[0])).join(", ")))))}featureLabel(e,t,s){return r.createElement("td",{style:this.styles.featureTitle},this.state.editMode?r.createElement("input",{className:"form-control",type:"text",value:e.title,onChange:this.featureTitleUpdate.bind(this,e.id)}):e.title,this.state.editMode?r.createElement("textarea",{className:"form-control",value:e.description,onChange:this.featureDescriptionUpdate.bind(this,e.id)}):r.createElement("p",{className:"nomar text-muted hidden-sm hidden-xs"},e.description),this.state.editMode?r.createElement("div",null,t?null:r.createElement("div",{className:"btn btn-default btn-xs",onClick:this.featureMove.bind(this,e.id,0)},r.createElement("span",{className:"material-icons"},"keyboard_arrow_up")),s?null:r.createElement("div",{className:"btn btn-default btn-xs",onClick:this.featureMove.bind(this,e.id,1)},r.createElement("span",{className:"material-icons"},"keyboard_arrow_down")),r.createElement("div",{className:"btn btn-danger btn-xs pull-right",onClick:this.featureDelete.bind(this,e.id)},"x")):null)}getFeaturesOfCategory(e,t){return e.filter((e=>(null===e.category&&(e.category=0),e.category===t)))}featureValue(e,t){let s="";switch(Math.abs(t.value)){case 0:s=this.state.editMode?"close":"";break;case 1:s="check";break;default:return r.createElement("span",{className:`${1==t.value?"text-purple":"text-muted"} ${this.state.editMode?"cursor-pointer":""}`,onClick:this.boolClick.bind(this,e.id,t.id)},"Pre-order Only")}return r.createElement("span",{style:{fontSize:"32px"},className:`material-icons ${1==t.value?"text-purple":"text-muted"} ${this.state.editMode?"cursor-pointer":""}`,onClick:this.boolClick.bind(this,e.id,t.id)},s)}features(){let e=this.state.features.slice(0);e.sort(((e,t)=>e.position-t.position)),e=e.filter((e=>!e._destroy));let t=this.getFeaturesOfCategory(e,0),s=this.getFeaturesOfCategory(e,1);return t=t.map(((e,s)=>r.createElement("tr",{key:`bfeature${s}`},this.featureLabel(e,0===s,s===t.length-1),e.values.map(((t,a)=>r.createElement("td",{key:`bv${s}f${a}`,style:this.styles.featureTD},r.createElement("span",null,this.featureValue(e,t)))))))),s=s.map(((e,t)=>r.createElement("tr",{key:`tfeature${t}`},this.featureLabel(e,0===t,t===s.length-1),e.values.map(((s,a)=>r.createElement("td",{key:`tv${t}f${a}`,style:this.styles.featureTD},this.state.editMode?r.createElement("input",{className:"form-control",type:"text",placeholder:"Version-specific description",defaultValue:s.value,onChange:this.textValueUpdate.bind(this,e.id,s.id)}):r.createElement("span",null,s.value))))))),t.concat(s)}ensureDefaultValues(e,t){return e=e.map(((s,a)=>{if(s.values&&s.values.length&&s.values.length<t.length){t.filter((e=>0===s.values.filter((t=>t.game_id===e.id)).length)).forEach((t=>{const i=1e5+a+e.reduce(((e,t)=>e+t.values.length),0),r=s.category;s.values.push({id:i,game_id:t.id,value:r?"":0,game_feature_id:s.id})}))}if(s.values.length){const e=[];t.forEach(((t,a)=>{e[a]=s.values.filter((e=>e.game_id===t.id))[0]})),s.values=e}else{s.values=[],s.category=0;for(let e=0;e<this.props.version.versions.length;e++)s.values=this.newFeatureValues(s.category)}return s.position=a,s}))}newFeatureValues(e){const t=this.state&&this.state.versions||this.props.version.versions,s=this.state&&this.state.features||this.props.version.features;return t.map(((t,a)=>({id:1e5+a+s.reduce(((e,t)=>e+t.values.length),0),game_id:t.id,value:e?"":0})))}newFeature(e){const t=1e5+this.state.features.length,s=this.state.features.slice(0),a=this.inputTitleElem.value,i=this.inputDescriptionElem.value,r=this.inputTypeElem.value;s.push({id:t,game_version_id:this.state.id,title:a,description:i,category:r,values:this.newFeatureValues(r),position:this.getFeaturesOfCategory(s,r).length}),this.setState({features:s}),this.inputTitleElem.value="",this.inputDescriptionElem.value=""}editForm(){return this.state.editMode?r.createElement("div",null,r.createElement("input",{ref:e=>this.inputTitleElem=e,type:"text",className:"form-control",placeholder:"Feature Title"}),r.createElement("textarea",{ref:e=>this.inputDescriptionElem=e,className:"form-control",placeholder:"Feature Description"}),r.createElement("select",{className:"form-control",ref:e=>this.inputTypeElem=e},r.createElement("option",{value:"0"},"Yes/No"),r.createElement("option",{value:"1"},"Text")),r.createElement("div",{className:"btn btn-primary btn-sm pull-right",onClick:this.newFeature},"Add")):null}hiddenForm(){return this.state.features.map(((e,t)=>r.createElement("div",{key:`form${t}`},e.id<1e5?r.createElement("input",{type:"hidden",name:`game_version[game_features_attributes][${e.id}][id]`,value:e.id}):null,r.createElement("input",{type:"hidden",name:`game_version[game_features_attributes][${e.id}][position]`,value:e.position||0}),r.createElement("input",{type:"hidden",name:`game_version[game_features_attributes][${e.id}][title]`,value:e.title}),r.createElement("input",{type:"hidden",name:`game_version[game_features_attributes][${e.id}][description]`,value:e.description}),e.game_version_id?r.createElement("input",{type:"hidden",name:`game_version[game_features_attributes][${e.id}][game_version_id]`,value:e.game_version_id}):null,r.createElement("input",{type:"hidden",name:`game_version[game_features_attributes][${e.id}][category]`,value:e.category}),e._destroy?r.createElement("input",{type:"hidden",name:`game_version[game_features_attributes][${e.id}][_destroy]`,value:"1"}):null,e.values.map(((t,s)=>r.createElement("div",{key:`formValue${s}`},t.id<1e5?r.createElement("input",{type:"hidden",name:`game_version[game_features_attributes][${e.id}][game_feature_values_attributes][${t.id}][id]`,value:t.id}):null,r.createElement("input",{type:"hidden",name:`game_version[game_features_attributes][${e.id}][game_feature_values_attributes][${t.id}][game_id]`,value:t.game_id}),r.createElement("input",{type:"hidden",name:`game_version[game_features_attributes][${e.id}][game_feature_values_attributes][${t.id}][value]`,value:t.value}),t.game_feature_id?r.createElement("input",{type:"hidden",name:`game_version[game_features_attributes][${e.id}][game_feature_values_attributes][${t.id}][game_feature_id]`,value:t.game_feature_id}):null))))))}render(){return r.createElement("form",{id:"versionForm",ref:e=>this.submitForm=e,action:"/game_versions"+(this.state.id?`/${this.state.id}`:""),acceptCharset:"UTF-8",method:this.state.id?"PATCH":"POST"},r.createElement("input",{type:"hidden",name:"authenticity_token",value:window.csrfToken}),r.createElement("input",{name:"utf8",type:"hidden",value:"\u2713"}),r.createElement("input",{type:"hidden",name:"game_version[id]",value:this.state.id}),r.createElement("input",{type:"hidden",name:"game_version[game_id]",value:this.state.versions[0].id}),r.createElement("div",{style:{fontFamily:"sans-serif",overflowX:"scroll"}},r.createElement("div",{className:"panel panel-default",style:this.state.tablePanelStyle},r.createElement("div",{className:"panel-body"},r.createElement("table",{className:"table table-noedge-border table-versions table-striped "+(this.state.editMode?"table-versions-edit":"table-fixed")},r.createElement("tbody",null,this.covers(),this.titles(),this.releaseDates(),this.features(),this.platforms()))))),r.createElement("div",null,this.state.editMode?this.hiddenForm():null))}}var Ue=Ie;class We extends r.Component{constructor(e){super(e),this.state=this.props.settings,this.goToPage=this.goToPage.bind(this),this.currentPage=this.currentPage.bind(this),this.calculateNumbers=this.calculateNumbers.bind(this)}goToPage(e,t){let s;if(t>-1&&this.currentPage()!==t){if(e)return void this.setState({offset:t*this.state.per_page});!0!==this.state.loading&&(s=t*this.state.per_page,this.setState({loading:!0}),this.props.sister.goToPage(!0,t),this.props.callback({page:s/this.state.per_page+1,success:function(e){this.setState({loading:!1,offset:s})}.bind(this),error:function(){this.setState({loading:!1})}.bind(this)}))}}currentPage(){return this.state.offset/this.state.per_page}calculateNumbers(){let e,t,s,a,i,r,n,l,o,c,m,d,h,u,p,g;const _=[],f=this.currentPage();if(this.state.pages<12)for(e=t=1,l=this.state.pages;l>=1?t<=l:t>=l;e=l>=1?++t:--t)_.push(e);else{if(f-5<1)for(e=s=1,o=f+4;o>=1?s<=o:s>=o;e=o>=1?++s:--s)_.push(e);else for(e=a=1,c=4;a<=4;e=++a)_.push(e);if(f>5&&f<=this.state.pages-5-2)for(_.push("..."),e=i=m=f-1,d=f+3;m<=d?i<=d:i>=d;e=m<=d?++i:--i)_.push(e);if(_.push("..."),f<this.state.pages-5+2&&f>this.state.pages-5-2)for(e=r=h=this.state.pages-(this.state.pages-f)-1,u=this.state.pages;h<=u?r<=u:r>=u;e=h<=u?++r:--r)_.push(e);else for(e=n=p=this.state.pages-5+2,g=this.state.pages;p<=g?n<=g:n>=g;e=p<=g?++n:--n)_.push(e)}return _}render(){const{minPages:e=1}=this.props;if(this.state.pages>e){const e=this.currentPage(),t=0===this.state.offset?"disabled":"",s=e+1===this.state.pages?"disabled":"";return r.createElement("div",{className:"pagination"},r.createElement("li",{className:`prev ${t}`,onClick:this.goToPage.bind(this,!1,e>0&&e-1)},r.createElement("span",null,"\u2190 Previous")),this.calculateNumbers().map(((t,s)=>{const a=t-1===e?"active":"";return r.createElement("li",{key:`page_${s}`,className:a,onClick:this.goToPage.bind(this,!1,t-1)},r.createElement("span",null,t))})),r.createElement("li",{className:`next ${s}`,onClick:this.goToPage.bind(this,!1,e+1<this.state.pages&&e+1)},r.createElement("span",null,"Next \u2192")))}return null}}var Ve=We;class He extends r.Component{constructor(e){super(e),this.state={child_games:e.child_games,games:e.games,list_name:e.list_name,pagination:e.pagination,sorting:e.sorting},this.perform_request=this.perform_request.bind(this),this.set_filter=this.set_filter.bind(this)}componentDidMount(){this.setState({paginations:[this.pagination_1,this.pagination_2],d:1,s:this.state.sorting[0][1]})}perform_request({success:e=!1,error:t=!1,page:s=1}){let a={};a[""+this.state.s]=this.state.d?"desc":"asc",a.page=s,a.list_name=this.state.list_name,$.ajax({url:this.state.pagination.url,data:a,dataType:"json",success:function(t){return e&&e(t),this.setState({games:t.games,child_games:t.child_games})}.bind(this),error:t})}set_filter(e){this.state.s=e,this.state.d=this.state.d?0:1,this.forceUpdate(),this.perform_request({page:this.pagination_1.currentPage()+1})}render(){return r.createElement("div",{className:"game-list-container"},r.createElement("div",{className:"sorting-area"},r.createElement("span",{className:"fa fa-filter text-muted"}),r.createElement("span",{className:"text-muted"}," Sorting"),(()=>{const e=1==this.state.d?"fa-caret-down":"fa-caret-up";let t=["label-primary","","","hide","","hide"];switch(this.state.s){case"title":t=["","hide","label-primary","","","hide"];break;case"releasedate":t=["","hide","","hide","label-primary",""]}return r.createElement("div",{className:"sorting-methods pull-right col-md-6 nopad text-right"},r.createElement("div",{className:`label label-default cursor-pointer mar-sm-right ${t[0]}`,onClick:this.set_filter.bind(this,this.state.sorting[0][1])},"Rating ",r.createElement("span",{className:`fa ${e} ${t[1]}`})),r.createElement("div",{className:`label label-default cursor-pointer mar-sm-right ${t[2]}`,onClick:this.set_filter.bind(this,this.state.sorting[2][1])},"Title ",r.createElement("span",{className:`fa ${e} ${t[3]}`})),r.createElement("div",{className:`label label-default cursor-pointer ${t[4]}`,onClick:this.set_filter.bind(this,this.state.sorting[1][1])},"Release Date"," ",r.createElement("span",{className:`fa ${e} ${t[5]}`})))})()),r.createElement(Ve,{ref:e=>this.pagination_1=e,sister:!!this.state.paginations&&this.state.paginations[1],settings:this.state.pagination,callback:this.perform_request,minPages:1}),r.createElement(be,{games:this.state.games,child_games:this.state.child_games}),r.createElement(Ve,{ref:e=>this.pagination_2=e,sister:!!this.state.paginations&&this.state.paginations[0],settings:this.state.pagination,callback:this.perform_request,minPages:1}))}}var Ge=He;s(686);var Ye=(e,t)=>{null==e&&(e=!1),null==t&&(t={});const s=function(e,t){return t.text="Add: '"+t.text+"'",e.push(t)};function a(e,t){e.parent().find(".select2-search__field").removeClass("alert alert-danger"),t.remove()}function i(e){return`${e.attr("id")}_error`}function r(e,t,s){let r=i(e),n=l()(`#${r}`);if(!t.test(s))return a(e,n),{id:s,text:s};let o=`'${s}' Does not match valid characters. Only letters, numbers, spaces, dashes, underscores, apostrophes and slashes are accepted.`;return 0===n.length?(e.siblings(".select2").find(".selection").prepend(`<div id="${r}" style="position: absolute; right: 0; height: 100%;line-height: 100%;display: flex; justify-content: center; align-items: center; background-color: #c32919; color: #fff">${o}</div>`),e.parent().find(".select2-search__field").addClass("alert alert-danger")):n.text(o),null}return e||(e=l()("select.select2")),e.each((function(e,n){var o,c,m,d,h;if(n=l()(this),o=[],n.find("option").each((function(e,t){if((t=l()(t)).val())return o.push({id:t.val(),text:t.text()})})),!n.hasClass("select2-active")){if(m=n.is("[multiple]"),c=n.is("[data-creatable]"),d=!n.is("[required]"),n.is(":not([data-url])"))h={theme:"bootstrap",tags:c,multiple:m,allowClear:d,insertTag:s},h=l().extend(h,t),n.select2(h);else if(n.is("[data-url]")){n=l()(this);const e=(e=[])=>e.length?{results:e}:{results:[]},a=t.processResults||e;h={tags:c,selectOnClose:c,multiple:m,allowClear:d,minimumInputLength:o.length?0:2,insertTag:s,theme:"bootstrap",ajax:{url:n.data("url"),dataType:"json",type:"get",transport:function(e,t,s){if(!(e.data.term&&e.data.term.length>=2))return t({results:o});l().ajax({url:e.url,data:e.data,success:t,error:s})},data:function(e){return{term:e.term,limit:15}},processResults:a}}}let e=n.attr("data-pattern"),u=void 0!==e&&new RegExp(e,"i");return void 0!==e&&(h.createTag=function(e,t){let s=e.term;return r(n,u,s)}),h=l().extend(h,t),n.select2(h),void 0!==e&&(n.parent().find(".select2-search__field").keyup((function(){r(n,u,this.value)})),n.on("select2:close",(function(){let e=i(n),t=l()(`#${e}`);a(n,t)}))),n.addClass("select2-active")}}))};var Je=function(e){const[t,s]=r.useState(e.list.numbering),[a,i]=r.useState(e.list.private),[n,o]=r.useState(e.list.list_entries),c=(e,t)=>{t>=n.length?t=0:t<0&&(t=n.length);const s=n.slice(0),[a]=s.splice(e,1);s.splice(t,0,a),o(s)},m=(e,t)=>{const s=n.slice(0);s[e].description=t,o(s)},d=e=>{const t=n.slice(0);t[e].destroy=t[e].destroy?0:1,o(t)},h=e=>{document.getElementById(e).click()};r.useEffect((()=>{Ye(l()(".react-tags-selector")),Ye(l()(".react-game-selector"))}),[]);const u=n.map(((e,s)=>function(e){const{item:t,index:s,isNumbered:a,updateOrder:i,updateDescription:n,toggleRemoveItem:l,tracking_context:o,tracking_medium:c}=e,m=t&&t.game&&t.game.cover&&t.game.cover.cloudinary_id||"nocover",d=t&&t.game&&t.game.first_release_date_object&&t.game.first_release_date_object.release_year,h=`${t.id||s}${t.game_id}`;return r.createElement("li",{key:h,className:"list-group-item top_list nested-fields overflow "+(t.destroy?"opacity-25":"")},r.createElement("div",{className:"media overflow"},r.createElement("div",{className:"col-md-1 nopad"},r.createElement("img",{className:"img-responsive thumb",alt:t.game.name,src:`//images.igdb.com/igdb/image/upload/t_cover_med/${m}.jpg`})),r.createElement("div",{className:"col-md-1 nopad text-right pull-right"},r.createElement("div",{className:"list-group-item__edit-actions"},r.createElement("input",{value:t.destroy,readOnly:!0,type:"hidden",name:`list[list_entries_attributes][${s}][_destroy]`,id:`list_list_entries_attributes_${s}__destroy`}),r.createElement("a",{className:"fa fa-fw fa-arrow-up fa-lg mar-md-right link-simple",title:"Move Up",onClick:e=>i(s,s-1)}),r.createElement("a",{className:"fa fa-fw fa-arrow-down fa-lg mar-md-right link-simple",title:"Move Down",onClick:e=>i(s,s+1)}),t.destroy?r.createElement("a",{className:"fa fa-lg fa-fw fa-history text-success link-simple",title:"Restore",onClick:e=>l(s)}):r.createElement("a",{className:"fa fa-lg fa-fw fa-times text-danger link-simple",title:"Remove",onClick:e=>l(s)})),r.createElement("div",{className:"list-group-item__edit-actions"},r.createElement("input",{value:t.destroy,readOnly:!0,type:"hidden",name:`list[list_entries_attributes][${s}][_destroy]`,id:`list_list_entries_attributes_${s}__destroy`}),r.createElement("a",{className:"fa fa-fw fa-angle-double-up fa-lg mar-md-right link-simple",title:"Move to Top",onClick:e=>i(s,0)}),r.createElement("a",{className:"fa fa-fw fa-angle-double-down fa-lg mar-md-right link-simple",title:"Move to Bottom",onClick:e=>i(s,-1)}))),r.createElement("div",{className:"col-md-10"},r.createElement("div",null,r.createElement("h4",{className:"media-heading"},r.createElement("span",{className:"numbering"},a?`${s+1} `:""),r.createElement("span",{className:"game-name"},t.game.name),"\xa0",d&&r.createElement("small",{className:"text-muted year"},"(",d,")")),r.createElement("textarea",{className:"form-control motivation",rows:"3",defaultValue:t.description,onChange:e=>n(s,e.target.value),name:`list[list_entries_attributes][${s}][description]`,id:`list_list_entries_attributes_${s}_description`})))),r.createElement("input",{className:"game_selected",type:"hidden",value:t.game.id,readOnly:!0,name:`list[list_entries_attributes][${s}][game_id]`,id:`list_list_entries_attributes_${s}_game_id`}),r.createElement("input",{className:"list_position",type:"hidden",value:s,readOnly:!0,name:`list[list_entries_attributes][${s}][position]`,id:`list_list_entries_attributes_${s}_position`}),r.createElement("input",{type:"hidden",value:t.id,readOnly:!0,name:`list[list_entries_attributes][${s}][id]`,id:`list_list_entries_attributes_${s}_id`}))}({item:e,index:s,isNumbered:t,updateDescription:m,updateOrder:c,toggleRemoveItem:d}))),p=e.list.list_tags.map((e=>e.id)),g=e.tags.map((([e,t])=>r.createElement("option",{key:t,value:t},e)));return r.createElement("div",null,r.createElement("div",{className:"form-group row"},r.createElement("label",{htmlFor:"list_name",className:"col-lg-2 control-label"},"Name your List"),r.createElement("div",{className:"col-lg-10"},r.createElement("input",{required:!0,className:"form-control",type:"text",defaultValue:e.list.name,name:"list[name]",id:"list_name"}))),r.createElement("div",{className:"form-group row"},r.createElement("label",{htmlFor:"list_tags",className:"col-lg-2 control-label"},"Tags"),r.createElement("div",{className:"col-lg-10"},r.createElement("select",{multiple:!0,className:"react-tags-selector form-control","data-placeholder":"Insert tags here","data-creatable":"true","data-pattern":"[^a-z0-9_ \\-\\/\\']+",name:"list[tags][]",id:"list_tags",defaultValue:p},g))),r.createElement("div",{className:"form-group row"},r.createElement("label",{htmlFor:"list_description",className:"col-lg-2 control-label"},"Description"),r.createElement("div",{className:"col-lg-10"},r.createElement("textarea",{className:"form-control mini_editor",defaultValue:e.list.description,name:"list[description]",id:"list_description"}))),r.createElement("div",{className:"form-group"},r.createElement("div",{className:"col-sm-offset-2"},r.createElement("input",{name:"list[private]",type:"hidden",value:"0"}),r.createElement("input",{className:"checkbox",type:"checkbox",checked:a,onChange:e=>i(e.target.checked),name:"list[private]",id:"list_private"}),r.createElement("label",{className:"mar-md-right",htmlFor:"list_private"},"Private"),r.createElement("input",{name:"list[numbering]",type:"hidden",value:"0"}),r.createElement("input",{className:"checkbox",type:"checkbox",checked:t,onChange:e=>s(e.target.checked),name:"list[numbering]",id:"list_numbering"}),r.createElement("label",{htmlFor:"list_numbering"},"Numbering"))),r.createElement("div",{className:"form-group"},r.createElement("div",null,r.createElement("div",{className:"row list-edit__toolbar",id:"listFormToolbar"},r.createElement("div",{className:"col-sm-5 col-lg-6"},r.createElement("div",{className:"input-group"},r.createElement("select",{name:"game_selector",id:"game_selector","data-placeholder":"Search for a game","data-url":"/games/select",className:"select_game_selector form-control select2 react-game-selector"}),r.createElement("div",{className:"input-group-btn"},r.createElement("a",{className:"btn btn-primary",onClick:()=>{const e=l()(".react-game-selector").select2("data");if(1!==e.length)return void console.warn("You must select a game");const t=e[0],s={game_id:t.id,game:{id:t.id,name:t.name,first_release_date_object:{release_year:t.year},cover:{cloudinary_id:t.cover}}},a=()=>{const e=n.slice(0);e.push(s),o(e),window.notify(`${t.name} added.`,"success")};n.map((e=>e.game_id.toString())).includes(s.game_id)?window.notify(r.createElement("span",null,r.createElement("span",null,s.game.name," is already in this list."),r.createElement("button",{className:"btn btn-link btn-xs toast-button",onClick:e=>{a(),e.currentTarget.disabled=!0}},"Add anyway?")),"danger"):a()}},"Add Game")))),r.createElement("div",{className:"list-edit__button-container"},r.createElement("a",{className:"btn btn-danger list-edit__button",onClick:()=>h("delete-button")},"Delete list"),r.createElement("a",{className:"btn btn-primary list-edit__button",onClick:()=>h("save-button")},"Save list"))),r.createElement("div",{className:"block",id:"listNotice"}),r.createElement("ul",{className:"list-group mar-md-top","data-url":"/search_autocomplete",id:"top_list"},u))))};class Ke extends r.Component{constructor(e){super(e),this.truncate=this.truncate.bind(this),this.renderRating=this.renderRating.bind(this),this.renderCreatedAt=this.renderCreatedAt.bind(this)}truncate(e,t){return e.length>t?`${e.substring(0,t)}...`:e}renderRating(){if(this.props.review.rating){const e=Math.round(this.props.review.rating)-1,t=130-13*e,s={WebkitFilter:`hue-rotate(-${t}deg)`,filter:`hue-rotate(-${t}deg)`},a=v(e);return r.createElement("span",null,a&&a.word," ",r.createElement("span",{className:"member-review-rating-word",style:s},Math.round(10*this.props.review.rating),"%"))}return null}renderCreatedAt(){if(this.props.review.created_at){const e=c()(1e3*this.props.review.created_at);return r.createElement("time",{dateTime:e.format("U")},e.format("MMMM Do, YYYY"))}return null}renderPositiveNegative(){const e=e=>e&&"<p></p>"!==e,t=e(this.props.review.positive),s=e(this.props.review.negative);if(t&&s)return r.createElement("div",{className:"row"},r.createElement("br",null),t?r.createElement("div",{className:"col-sm-6"},r.createElement("strong",{className:"text-purple"},"Positive points"),r.createElement(pe,{html:this.props.review.positive,limit:200})):null,s?r.createElement("div",{className:"col-sm-6"},r.createElement("strong",{className:"text-danger"},"Negative points"),r.createElement(pe,{html:this.props.review.negative,limit:200})):null)}render(){return r.createElement("div",{className:"row member-review-game"},r.createElement("div",{className:"col-xs-3 col-md-2"},r.createElement("div",{className:"media"},r.createElement("div",{className:"media-left"},r.createElement(y,{user:this.props.review.user,className:"avatar_large",size:45})),this.props.review.user.username||this.props.review.username?r.createElement("div",{className:"media-body"},r.createElement("a",{href:this.props.review.user.url,target:"_self"},this.props.review.user.username||this.props.review.username),this.props.review.user.reviews?r.createElement("div",{className:"text-muted"},this.props.review.user.reviews," reviews"):null):null)),r.createElement("div",{className:"col-md-10"},r.createElement("h2",{className:"nomar-top member-review-rating"},this.renderRating(),r.createElement("small",null,this.renderCreatedAt())),r.createElement("div",{className:"member-review-game-text"},r.createElement(pe,{html:this.props.review.summary,limit:450}),this.renderPositiveNegative())))}}var Qe=Ke;class Xe extends r.Component{constructor(e){super(e),this.state={isFirstRender:!0,text_reviews:e.text_reviews,game_name:e.game_name,username:e.username,game_id:e.game_id,rating_info_path:e.ratingInfoPath,rating_path:e.ratingPath},this.review_update=this.review_update.bind(this),this.post_review=this.post_review.bind(this),this.add_review=this.add_review.bind(this),this.rating_update=this.rating_update.bind(this),this.rating_error=this.rating_error.bind(this),this.isServerOrFirstRender=this.isServerOrFirstRender.bind(this)}componentDidMount(){this.setState({isFirstRender:!1}),this.props.current_user&&se.get({has_reviewed_game:{id:this.props.game_id}}).then((e=>{this.setState(e.has_reviewed_game)}))}post_review(){let e;(null!=(e=this.state.content)?e.length:void 0)>60?this.state.rating?(this.setState({posting:!0}),$.ajax({url:this.props.review_url,type:"POST",data:{location_context:"games_quick_review",location_medium_review_rating:"star_rating","review[category]":1,"review[title]":`${this.state.username}'s review of ${this.state.game_name}`,"review[review_text_attributes][content]":this.state.content,"review[review_text_attributes][positive_points]":this.state.positive,"review[review_text_attributes][negative_points]":this.state.negative,"review[rating_category]":2,"review[review_rating_attributes][rating]":this.state.rating||0},success:function(){mp.track("create","review"),this.add_review()}.bind(this),error:function(){this.add_review()}.bind(this)})):this.setState({error:2}):this.setState({error:1})}add_review(){this.state.text_reviews||(this.state.text_reviews=[]),this.state.text_reviews.unshift({id:0,category:1,summary:this.state.content,review_likes_count:0,rating:this.state.rating,user:this.props.current_user}),this.state.posting=!1,this.state.has_reviewed_game=!0,this.state.just_reviewed=!0,this.forceUpdate()}review_update(){const e=this.reviewTextElem.value,t=this.positiveTextElem.value,s=this.negativeTextElem.value;this.setState({content:e,positive:t,negative:s,error:0})}rating_update(e){this.setState({rating:e,error:0})}rating_error(){return setTimeout((()=>this.setState({error:0})),1e3),2===this.state.error?"keyframe-shake-once":""}render(){const e=this.state.text_reviews?this.state.text_reviews:[],t=1===this.state.error?["has-error","text-danger"]:["",""],s=2===this.state.error?this.rating_error():"";return r.createElement("div",null,this.isServerOrFirstRender()||!this.props.current_user||this.state.has_reviewed_game?null:r.createElement("div",{className:"row mar-lg-bottom"},r.createElement("div",{className:"col-md-offset-2 col-md-10"},r.createElement("label",null,"Write a review")),r.createElement("div",{className:"col-md-2 mar-lg-bottom"},r.createElement(w,{src:this.props.current_user.avatar}),r.createElement("p",{className:"text-muted mar-lg-top"},"This review must contain original content written by you.")),r.createElement("div",{className:`col-md-10 ${t[0]}`},this.state.content&&this.state.content.length<60?r.createElement("p",{className:`text-muted ${t[1]}`},"You need ",60-this.state.content.length," more characters..."):null,r.createElement("div",{className:"form-group"},r.createElement("textarea",{ref:e=>this.reviewTextElem=e,className:"form-control",rows:"8",value:this.props.current_user.content,onChange:this.review_update})),r.createElement("div",{className:"row"},r.createElement("div",{className:"col-md-6"},r.createElement("label",null,"Positive Points"),r.createElement("textarea",{ref:e=>this.positiveTextElem=e,className:"form-control",placeholder:"Some things you liked...",rows:"3",onChange:this.review_update})),r.createElement("div",{className:"col-md-6"},r.createElement("label",null,"Negative Points"),r.createElement("textarea",{ref:e=>this.negativeTextElem=e,className:"form-control",placeholder:"Some things you didn't...",rows:"3",onChange:this.review_update}))),r.createElement("div",{className:"pull-right mar-lg-top"},r.createElement("strong",{className:"rating-stars-label"},"How would you rate it?"),r.createElement(Me,{className:s,callback:this.rating_update,rating:0,ratingInfoPath:this.state.rating_info_path,ratingPath:this.state.rating_path,gameId:this.state.game_id}),this.state.posting?r.createElement("button",{className:"pull-right mar-lg-left btn btn-sm btn-default disabled"},"Posting..."):r.createElement("button",{className:"pull-right mar-lg-left btn btn-sm btn-primary",onClick:this.post_review},"Post")))),this.state.just_reviewed&&r.createElement("p",{className:"alert alert-info"},"Your review has entered moderation and will be live within 24 hours"),e.map((e=>r.createElement(Qe,{key:`review_${e.id}`,review:e}))),this.props.total_reviews>5?r.createElement("a",{className:"btn btn-block",href:this.props.review_url},"Read More Reviews"):null)}isServerOrFirstRender(){return window.is_server||!this.state||this.state.isFirstRender}}var Ze=Xe;class et extends r.Component{constructor(e){super(e),this.categories=[null,["common","Common"],["rare","Rare"],["epic","Epic"],["unique","Unique"]];const t="small"===e.size?64:128;this.state={size:t,mediaLeftWidth:{minWidth:`${t+20}px`}},this.badge=this.badge.bind(this)}badgeIcon(e){return r.createElement("div",{className:`merit-badge merit-badge-${this.props.size} merit-badge-${this.categories[e.category][0]}`},r.createElement(w,{className:"icon_md merit-badge-image",src:e.cloudinary_id,alt:"",lossless:!0}))}badge(e){let t=this.state.size/e.goal*e.progress;return t=t>this.state.size?64:t,r.createElement("div",{key:`badge${e.id}`,className:`media media-merit-badge ${this.props.className}`,title:void 0!==e.progress?`${Math.floor(100/e.goal*e.progress)}%`:"Achieved!"},void 0!==e.progress?r.createElement("div",{className:"media-left",style:this.state.mediaLeftWidth},r.createElement("div",{className:`merit-badge merit-badge-${this.props.size} merit-badge-dead merit-badge-deadBackground`}),r.createElement("div",{className:"merit-badge-mask",style:{width:`${t}px`}},this.badgeIcon(e))):r.createElement("div",{className:"media-left",style:this.state.mediaLeftWidth},this.badgeIcon(e)),r.createElement("div",{className:"media-body"},r.createElement("h4",{className:"nomar"},e.name),r.createElement("div",{className:"text-purple mar-sm-bottom"},this.categories[e.category][1]),r.createElement("p",{className:"text-muted"},e.description)))}render(){return r.createElement("div",{className:"fix-heights"},this.props.finished.map(this.badge),this.props.unfinished.map(this.badge))}}var tt=et;class st extends r.Component{constructor(e){let t;super(e);const s=this.props,a=this.props.options;for(let i=0;i<a.length;i+=1)t=a[i],t.insite="1"===s[`${t.id}_in_site`];this.state=s,this.checked=this.checked.bind(this),this.save=this.save.bind(this)}checked(e,t,s){return this.state.options[e][t]=!s,this.save(),this.forceUpdate()}save(){let e;const t={},s=this.state.options;for(let a=0;a<s.length;a+=1)e=s[a],t[`${e.id}_in_site`]=e.insite?1:null;$.ajax({type:"put",url:this.state.url,data:{user_notification_setting:t}})}render(){return r.createElement("div",null,r.createElement("table",{className:"table table-condensed nomar table-valign-middle"},r.createElement("thead",null,r.createElement("tr",{className:"active"},r.createElement("th",null,"Notification Type"),r.createElement("th",{className:"text-center"},"In-Site"))),r.createElement("tbody",null,this.state.options.map(((e,t)=>{const s=`option_${e.id}`,a=`option_insite_${e.id}`;return r.createElement("tr",{key:s},r.createElement("td",null,e.title,r.createElement("br",null),r.createElement("small",{className:"text-muted"},e.description)),r.createElement("td",{className:"text-center"},r.createElement("input",{className:"checkbox",id:a,name:a,type:"checkbox",onChange:this.checked.bind(this,t,"insite",e.insite),checked:e.insite,disabled:e.insiteLocked}),r.createElement("label",{className:e.insiteLocked?"disabled":"",htmlFor:a})))})))))}}var at=st;var it=({sortOptions:e,params:t,href:s})=>{const a=e.find((e=>t[e.value]&&t[e.value]===e.order)),i=a?a.name:"Default",n=e=>{const t=e.order||"asc",a=e.value;return`${s}&${a}=${t}&target=listentries`};return r.createElement("div",{className:"list-sorting-area-with-pagination"},r.createElement("div",{className:"list-sort"},r.createElement("div",{className:"btn-group"},r.createElement("button",{type:"button",className:"btn btn-default dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"Sort By: ",i,r.createElement("span",{className:"caret"})),r.createElement("ul",{className:"dropdown-menu list-sort__dropdown"},e.map((e=>r.createElement("li",{key:`sort_${e.value}_${e.order}`,className:i===e.name?"active":""},r.createElement("a",{href:n(e)},e.name))))))))};const rt=[25,50,100];var nt=({totalPages:e,href:t,params:s,sortOptions:a})=>{const{page:i=1,per_page:n=25}=s,l=1===+i?"hidden":"",o=+i===e?"hidden":"",c=1===e?"pagination-hidden":"",m=(e,s)=>{const a=window.location.href.split("?")[1];if(!a)return`${t}?page=${e||i}&per_page=${s||n}`;const r=a.replace(`page=${i}`,`page=${e||i}`).replace(`per_page=${n}`,`per_page=${s||n}`);return`${t}?${r}`},d=(e,t)=>e?r.createElement("a",{href:e},t):t;return r.createElement("div",{className:"pagination-container"},r.createElement("div",{className:`pagination ${c}`},r.createElement("li",{className:`prev ${l}`},r.createElement("span",null,d(m(+i-1,n),"\u2190 Previous"))),(()=>{let t,s,a=Math.floor(3)-1,r=Math.ceil(3)-1;e<=6?(t=1,s=e):+i<=r?(t=1,s=+i+r):+i+r>=e?(t=e-6+1,s=e):(t=+i-a,t=t<1?1:t,s=+i+r,s=s>e?e:s),t=t>2?t:1,s=s<e-2?s:e;let n=Array.from(Array(s+1-t).keys()).map((e=>t+e));return[...t>2?[1,2,t>3?"...":void 0].filter(Boolean):[],...n,...s<e-1?[s<e-2?"...":void 0,e-1,e].filter(Boolean):[]]})().map(((e,t)=>{const s=+i===e?"active":"",a="..."===e?"disabled":"";return r.createElement("li",{key:`page_${e}_${t}`,className:`${s} ${a}`},r.createElement("span",null,d(s||a?void 0:m(e,n),e)))})),r.createElement("li",{className:`next ${o}`},r.createElement("span",null,d(m(+i+1,n),"Next \u2192")))),r.createElement("div",{className:"pagination-right-controls"},a&&r.createElement(it,{params:s,href:`${m(i,n)}`,sortOptions:a}),r.createElement("div",{className:"pagination"},rt.map((e=>{const t=+n===e?"active":"";return r.createElement("li",{key:`items_${e}`,className:t},r.createElement("span",null,d(t?void 0:m(1,e),e)))})))))};class lt extends r.Component{constructor(e){super(e),this.state={affix:!1,backgroundImage:this.is_server?null:g(e.backgroundImage,"header_cover"),avatarImage:g(e.avatarImage,"avatar_large"),isMobile:e.isMobile||f()},this.scroll=this.scroll.bind(this),this.selectMenuTab=this.selectMenuTab.bind(this),this.actionButtonClick=this.actionButtonClick.bind(this),this.debouncedResize=h(this.resize.bind(this),100)}componentDidMount(){l()(window).on("resize",this.debouncedResize).on("scroll",this.scroll)}componentWillUnmount(){l()(window).off("resize",this.debouncedResize).off("scroll",this.scroll)}resize(){this.setState({isMobile:f()})}scroll(){if(this.avatarElement){const e=this.state.isMobile?225:139;this.setState({affix:window.pageYOffset>window.getElementOffset(this.avatarElement).top+e})}}selectMenuTab(e){}actionButtonClick(){return!1}background(){return r.createElement("div",{className:"generic-header-base-background",style:{backgroundColor:this.props.backgroundColor||"white",backgroundImage:this.state.backgroundImage?`url(${this.state.backgroundImage})`:null}})}avatar(){const e=this.state.isMobile?100:200;return r.createElement("div",{ref:e=>this.avatarElement=e,className:"generic-header-base-avatar",style:{width:`${e}px`,height:`${e}px`,backgroundColor:this.props.backgroundColor}},this.state.isMobile?null:this.avatarEditButton(),r.createElement(w,{src:this.state.avatarImage,width:e,height:e,lossless:!0,style:{maxHeight:"100%"}}))}avatarAffix(){return r.createElement("div",{className:"generic-header-base-avatarAffix-container"},r.createElement("div",{className:"generic-header-base-avatarAffix"},r.createElement("div",{className:"media"},r.createElement("div",{className:"media-left media-middle"},r.createElement(w,{className:"micro",src:this.state.avatarImage,force_load:!0,width:35,height:35})),r.createElement("div",{className:"media-body media-middle generic-header-base-avatarTitle"},this.props.avatarTitle))))}headerMenu(){return r.createElement(we,{className:"generic-header-base-tabsContainer",items:["Overview","Games","Lists","Contributions"],callback:this.selectMenuTab,defaultTab:this.props.defaultTab})}actionButton(){return r.createElement("div",{className:"btn generic-header-base-actionButton "+(this.state.followed?"btn-default":"btn-primary"),onClick:this.actionButtonClick},this.state.followed?"Unfollow":"Follow")}avatarEditButton(){return null}coverEditButton(){return null}render(){return r.createElement("div",{className:"generic-header-base-container "+(this.state.affix?"generic-header-base-compact":"")},r.createElement("div",{className:"generic-header-base"},this.isMobile?null:this.coverEditButton(),this.background(),this.avatar()),r.createElement("div",{className:"row generic-header-base-menu "+(this.state.affix?"affix":"")},r.createElement("div",{className:"generic-header-base-menuBackground"}),r.createElement("div",{className:"col-sm-3"},this.avatarAffix()),r.createElement("div",{className:"col-sm-9"},this.actionButton(),this.headerMenu())))}}var ot=lt;var ct=class extends ot{constructor(e){super(e),b()&&(this.isOwner=e.person.owners&&e.person.owners.indexOf(window.current_user.user)>-1),this.extraMenuClick=this.extraMenuClick.bind(this)}extraMenuClick(e){if(e)e.preventDefault();else if(!this.state.extraMenuDropdownOpen)return!1;return this.setState({extraMenuDropdownOpen:!this.state.extraMenuDropdownOpen}),!1}headerMenu(){const e=[{name:"Gameography",url:this.props.person.url}],t=[r.createElement("li",{key:"extraMenu2",className:"divider"}),r.createElement("li",{key:"extraMenu3"},r.createElement("a",{href:"#",onClick:this.extraMenuClick},"Cancel"))],s=r.createElement("span",{className:"material-icons"},"more_horiz"),a=r.createElement(I,{onClick:this.extraMenuClick,content:s});return r.createElement("div",{className:"generic-header-base-tabsContainer"},r.createElement(we,{items:e,callback:this.selectMenuTab,defaultTab:this.props.defaultTab}),t.length>2?r.createElement(U,{className:"inline-block v-top mar-sm-top",toggleElem:a,items:t,open:this.state.extraMenuDropdownOpen,onBlur:this.extraMenuClick}):null)}actionButton(){return null}selectMenuTab(e,t){t.url&&t.url!==location.pathname&&l().ajax({url:t.url,data:{y:1},success:e=>{se.unmount("#peopleContent");let t=l()("#peopleContent");t.html(e),window.state.current_page=t.find("#pageid").attr("content"),$title.html(t.find("#page_title").attr("content")),window.state.require_js(t.find("#require")).then((e=>{loadPageid(window.state.current_page),se.mount("#peopleContent"),window.scrollTo(0,0)}))}})}doNothing(e){return e.preventDefault(),e.stopPropagation(),!1}};class mt extends r.Component{constructor(e){super(e),this.state={loading:!0,followedList:[]};const t=e.items.map((e=>e.id));if(!window.is_server){let s={};s[e.reactEndpoint]={ids:t},se.get(s).then((t=>{this.setState({followedList:t[e.reactEndpoint],loading:!1})}))}}followButtonHandler(e,t){return null}title(){return r.createElement("div",{className:"mar-md-bottom"},this.props.seeAllUrl?r.createElement("a",{className:"pull-right",href:this.props.seeAllUrl},"See All"):null,r.createElement("span",{className:"bold text-muted"},this.props.title))}itemImage(e){return r.createElement(w,{src:e.avatar,className:"micro"})}isFollowed(e){return!!this.state.followedList&&this.state.followedList.indexOf(e)>-1}actionButton(e){return r.createElement(V,{className:"btn-default btn-xs",url:e.followUrl,content:this.isFollowed(e.id)?"Following":"Follow",requireLogin:!0,loading:this.state.loading,type:"POST",processResponse:this.followButtonHandler.bind(this,e)})}items(){return this.props.items.map(((e,t)=>r.createElement("div",{key:`item_${t}`,className:"media"},r.createElement("div",{className:"media-left"},r.createElement("a",{href:e.url},this.itemImage(e))),r.createElement("div",{className:"media-body"},r.createElement("a",{href:e.url,className:"link-dark break-all"},r.createElement("span",null,e.name))),r.createElement("div",{className:"media-right"},this.actionButton(e)))))}render(){return this.props.items.length?r.createElement("div",{className:this.props.className||"panel panel-default"},r.createElement("div",{className:"panel-body"},this.props.seeAllUrl||this.props.title?this.title():null,this.items())):null}}var dt=mt;var ht=class extends dt{itemImage(e){return r.createElement(w,{src:e.cloudinary_mug_shot,className:"micro"})}followButtonHandler(e,t){if(200==t.status){let s=this.state.followedList.slice(0);return!0===t.responseJSON.result?(s.push(e.id),void this.setState({loading:!1,followedList:s})):(s.splice(s.indexOf(e.id),1),void this.setState({loading:!1,followedList:s}))}this.setState({loading:!1})}};class ut extends r.Component{constructor(e){super(e),this.state={links:e.links||[]},this.inputElems={},this.renderWebsiteLink=this.renderWebsiteLink.bind(this),this.renderWebsiteLinkList=this.renderWebsiteLinkList.bind(this)}validate(e){let t=this.inputElems[e].value;if(!t)return;let s=this.props.list.filter((t=>t.slug===e))[0];if(s){t=t.replace(/^this./,""),t=t.replace(/\/$/,""),t.includes("http")||(t=`https://${t}`);const a=urlToObject(t);"official"!==e&&(a.scheme="https://");const{domains:i=[],prefix:r="/"}=s,[n]=i,l=i.some((e=>a.host.includes(e))),o=({scheme:e,host:t,path:s,query:i}=a)=>`${e}${t}${s}${i}`;t=!n||l?o():a.valid?o({...a,host:n}):o({host:n,path:r,query:t})}t.split("https:").length>2||(this.setValue(e,t),this.inputElems[e].value=t)}slugToId(e){let t=this.props.list.filter((t=>e==t.slug));if(t.length)return t[0].id}setValue(e,t){const s=this.slugToId(e),a=this.state.links.slice(0).map((e=>e.id==s?(e.url=t,e):e));this.setState({links:a})}inputChange(e){this.setValue(e,this.inputElems[e].value)}renderWebsiteLink(e){const{id:t,site:s,url:a,slug:i,name:n,icon:l,svg:o,idx:c}=e;return r.createElement("div",{key:i,className:"col-md-6"},r.createElement("div",{className:"form-group"},r.createElement("label",{htmlFor:i},n,":"),r.createElement("div",{className:"input-group"},r.createElement("div",{className:"input-group-addon input-group-addon-full"},o?r.createElement("div",{className:`icon icon-100 icon-${o}`}):r.createElement("div",{className:`fab fa-${l} fa-fw`})),r.createElement("input",{type:"hidden",name:`game[websites_attributes][${c}][site]`,value:s}),t?r.createElement("input",{type:"hidden",name:`game[websites_attributes][${c}][id]`,value:t}):null,r.createElement("input",{ref:e=>this.inputElems[i]=e,placeholder:n,className:"form-control",type:"url",defaultValue:a||null,name:`game[websites_attributes][${c}][url]`,onChange:this.inputChange.bind(this,i),onBlur:this.validate.bind(this,i)}))))}renderWebsiteLinkList(e,t){return r.createElement("div",{className:"panel"},r.createElement("div",{className:"panel-heading"},r.createElement("h3",{className:"panel-title text-bold"},t)),r.createElement("div",{className:"panel-body"},e.map((e=>this.renderWebsiteLink(e)))))}websiteListToLink(e,t){let s=this.state.links.find((t=>t.site==e.id));return{id:s&&s.id,site:e.id,url:s?s.url:"",slug:e.slug,name:e.name,icon:e.icon||e.slug.replace("_","-"),svg:e.svg,type:e.type,idx:t}}render(){const[e,t]=(this.props.list||[]).reduce((([e,t],s,a)=>{const i=this.websiteListToLink(s,a);switch(s.type){case"store":return[[...e,i],t];case"social":return[e,[...t,i]];default:return[e,t]}}),[[],[]]);return r.createElement("div",{className:"row"},this.renderWebsiteLinkList(e,"Store links"),this.renderWebsiteLinkList(t,"Social links"))}}var pt=ut;var gt=class extends pt{render(){return r.createElement("div",{className:"row"},this.props.list.map((e=>{let t=this.state.links.filter((t=>(t.site||t.id)==e.id));t&&t.length&&(t=t[0].url);const s=e.slug,a=e.name,i=s.replace("_","-");return r.createElement("div",{key:s,className:"col-md-6"},r.createElement("div",{className:"form-group"},r.createElement("label",{htmlFor:s},a,":"),r.createElement("div",{className:"input-group"},r.createElement("div",{className:"input-group-addon"},r.createElement("div",{className:`fab fa-${i} fa-fw`})),r.createElement("input",{ref:e=>this.inputElems[s]=e,placeholder:`${a} Profile`,className:"form-control",type:"url",defaultValue:t,name:`person[${s}]`,onChange:this.inputChange.bind(this,s),onBlur:this.validate.bind(this,s)}))))})))}};function _t(e){const[t,s]=r.useState(!1),[a,i]=r.useState(!1);if(r.useEffect((()=>{i(!0);let e=setTimeout((()=>i(!1)),1e4);return()=>{clearTimeout(e)}}),[]),r.useEffect((()=>{if(!a){let e=setTimeout((()=>s(!0)),500);return()=>{clearTimeout(e)}}}),[a]),t)return null;const n=`alert igdb-toast alert-${e.notification.alertClass} ${a?"in":"out"}`,l=r.createElement(r.Fragment,null,r.createElement("strong",null,e.notification.heading),"\xa0",e.notification.message);return e.notification.url?r.createElement("a",{href:e.notification.url,target:"_parent",className:n},l):r.createElement("div",{className:n},l)}var ft=function(){const[e,t]=r.useState([]),s=e=>{t((t=>{const s=t.slice(0);return s.unshift(e.detail),s}))};r.useEffect((()=>(window.addEventListener("notify",s),()=>window.removeEventListener("notify",s))),[]);const a=e.map((e=>r.createElement(_t,{key:e.id,notification:e})));return r.createElement("div",{style:{right:0,position:"fixed"}},a)};var bt=class extends dt{constructor(e){super(e),this.state={acceptedList:[],requestedList:[]},this.friendshipIdTable={};const t=e.items.map((e=>e.id));window.is_server||se.get({friendship_status:{ids:t}}).then((e=>{let t=this.state.acceptedList.slice(0),s=this.state.requestedList.slice(0);e.friendship_status&&e.friendship_status.forEach(((e,a)=>{e.requested&&s.push(e.id),e.accepted&&t.push(e.id),this.friendshipIdTable[e.id]=e.friendship_id})),this.setState({acceptedList:t,requestedList:s,loading:!1})}))}followButtonHandler(e,t){if(200===t.status){if("Request sent"===t.responseText){let t=this.state.requestedList.slice(0);t.push(e.id),this.setState({loading:!1,requestedList:t})}}else this.setState({loading:!1})}itemImage(e){return r.createElement(y,{size:40,user:e,className:"micro"})}actionButton(e){const t=this.state.requestedList.indexOf(e.id)>-1;return r.createElement(V,{className:"btn-default btn-xs",url:`${e.url}/friendship_requests`,content:t?"Requested":"Add Friend",requireLogin:!0,loading:this.state.loading,type:"POST",processResponse:this.followButtonHandler.bind(this,e),disabled:!!t})}removeButtonHandler(e,t){if(200==t.status){let t=this.state.acceptedList.slice(0);t.splice(t.indexOf(e.id),1),this.setState({loading:!1,acceptedList:t})}else this.setState({loading:!1})}removeButton(e){return r.createElement(V,{className:"btn-default btn-xs",url:`${window.current_user.url}/friendships/${this.friendshipIdTable[e.id]}`,content:"Remove",requireLogin:!0,loading:this.state.loading,type:"DELETE",processResponse:this.removeButtonHandler.bind(this,e),disabled:!!this.state.loading})}items(){return this.props.items.map(((e,t)=>{let s=this.state.acceptedList.indexOf(e.id)>-1;return b()&&e.id==window.current_user.user&&(s=!0),r.createElement("div",{key:`user_${t}`,className:`media ${this.props.itemsClassName||""}`},r.createElement("div",{className:"media-left"},r.createElement("a",{href:e.url},this.itemImage(e))),r.createElement("div",{className:"media-body"},r.createElement("a",{href:e.url,className:"link-dark css-truncate"},e.username)),r.createElement("div",{className:"media-right"},s?this.removeButton(e):this.actionButton(e)))}))}};class vt extends r.Component{constructor(e){super(e),this.state={busy:!1},this.onStart=this.onStart.bind(this),this.onProgress=this.onProgress.bind(this),this.onComplete=this.onComplete.bind(this)}componentDidMount(){l()(this.form).on("upload:start",this.onStart).on("upload:progress",this.onProgress).on("upload:complete",this.onComplete)}componentWillUnmount(){l()(this.form).off("upload:start",this.onStart).off("upload:progress",this.onProgress).off("upload:complete",this.onComplete)}onStart(e){this.props.onStart(e)}onProgress(e){const t=e.originalEvent.detail.progress;this.props.onProgress(Math.round(t.loaded/t.total*100))}onComplete(e){this.setState({attributes:{id:e.detail.xhr.id,filename:e.detail.file.name,content_type:e.detail.file.type,size:e.detail.file.size}},(()=>{l().ajax({url:this.props.action,type:"PATCH",data:l()(this.form).serialize()});const t={"image/jpeg":"jpg","image/png":"png","image/webp":"webp","image/gif":"gif","image/bmp":"bmp"}[e.detail.file.type],s=e.detail.xhr.id;this.props.onComplete(`/image_preview/${s}.${t}`)}))}doNothing(e){return e.preventDefault(),e.stopPropagation(),!1}render(){return r.createElement("form",{ref:e=>this.form=e,className:this.props.className,onSubmit:this.doNothing,action:this.props.action,method:"PATCH",encType:"multipart/form-data"},r.createElement("input",{type:"hidden",name:"authenticity_token",value:window.csrfToken}),r.createElement("input",{value:JSON.stringify(this.state.attributes),type:"hidden",name:this.props.name}),r.createElement("input",{direct:"true",presigned:"true","data-direct":"true","data-as":"file","data-url":"/cache/presign","data-presigned":"true",include_hidden:"false",type:"file",name:this.props.name}),this.props.content)}}var Et=vt;var wt=class extends ot{constructor(e){super(e),this.state={loading:!1},this.coverEditButtonClick=this.coverEditButtonClick.bind(this),this.avatarEditButtonClick=this.avatarEditButtonClick.bind(this),this.extraMenuClick=this.extraMenuClick.bind(this),this.coverUploadComplete=this.coverUploadComplete.bind(this),this.coverUploadStart=this.coverUploadStart.bind(this),this.coverRemoveClick=this.coverRemoveClick.bind(this),this.avatarUploadComplete=this.avatarUploadComplete.bind(this),this.avatarUploadStart=this.avatarUploadStart.bind(this),this.avatarRemoveClick=this.avatarRemoveClick.bind(this)}componentDidMount(){super.componentDidMount(),b()&&(this.isOwner=window.current_user.user===this.props.user.id,this.isOwner||(this.state.loading=!0,se.get({friendship_status:{ids:[this.props.user.id]}}).then((e=>{if(e.friendship_status.length){const t=e.friendship_status[0],s=!t.requested&&!t.accepted;this.setState({friendAccepted:t.accepted,unfriendPath:`${window.current_user.url}/friendships/${t.friendship_id}`,friendRequested:t.requested,loading:!1,disabled:s})}}))))}friendUrl(){return this.state.friendAccepted?this.state.unfriendPath:this.props.friendshipPath}extraMenuClick(e){if(e)e.preventDefault();else if(!this.state.extraMenuDropdownOpen)return!1;return this.setState({extraMenuDropdownOpen:!this.state.extraMenuDropdownOpen}),!1}headerMenu(){const e=`/users/${this.props.user.slug}`,t=[{name:"Overview",url:e},{name:"Lists",url:`${e}/lists`},{name:"Contributions",url:`${e}/about`},{name:"Badges",url:`${e}/badges`}],s=[r.createElement("li",{key:"extraMenu2",className:"divider"}),r.createElement("li",{key:"extraMenu3"},r.createElement("a",{href:"#",onClick:this.extraMenuClick},"Cancel"))];this.isOwner&&s.unshift(r.createElement("li",{key:"extraMenu4"},r.createElement("a",{href:"/karma_hunters"},"Karma Hunters"))),s.unshift(r.createElement("li",{key:"extraMenu6"},r.createElement("a",{href:`${this.props.user.url}/friends`},"Friends")));const a=r.createElement("span",{className:"material-icons"},"more_horiz"),i=r.createElement(I,{onClick:this.extraMenuClick,content:a});return r.createElement("div",{className:"generic-header-base-tabsContainer"},r.createElement(we,{className:"inline-block",items:t,callback:this.selectMenuTab,defaultTab:this.props.defaultTab}),s.length>2?r.createElement(U,{className:"inline-block v-top mar-sm-top",toggleElem:i,items:s,open:this.state.extraMenuDropdownOpen,onBlur:this.extraMenuClick}):null)}friendButtonHandler(e){e.responseJSON?this.setState({loading:!1,disableFriendButton:!1,friendButtonContent:null,friendAccepted:!1,friendRequested:!1}):this.setState({loading:!1,disableFriendButton:!0,friendButtonContent:e.responseText})}actionButton(){return this.isOwner?null:r.createElement(V,{className:"generic-header-base-actionButton "+(this.state.friendAccepted||this.state.friendRequested?"btn-default":"btn-primary"),url:this.friendUrl(),content:this.state.friendButtonContent||(this.state.friendAccepted?"Unfriend":this.state.friendRequested?"Requested":"Add Friend"),requireLogin:!0,loginMessage:"add_friend",type:this.state.friendAccepted?"DELETE":"POST",loading:this.state.loading,processResponse:this.friendButtonHandler.bind(this),disabled:this.state.disableFriendButton})}selectMenuTab(e,t){l().ajax({url:t.url,data:{y:1},success:e=>{se.unmount("#userProfileContent");let t=l()("#userProfileContent");t.html(e),window.state.current_page=t.find("#pageid").attr("content"),$title.html(t.find("#page_title").attr("content")),window.state.require_js(t.find("#require")).then((e=>{loadPageid(window.state.current_page),se.mount("#userProfileContent"),this.state.affix&&window.scrollTo(0,l()(".generic-header-base-menu").position().top)}))}})}coverUploadStart(e){this.setState({coverEditDropdownShow:!1,uploadBusy:!0})}coverUploadProgress(e){}coverUploadComplete(e){this.setState({backgroundImage:e,uploadBusy:!1})}coverRemoveClick(){l().ajax({url:"/users/remove_user_background",type:"DELETE",complete:(()=>{this.setState({backgroundImage:"",coverEditDropdownShow:!1})}).bind(this)})}avatarUploadStart(e){this.setState({avatarEditDropdownShow:!1,uploadBusy:!0})}avatarUploadProgress(e){}avatarUploadComplete(e){this.setState({avatarImage:e,uploadBusy:!1})}avatarRemoveClick(){l().ajax({url:"/users/remove_avatar",type:"DELETE",complete:(()=>{this.setState({avatarImage:"",avatarEditDropdownShow:!1})}).bind(this)})}coverEditDropdown(){const e=r.createElement("a",{className:"generic-header-base-upload",href:"#"},r.createElement("input",{type:"submit",value:"Upload"})),t=[r.createElement("li",{key:"coverEdit1"},r.createElement(Et,{className:"generic-header-base-uploadForm "+(this.state.uploadBusy?"hide":""),action:this.props.user.url,content:e,name:"user[user_background_attributes][user_background_image]",onStart:this.coverUploadStart,onProgress:this.coverUploadProgress,onComplete:this.coverUploadComplete})),r.createElement("li",{key:"coverEdit2"},this.state.backgroundImage?r.createElement("a",{href:"#",onClick:this.coverRemoveClick},"Remove"):null),r.createElement("li",{key:"coverEdit3",className:"divider"}),r.createElement("li",{key:"coverEdit4"},r.createElement("a",{href:"#",onClick:this.coverEditButtonClick},"Cancel"))],s=r.createElement("span",null,r.createElement("span",{className:"material-icons"},"photo_camera")," Edit Cover Photo"),a=r.createElement(I,{className:"btn-dark",onClick:this.coverEditButtonClick,content:s});return r.createElement(U,{className:"mar-lg-top",toggleElem:a,items:t,open:this.state.coverEditDropdownShow,onBlur:this.coverEditButtonClick})}avatarEditDropdown(){const e=r.createElement("a",{className:"generic-header-base-upload",href:"#",onClick:this.doNothing},r.createElement("input",{type:"submit",value:"Upload"})),t=[r.createElement("li",{key:"avatarEdit1"},r.createElement(Et,{className:"generic-header-base-uploadForm "+(this.state.uploadBusy?"hide":""),action:this.props.user.url,content:e,name:"user[avatar_attributes][avatar_image]",onStart:this.avatarUploadStart,onProgress:this.avatarUploadProgress,onComplete:this.avatarUploadComplete})),r.createElement("li",{key:"avatarEdit2"},r.createElement("a",{href:"#",onClick:this.avatarRemoveClick},"Remove")),r.createElement("li",{key:"avatarEdit3",className:"divider"}),r.createElement("li",{key:"avatarEdit4"},r.createElement("a",{href:"#",onClick:this.avatarEditButtonClick},"Cancel"))],s=r.createElement("div",{className:"caption",onClick:this.avatarEditButtonClick},r.createElement("div",{className:"material-icons"},"photo_camera"),r.createElement("p",null,"Edit Avatar"));return r.createElement(U,{items:t,toggleElem:s,open:this.state.avatarEditDropdownShow,onBlur:this.avatarEditButtonClick})}doNothing(e){return e.preventDefault(),e.stopPropagation(),!1}coverEditButtonClick(e){if(e)e.preventDefault();else if(!this.state.coverEditDropdownShow)return!1;return this.setState({coverEditDropdownShow:!this.state.coverEditDropdownShow}),!1}avatarEditButtonClick(e){if(e)e.preventDefault();else if(!this.state.avatarEditDropdownShow)return!1;return this.setState({avatarEditDropdownShow:!this.state.avatarEditDropdownShow}),!1}coverEditButton(){return null}avatarEditButton(){return null}avatar(){const e=this.state.isMobile?100:200;return r.createElement("div",{ref:e=>this.avatarElement=e,className:"generic-header-base-avatar",style:{width:`${e}px`,height:`${e}px`,backgroundColor:this.props.backgroundColor}},this.state.isMobile?null:this.avatarEditButton(),r.createElement(y,{user:this.props.user,className:"avatar_large",size:e}))}avatarAffix(){return r.createElement("div",{className:"generic-header-base-avatarAffix-container"},r.createElement("div",{className:"generic-header-base-avatarAffix"},r.createElement("div",{className:"media"},r.createElement("div",{className:"media-left media-middle"},r.createElement(y,{user:this.props.user,className:"micro",size:35,force_load:!0})),r.createElement("div",{className:"media-body media-middle generic-header-base-avatarTitle"},this.props.avatarTitle))))}};class yt extends r.Component{constructor(e){super(e),this.checkboxes=[],this.state={settings:[this.getSettings("enableVideoAutoplay","Video Autoplay"),this.getSettings("enableContributionPopUp","Contribution pop-up on successful page edit")]}}getSettings(e,t,s="bool",a=1){return{id:e,name:t,valueType:s,value:parseInt(localStorage.getItem(e)||a)}}checkbox(e){const t=this.checkboxes[e].checked?1:0;let s=this.state.settings.slice(0);s[e].value=t;const a=s[e];localStorage.setItem(a.id,t),this.setState({settings:s})}renderInput(e,t,s){if("bool"==e.valueType)return r.createElement("div",null,r.createElement("input",{ref:e=>this.checkboxes[t]=e,className:"checkbox",id:s,type:"checkbox",checked:1==e.value,onChange:this.checkbox.bind(this,t)}),r.createElement("label",{htmlFor:s}))}render(){return r.createElement("div",null,r.createElement("table",{className:"table table-condensed nomar table-valign-middle"},r.createElement("thead",null,r.createElement("tr",{className:"active"},r.createElement("th",null,"Site Setting"),r.createElement("th",null))),r.createElement("tbody",null,this.state.settings.map(((e,t)=>{const s=`option_${t}`;return r.createElement("tr",{key:s},r.createElement("td",null,e.name),r.createElement("td",{className:"text-center"},this.renderInput(e,t,s)))})))))}}var Nt=yt;var kt=class extends pt{render(){return r.createElement("div",{className:"row"},this.props.list.map((e=>{let t=this.state.links.filter((t=>t.id==e.id));t&&t.length&&(t=t[0].url);const s=e.slug,a=e.name,i=s.replace("_","-");return r.createElement("div",{key:s,className:"col-md-6"},r.createElement("div",{className:"form-group"},r.createElement("label",{htmlFor:s},a,":"),r.createElement("div",{className:"input-group"},r.createElement("div",{className:"input-group-addon"},r.createElement("div",{className:`fab fa-${i} fa-fw`})),r.createElement("input",{ref:e=>this.inputElems[s]=e,placeholder:`${a} Profile`,className:"form-control",type:e.domains.length?"url":"text",defaultValue:t,name:`user[${s}]`,onChange:this.inputChange.bind(this,s),onBlur:this.validate.bind(this,s)}))))})))}};i().register({AdvancedSearch:S,AutoComplete:T,DebugSearch:O,ExternalReviews:M,ExternalReviewsOverview:q,ExternalReviewsSidebar:B,FileUpload:A,FriendNotifications:G,HeaderNotificationIndex:ae,IGDBTV:ce,GameCountdown:_e,GameEntries:be,GameGrid:ve,GamePageHeader:Fe,GamePageHeaderMobile:ze,GameSimpleList:Ae,GameVersions:Ue,GenericGameList:Ge,ListEditForm:Je,MemberReviews:Ze,MeritBadges:tt,NotificationEditor:at,Pagination:nt,PeopleHeader:ct,PeopleSuggestions:ht,ReadMore:pe,SocialMedia:gt,Stars:Me,ToastNotifications:ft,UserFriends:bt,UserProfileHeader:wt,UserSiteSettings:Nt,UserSocialMediaEdit:kt,WantPlayingPlayed:Pe,WebsiteLinksForm:pt})},6700:function(e,t,s){var a={"./af":2786,"./af.js":2786,"./ar":867,"./ar-dz":4130,"./ar-dz.js":4130,"./ar-kw":6135,"./ar-kw.js":6135,"./ar-ly":6440,"./ar-ly.js":6440,"./ar-ma":7702,"./ar-ma.js":7702,"./ar-sa":6040,"./ar-sa.js":6040,"./ar-tn":7100,"./ar-tn.js":7100,"./ar.js":867,"./az":1083,"./az.js":1083,"./be":9808,"./be.js":9808,"./bg":8338,"./bg.js":8338,"./bm":7438,"./bm.js":7438,"./bn":8905,"./bn-bd":6225,"./bn-bd.js":6225,"./bn.js":8905,"./bo":1560,"./bo.js":1560,"./br":1278,"./br.js":1278,"./bs":622,"./bs.js":622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":877,"./cv.js":877,"./cy":7373,"./cy.js":7373,"./da":4780,"./da.js":4780,"./de":9740,"./de-at":217,"./de-at.js":217,"./de-ch":894,"./de-ch.js":894,"./de.js":9740,"./dv":5300,"./dv.js":5300,"./el":837,"./el.js":837,"./en-au":8348,"./en-au.js":8348,"./en-ca":7925,"./en-ca.js":7925,"./en-gb":2243,"./en-gb.js":2243,"./en-ie":6436,"./en-ie.js":6436,"./en-il":7207,"./en-il.js":7207,"./en-in":4175,"./en-in.js":4175,"./en-nz":6319,"./en-nz.js":6319,"./en-sg":1662,"./en-sg.js":1662,"./eo":2915,"./eo.js":2915,"./es":5655,"./es-do":5251,"./es-do.js":5251,"./es-mx":6112,"./es-mx.js":6112,"./es-us":1146,"./es-us.js":1146,"./es.js":5655,"./et":5603,"./et.js":5603,"./eu":7763,"./eu.js":7763,"./fa":6959,"./fa.js":6959,"./fi":1897,"./fi.js":1897,"./fil":2549,"./fil.js":2549,"./fo":4694,"./fo.js":4694,"./fr":4470,"./fr-ca":3049,"./fr-ca.js":3049,"./fr-ch":2330,"./fr-ch.js":2330,"./fr.js":4470,"./fy":5044,"./fy.js":5044,"./ga":9295,"./ga.js":9295,"./gd":2101,"./gd.js":2101,"./gl":8794,"./gl.js":8794,"./gom-deva":7884,"./gom-deva.js":7884,"./gom-latn":3168,"./gom-latn.js":3168,"./gu":5349,"./gu.js":5349,"./he":4206,"./he.js":4206,"./hi":94,"./hi.js":94,"./hr":316,"./hr.js":316,"./hu":2138,"./hu.js":2138,"./hy-am":1423,"./hy-am.js":1423,"./id":9218,"./id.js":9218,"./is":135,"./is.js":135,"./it":626,"./it-ch":150,"./it-ch.js":150,"./it.js":626,"./ja":9183,"./ja.js":9183,"./jv":4286,"./jv.js":4286,"./ka":2105,"./ka.js":2105,"./kk":7772,"./kk.js":7772,"./km":8758,"./km.js":8758,"./kn":9282,"./kn.js":9282,"./ko":3730,"./ko.js":3730,"./ku":1408,"./ku.js":1408,"./ky":3291,"./ky.js":3291,"./lb":6841,"./lb.js":6841,"./lo":5466,"./lo.js":5466,"./lt":7010,"./lt.js":7010,"./lv":7595,"./lv.js":7595,"./me":9861,"./me.js":9861,"./mi":5493,"./mi.js":5493,"./mk":5966,"./mk.js":5966,"./ml":7341,"./ml.js":7341,"./mn":5115,"./mn.js":5115,"./mr":370,"./mr.js":370,"./ms":9847,"./ms-my":1237,"./ms-my.js":1237,"./ms.js":9847,"./mt":2126,"./mt.js":2126,"./my":6165,"./my.js":6165,"./nb":4924,"./nb.js":4924,"./ne":6744,"./ne.js":6744,"./nl":3901,"./nl-be":9814,"./nl-be.js":9814,"./nl.js":3901,"./nn":3877,"./nn.js":3877,"./oc-lnc":2135,"./oc-lnc.js":2135,"./pa-in":5858,"./pa-in.js":5858,"./pl":4495,"./pl.js":4495,"./pt":9520,"./pt-br":7971,"./pt-br.js":7971,"./pt.js":9520,"./ro":6459,"./ro.js":6459,"./ru":1793,"./ru.js":1793,"./sd":950,"./sd.js":950,"./se":490,"./se.js":490,"./si":124,"./si.js":124,"./sk":4249,"./sk.js":4249,"./sl":4985,"./sl.js":4985,"./sq":1104,"./sq.js":1104,"./sr":9131,"./sr-cyrl":9915,"./sr-cyrl.js":9915,"./sr.js":9131,"./ss":5893,"./ss.js":5893,"./sv":8760,"./sv.js":8760,"./sw":1172,"./sw.js":1172,"./ta":7333,"./ta.js":7333,"./te":3110,"./te.js":3110,"./tet":2095,"./tet.js":2095,"./tg":7321,"./tg.js":7321,"./th":9041,"./th.js":9041,"./tk":9005,"./tk.js":9005,"./tl-ph":5768,"./tl-ph.js":5768,"./tlh":9444,"./tlh.js":9444,"./tr":2397,"./tr.js":2397,"./tzl":8254,"./tzl.js":8254,"./tzm":1106,"./tzm-latn":699,"./tzm-latn.js":699,"./tzm.js":1106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":7691,"./uk.js":7691,"./ur":3795,"./ur.js":3795,"./uz":6791,"./uz-latn":588,"./uz-latn.js":588,"./uz.js":6791,"./vi":5666,"./vi.js":5666,"./x-pseudo":4378,"./x-pseudo.js":4378,"./yo":5805,"./yo.js":5805,"./zh-cn":3839,"./zh-cn.js":3839,"./zh-hk":5726,"./zh-hk.js":5726,"./zh-mo":9807,"./zh-mo.js":9807,"./zh-tw":4152,"./zh-tw.js":4152};function i(e){var t=r(e);return s(t)}function r(e){if(!s.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=r,e.exports=i,i.id=6700}},function(e){e.O(0,[196,433],(function(){return t=4343,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=application-bundle-a73637d867f5d70b5d67.js.map